<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> OasisDeployment &lt; Documentation/Release3 &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Documentation/Release3/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Documentation/Release3/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Documentation/Release3/OasisDeployment?_T=16 Feb 2017" type="application/x-wiki" title="edit OasisDeployment" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Documentation/Release3/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Documentation/Release3/OasisDeployment"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#FFFFFF;
	}
	.patternBookView {
		border-color:#FFFFFF;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <!-- 
<strong>DO WE NEED TO FILL THE REQUIREMENTS SECTION???</strong>
<p />
<strong>SECTION ON ARCHITECTURE SHOULD BE IN A GENERIC <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> PAGE</strong>
<p />
<strong>SECTION USERS SHOULD GO TO THE UPDATE PAGE</strong>
<p />
<strong>CONSIDER ADDING A SECTION ON THE REPLICA HOST WITH LIST OF ADMIN TOOLS BEING DEPLOYED BY THE RPM</strong>
-->
<p />
<!-- some useful definitions  (need 3 white spaces before * to enable it) <ul>
<li> Set UCL_PROMPT_ROOT_OASIS = [root@oasis ~]$
</li> <li> Set UCL_PROMPT_ROOT_LOGIN = [root@login ~]$
</li> <li> Set UCL_PROMPT_ROOT_REPLICA = [root@replica ~]$
</li> <li> Set UCL_PROMPT_ROOT_CLIENT = [root@client ~]$
</li> <li> Set UCL_PROMPT_USER_LOGIN = [user@login ~]$
</li> <li> Set UCL_PROMPT_USER_CLIENT = [user@client ~]$
</li> <li> Set UCL_PROMPT_ROOT_HOST = [root@host ~]$
</li> <li> Set VERSION = 2.0.5-2
</li></ul> 
-->
<p />
<p />
<h1><a name="Deployment_of_OASIS_2"></a>  Deployment of <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> 2 </h1>
<!--
<p />
-->
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#1_About_this_Document">1  About this Document</a>
</li> <li> <a href="?cover=print#2_Applicable_versions">2  Applicable versions</a>
</li> <li> <a href="?cover=print#3_Requirements">3  Requirements</a>
</li> <li> <a href="?cover=print#4_Install_Instructions">4  Install Instructions</a>
</li> <li> <a href="?cover=print#5_Configuration">5  Configuration</a> <ul>
<li> <a href="?cover=print#5_1_Architecture_of_OASIS_2">5.1  Architecture of OASIS 2</a>
</li> <li> <a href="?cover=print#5_2_Configuration_files">5.2  Configuration files</a>
</li> <li> <a href="?cover=print#5_3_Configuration_of_the_server">5.3  Configuration of the server host</a> <ul>
<li> <a href="?cover=print#5_3_1_Location_of_the_configurat">5.3.1  Location of the configuration files</a>
</li> <li> <a href="?cover=print#5_3_2_Configuring_etc_oasis_oasi">5.3.2  Configuring /etc/oasis/oasis.conf</a>
</li> <li> <a href="?cover=print#5_3_3_Configuring_etc_oasis_repo">5.3.3  Configuring /etc/oasis/repositories.conf</a>
</li> <li> <a href="?cover=print#5_3_4_Configuring_etc_oasis_proj">5.3.4  Configuring /etc/oasis/projects.conf</a>
</li> <li> <a href="?cover=print#5_3_5_Configuring_etc_oasis_prob">5.3.5  Configuring /etc/oasis/probes.conf</a>
</li> <li> <a href="?cover=print#5_3_6_Configuring_etc_oasis_proj">5.3.6  Configuring /etc/oasis/&lt;project&gt;probes.conf</a>
</li></ul> 
</li> <li> <a href="?cover=print#5_4_Configuration_of_the_login_h">5.4  Configuration of the login host</a>
</li> <li> <a href="?cover=print#5_5_Configuration_of_the_replica">5.5  Configuration of the replica host</a>
</li> <li> <a href="?cover=print#5_6_Batch_oriented_configuration">5.6  Batch oriented configuration</a>
</li></ul> 
</li> <li> <a href="?cover=print#6_Setup_for_the_projects_and_rep">6  Setup for the projects and repositories</a>
</li> <li> <a href="?cover=print#7_Start">7  Start</a>
</li> <li> <a href="?cover=print#8_Validation">8  Validation</a>
</li></ul> 
</div>
<p />
<h1><a name="1_About_this_Document"></a> 1  About this Document </h1>
<p />
This document describes how to install and configure <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> 2 in a server host, an user login host, and a replica host.  
<p />
on    
on    
<p />
<h1><a name="2_Applicable_versions"></a> 2  Applicable versions </h1>
The applicable software versions for this document are <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> 2.0.5-2 and, as requirements, CVMFS server 2.0.x and 2.1.x.
<p />
<h1><a name="3_Requirements"></a> 3  Requirements </h1>
<!--*QUESTION: Do we need an specific requirement section, or they are already explained in other twikies (CVMFS, ...) and can be linked???* -->
<p />
<h1><a name="4_Install_Instructions"></a> 4  Install Instructions </h1>
<p />
These instructions apply to the 3 hosts, if needed: the server host, the user login host, and the replica host. 
In the case of the server host and the replica host, CVMFS need to be installed first. 
Instructions to install CVMFS can be found here <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallCvmfsStratum1" target="_top">here</a>
There are no special requirement for the login host in terms of OS. 
<p />
Install the <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> RPM on RHEL 5:
<pre class="rootscreen">
[root@oasis ~]$ rpm -Uhv http://repo.grid.iu.edu/osg/3.2/osg-3.2-el5-release-latest.rpm
[root@oasis ~]$ yum -y install oasis
</pre>
<p />
Install the <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> RPM on RHEL 6:
<pre class="rootscreen">
[root@oasis ~]$ rpm -Uhv http://repo.grid.iu.edu/osg/3.2/osg-3.2-el6-release-latest.rpm
[root@oasis ~]$ yum -y install oasis
</pre>
<p />
<strong>TEMPORARY SOLUTION:</strong>
as the RPM is not yet available in the OSG repo, meanwhile it can be installed from development repo:
<p />
On RHEL 5
<pre class="rootscreen">
[root@oasis ~]$ rpm -Uhv http://repo.grid.iu.edu/osg/3.2/osg-3.2-el5-release-latest.rpm
[root@oasis ~]$ yum -y install --enablerepo=osg-development  oasis
</pre>
<p />
On RHEL 6
<pre class="rootscreen">
[root@oasis ~]$ rpm -Uhv http://repo.grid.iu.edu/osg/3.2/osg-3.2-el6-release-latest.rpm
[root@oasis ~]$ yum -y install --enablerepo=osg-development  oasis
</pre>
<p />
<!--
<strong>TEMPORARY SOLUTION:</strong>
<p />
as the RPM is not yet available in the OSG repo, meanwhile it can be installed from source code:
<p />
<pre class="rootscreen">
[root@oasis ~]$ mkdir src
[root@oasis ~]$ cd src
[root@oasis ~]$ svn co http://svn.usatlas.bnl.gov/svn/oasis/oasis-server/trunk/ .
[root@oasis ~]$ python setup.py bdist_rpm
[root@oasis ~]$ rpm -Uhv dist/oasis-2.0.0-1.noarch.rpm
</pre>
<p />
-->
<p />
<h1><a name="5_Configuration"></a> 5  Configuration </h1>
<p />
<!-- ---## <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> architecture
<strong>WARNING: This section probably does not make sense in a deployment wiki. Maybe it should be moved to the generic wiki for <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> project</strong>
<p />
<a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> 2 is built around two key concepts:
<p /> <ul>
<li> <strong>Repositories</strong>. A Repository is a single content management unit. That means, the whole amount of content to be distributed together. 
</li></ul> 
<p /> <ul>
<li> <strong>Projects</strong>. A Project is a single administrative management unit. In other words, refers to the data being managed by a given unique UNIX ID.
</li></ul> 
<p />
A Project must belong to a Repository, and only one. A Repository can have one or more Projects.
<p />
A Repository is composed by its source directory, its destination directory, and the particular underlying technology to distribute content. Currently the only technology being used by <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> is CVMFS, both 2.0.x and 2.1.x versions. 
A Project is composed by its source directory (relative to the source directory of the repository it belongs to) and its destination directory (relative to the destination directory of the repository it belongs to). 
<p />
The user scratch area is, therefore, composed as <code>&lt;REPOSITORY_SOURCE_DIRECTORY&gt;/&lt;PROJECT_SOURCE_DIRECTORY&gt;</code>
The users must be able to find that place by using the old fashion <code>$OSG_APP/&lt;VO&gt;/</code>
<p />
Each Project is associated to one unique UNIX ID. This UNIX ID is the username of the users logged into the <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> login host, and also the identity under which the <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> daemon runs some tasks.
This unique UNIX ID is the owner of the user scratch space.
<p />
Repositories and Projects are set up in the corresponding <code>repositories.conf</code> and <code>projects.conf</code> configuration files.
-->
<p />
<p />
<!-- ---## Hosts configuration
<p />
The instructions in the next sections applies to both the user login host and the server host, if they are separate hosts. The content of the <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> configuration files in both hosts <strong>must be identical</strong>, except the <code>services</code> variable.
<p />
No configuration is needed for the replica host. 
<p />
<strong>VERY IMPORTANT: with current version of <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a>, the directory where the content being distributed by the VOs is placed MUST be in a shared filesystem.</strong>
--> 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="5_1_Architecture_of_OASIS_2"></a> 5.1  Architecture of <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> 2 </span></h2>
<p />
<a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> 2 is built around two key concepts:
<p /> <ul>
<li> <strong>Repositories</strong>. A Repository is a single content management unit. That means, the whole amount of content to be distributed together. 
</li></ul> 
<p /> <ul>
<li> <strong>Projects</strong>. A Project is a single administrative management unit. In other words, refers to the data being managed by a given unique UNIX ID.
</li></ul> 
<p />
A Project must belong to a Repository, and only one. A Repository can have one or more Projects.
<p />
A Repository is composed by its source directory, its destination directory, and the particular underlying technology to distribute content. Currently the only technology being used by <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> is CVMFS, both 2.0.x and 2.1.x versions. 
A Project is composed by its source directory (relative to the source directory of the repository it belongs to) and its destination directory (relative to the destination directory of the repository it belongs to). 
<p />
The user scratch area is, therefore, composed as <code>&lt;REPOSITORY_SOURCE_DIRECTORY&gt;/&lt;PROJECT_SOURCE_DIRECTORY&gt;</code>
The users must be able to find that place by using the old fashion <code>$OSG_APP/&lt;VO&gt;/</code>
The meaning of those configuration variables will be explained in the following sections.
<p />
Each Project is associated to one unique UNIX ID. This UNIX ID is the username of the users logged into the <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> login host, and also the identity under which the <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> daemon runs some tasks.
This unique UNIX ID is the owner of the user scratch space.
<p />
Repositories and Projects are set up in the corresponding <code>repositories.conf</code> and <code>projects.conf</code> configuration files, as it is explained in the next sections.
<p />
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="5_2_Configuration_files"></a> 5.2  Configuration files </span></h2>
<p />
The same configuration must be identical in the user login host and the server host, except for variable <code>services</code>. No configuration is needed for the replica host. 
<p />
<!--There are at least 3 configuration files: the oasis.conf, the oasisprojects.conf, the oasisprobes.conf.
Then, for each project (typically a VO, but not necessarily), there is a dedicated {project}probes.conf. 
-->
<p />
The format of the configuration files is similar to the Microsoft INI files. 
The configuration file consists of sections, led by a <code>[section]</code> header and followed by <code>name: value</code> entries, with continuations in the style of <a href="http://tools.ietf.org/html/rfc822.html" target="_top">RFC 822</a> (see section 3.1.1, “LONG HEADER FIELDS”); <code>name=value</code> is also accepted. Note that leading whitespace is removed from values. The optional values can contain format strings which refer to other values in the same section, or values in a special <code>[DEFAULT]</code> section. Additional defaults can be provided on initialization and retrieval. Lines beginning with '#' or ';' are ignored and may be used to provide comments.
<p />
Configuration files may include comments, prefixed by specific characters (# and ;). Comments may appear on their own in an otherwise empty line, or may be entered in lines holding values or section names. In the latter case, they need to be preceded by a whitespace character to be recognized as a comment. (For backwards compatibility, only ; starts an inline comment, while # does not.)
<p />
It supports interpolation. This means values can contain format strings which refer to other values in the same section, or values in a special <code>[DEFAULT]</code> section. Additional defaults can be provided on initialization.
<p />
As the python package ConfigParser is being used to digest the configuration files, a wider explanation and examples can be found in the <a href="https://docs.python.org/2/library/configparser.html" target="_top">python documentation page</a>.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="5_3_Configuration_of_the_server"></a> 5.3  Configuration of the server host </span></h2>
<p />
The so called server host is the one where the underlying content distribution tool runs its service. 
For example, in the case of CVMFS, it is the place where the CVMFS commands for content distribution are issued. 
It is, therefore, the most important host in <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> 2, and we will start explaining the hosts configuration by this one. 
<p />
If the underlying technology is CVMFS, instructions to install it first can be found <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallCvmfsStratum1" target="_top">here</a>
After that, the <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> RPM can be deployed as it was explained in section <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/OasisDeployment#4_Install_Instructions" target="_top">Install</a>
<p />
<h3><a name="5_3_1_Location_of_the_configurat"></a> 5.3.1  Location of the configuration files </h3>
<p />
<!--
After installing <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> 2 from RPM, examples of the configuration files are located under directory <code>/usr/share/doc/oasis-2.x.y/</code>.
They need to be copied to the real destination. At least <code>oasis.conf</code> <strong>must</strong> be placed under <code>/etc/oasis/</code>. Therefore, it is a good practice, for consistency, to place all of them at the same path. 
<p />
<pre class="rootscreen">
[root@oasis ~]$ cp /usr/share/doc/oasis-2.0.5-2/oasis.conf-example /etc/oasis/oasis.conf
[root@oasis ~]$ cp /usr/share/doc/oasis-2.0.5-2/repositories.conf-example /etc/oasis/repositories.conf
[root@oasis ~]$ cp /usr/share/doc/oasis-2.0.5-2/projects.conf-example /etc/oasis/projects.conf
[root@oasis ~]$ cp /usr/share/doc/oasis-2.0.5-2/probes.conf-example /etc/oasis/probes.conf
</pre>
<p />
Also the sysconfig file and the logrotation file need to be copied from the same place to final destination.
In the case of the login host:
<p />
<pre class="rootscreen">
[root@login ~]$ cp /usr/share/doc/oasis-2.0.5-2/logrotate/oasis.logrotate-login-example /etc/logrotate.d/oasis
</pre>
<p />
In the case of the server host:
<p />
<pre class="rootscreen">
[root@oasis ~]$ cp /usr/share/doc/oasis-2.0.5-2/sysconfig/oasis.sysconfig-example /etc/sysconfig/oasis
[root@oasis ~]$ cp /usr/share/doc/oasis-2.0.5-2/logrotate/oasis.logrotate-server-example /etc/logrotate.d/oasis
</pre>
-->
<p />
After installing <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> 2 from RPM, the configuration files are located under directory <code>/etc/oasis/</code>.
There are 4 configuration files created by the RPM:
<p />
<pre class="rootscreen">
[root@oasis ~]$ ls /etc/oasis/
oasis.conf  probes.conf  projects.conf  repositories.conf
</pre>
<p />
These files, as they are created by the RPM, have basically no content. 
Next sections explain how to set them up properly. 
<p />
Also the sysconfig file (<code>/etc/sysconfig/oasis</code>) and the logrotate file (<code>/etc/logrotated.d/oasis</code>) have been created with some functional content. 
<p />
<p />
<h3><a name="5_3_2_Configuring_etc_oasis_oasi"></a> 5.3.2  Configuring /etc/oasis/oasis.conf </h3>
<p />
It is the main configuration file for <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a>. 
<p />
It has a single section, called <strong>[OASIS]</strong>. This head section name can not changed.
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table1" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/OasisDeployment?cover=print;sortcol=0;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Variable</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol1"> <a rel="nofollow" href="/bin/view/Documentation/Release3/OasisDeployment?cover=print;sortcol=1;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Description</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol2 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/OasisDeployment?cover=print;sortcol=2;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Mandatory</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>services</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> list of <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> services, split by comma, provided by <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> on a particular host. <BR> Current valid values are <code>login</code>, <code>server</code>, <code>replica</code>. </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>sleep</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> it is the time between cycles for the daemon, waiting to see if all threads, one per Project, need to be shutdown because the daemon has been stopped. Time is expressed in seconds. </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>email</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> email address to notify CRITICAL events </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> OPTIONAL </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>SMTPServer</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> SMTP server to be used to send email notifications </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol"> OPTIONAL </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>projectsconf</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> path to the Projects configuration file </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>repositoriessconf</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> path to the Repositories configuration file </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>probesconf</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> path to the configuration file with generic <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> probes. <BR> <strong>NOTE</strong>: the file must exist, but can be left blank if no probe is needed. </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> <code>flagfilebasedir</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLast"> path to the flagfiles. <BR> <strong>WARNING</strong>: in the case where the user login host is a different machine than the server hosts, this path <strong>must</strong> be in a shared filesystem. <BR> Default: <code>/var/run/oasis/</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol twikiLast"> OPTIONAL </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
A typical configuration file looks like this:
<p />
<p />
<pre class="file">
[OASIS]

services = server
sleep = 100 
email = neo@matrix.net
SMTPServer = server
repositoriesconf = /etc/oasis/repositories.conf
projectsconf = /etc/oasis/projects.conf
probesconf = /etc/oasis/probes.conf
</pre>
<p />
<p />
<h3><a name="5_3_3_Configuring_etc_oasis_repo"></a> 5.3.3  Configuring /etc/oasis/repositories.conf </h3>
<p />
 Configuration file for Repositories. The filename is the value of the variable <code>repositoriesconf</code> from the <code>oasis.conf</code> file.
<p />
This configuration file has a section per Repository. The name of the section has no meaning, it is just a string. 
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table2" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/OasisDeployment?cover=print;sortcol=0;table=2;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Variable</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol1"> <a rel="nofollow" href="/bin/view/Documentation/Release3/OasisDeployment?cover=print;sortcol=1;table=2;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Description</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol2 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/OasisDeployment?cover=print;sortcol=2;table=2;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Mandatory</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>OSG_APP</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> for legacy reasons, we maintain the environment variable $OSG_APP </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>repositoryname</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> the name of the repository. <BR> Examples:  <code>oasis.opensciencegrid.org</code> and <code>mis.opensciencegrid.org</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>repository_src_dir</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> it is root tree for the repository in the user scratch area. </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>repository_dest_dir</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> it is the root tree for the repository in the destination filesystem. <BR> Examples: <UL><LI> for cvmfs 2.0: <code>oasis.opensciencegrid.org</code>  (as the data will be placed under /cvmfs/oasis.opensciencegrid.org/) </LI><LI> for cvmfs 2.1: <code>&lt;vo&gt;.opensciencegrid.org</code>  (as the data will be placed under /cvmfs/&lt;vo&gt;.opensciencegrid.org/) </LI></UL> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>repository_src_owner</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> UNIX ID owner of the repository_src_dir </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>repository_dest_owner</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> UNIX ID owner of the repository_dest_dir Typically, the owner of the CVMFS repository. </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> <code>distributiontool</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLast"> it is the name of the plugin with code to interact with the 3rd party underlying technology for files distribution. <BR> Current options are: <UL><LI> <code>cvmfs20</code> = code to interact with CVMFS server version 2.0.x </LI><LI> <code>cvmfs21</code> = code to interact with CVMFS server version 2.1.x </LI></UL> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol twikiLast"> MANDATORY </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
A typical configuration file looks like this:
<p />
<pre class="file">
[DEFAULT]
OSG_APP = /home/data
distributiontool = cmvfs21

[MIS]
repositoryname = mis.opensciencegrid.org
repository_src_dir = %(OSG_APP)s/mis
repository_dest_dir = mis.opensciencegrid.org
repository_src_owner = ouser.mis
repository_dest_owner = oasis

[MyVO]
repositoryname = myvo.opensciencegrid.org
repository_src_dir = $(OSG_APP)s/myvo
repository_dest_dir = myvo.opensciencegrid.org
repository_src_owner = ouser.myvo
repository_dest_owner = oasis
</pre>
<p />
<p />
<h3><a name="5_3_4_Configuring_etc_oasis_proj"></a> 5.3.4  Configuring /etc/oasis/projects.conf </h3>
<p />
 Configuration file for Projects. The filename is the value of the variable <code>projectsconf</code> from the <code>oasis.conf</code> file.
<p />
This configuration file has a section per Project. The name of the section has no meaning, it is just a string. 
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table3" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/OasisDeployment?cover=print;sortcol=0;table=3;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Variable</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol1"> <a rel="nofollow" href="/bin/view/Documentation/Release3/OasisDeployment?cover=print;sortcol=1;table=3;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Description</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol2 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/OasisDeployment?cover=print;sortcol=2;table=3;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Mandatory</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>projectprobesconf</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> path to the configuration files for probes <BR> <strong>NOTE</strong>: the file must exist, but can be left blank if no probe is needed. </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY. </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>sleep</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> time between cycles for each thread (one per project) Time is expressed in seconds </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>starttimeout</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> maximum time to wait when process detects there is a flagfile, so a previous installation and publishing task is still going on.  The current process can wait a little bit, but not forever.  Time is expressed in seconds </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>finishtimeout</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> maximum time the user process can stay waiting for the daemon process to finish.  When the user process runs the installation payload it leaves a flagfile asking for publication.  The daemon process will see that flagfile, run probes on the new content, transfer files to final place, publish them, and notify the user process (via the same flagfile) everything is done. This waiting time needs a timeout.  Time is expressed in seconds </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>repositorysection</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> section in repositories.conf configuration file with setup for the repository a project belongs to. </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>projectname</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> the name of the project.  A project refers to content to be distributed handled by a single unique UNIX ID. </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>project_src_dir</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> is the path, relative to repository_src_dir. When the project and the repository are the same thing, then it is just "" (blank string between quotes) </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>project_dest_dir</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> is the path, relative to repository_dest_dir, in the destination filesytem.  When the project and the repository are the same thing, then it is just "" (blank string between quotes) </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>project_src_owner</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> UNIX ID owner of the project_src_dir.  it is the UNIX ID of the user running processes, or the UNIX ID the daemon needs to drop privileges to.  It will be the only UNIX ID allowed to do some tasks, e.g. to write in the project scratch area. </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>project_dest_owner</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> UNIX ID owner of the project_dest_dir. </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> <code>enabled</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLast"> can be used to stop <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> managing a project without the need to remove it from the configuration file. Values are <code>True</code> or <code>False</code>. </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol twikiLast"> MANDATORY </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
A typical configuration file looks like this:
<p />
<pre class="file">
[DEFAULT]

OSG_APP = /home/data/
sleep = 100 
starttimeout = 600 
finishtimeout = 600 
enabled = True

[MIS]
repositorysection = MIS 
projectname = mis 
project_src_dir = ""
project_dest_dir = ""
project_src_owner = ouser.mis
project_dest_owner = oasis
projectprobesconf = /etc/oasis/mis.conf

[MyVO_project1]
repositorysection = MyVO
projectname = myvo_project1
project_src_dir = srddir1
project_dest_dir = destdir1
project_src_owner = ouser.myvo_project1
project_dest_owner = oasis
projectprobesconf = /etc/oasis/myvo_project1probes.conf


[MyVO_project2]
repositorysection = MyVO
projectname = myvo_project2
project_src_dir = srddir2
project_dest_dir = destdir2
project_src_owner = ouser.myvo_project2
project_dest_owner = oasis
projectprobesconf = /etc/oasis/myvo_project2probes.conf

</pre>
<p />
<p />
<p />
<h3><a name="5_3_5_Configuring_etc_oasis_prob"></a> 5.3.5  Configuring /etc/oasis/probes.conf </h3>
<p />
It is the configuration file with generic probes for all projects. It can be left blank if no probes are needed, but the file must exists. The filename is the value of the variable <code>probesconf</code> from the <code>oasis.conf</code> file.
<p />
The section name is just an unique string, it is not the actual name of the probe. This allows to have several probes of the same type, but with different sets of parameters. 
<p />
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table4" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/OasisDeployment?cover=print;sortcol=0;table=4;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Variable</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol1"> <a rel="nofollow" href="/bin/view/Documentation/Release3/OasisDeployment?cover=print;sortcol=1;table=4;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Description</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol2 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/OasisDeployment?cover=print;sortcol=2;table=4;up=0#sorted_table" title="Sort by this column"><font color="#252b37"> Mandatory </font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>probe</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> is the actual name of probe.  The probe code will be invoked by a wrapper whose name is /usr/bin/oasis-runprobe-&lt;probe&gt; where &lt;probe&gt; is the value of this variable 'probe' In case of a project-specific probe, therefore, it can be something like  &lt;project&gt;-&lt;probe&gt;, which will be invoked by wrapper /usr/bin/oasis-runprobe-&lt;project&gt;-&lt;probe&gt; </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>options</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> list of input options to be passed raw to the probe </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol"> OPTIONAL </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>enabled</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> True/False variable.  The probe is only executed is enabled = True </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> MANDATORY </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> <code>level</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLast"> warning/abort. If warning, just logs a WARNING message, but return 0 (OK) if abort, logs a CRITICAL message and return 1 (probe failed) or some other RC </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol twikiLast"> MANDATORY </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
A typical configuration file looks like this:
<p />
<pre class="file">
[DEFAULT]
enabled = True

[probe1]
probe = probename1 
options = "foo"
level = warning

[probe2]
probe = probename2 
level = abort
</pre>
<p />
<h3><a name="5_3_6_Configuring_etc_oasis_proj"></a> 5.3.6  Configuring /etc/oasis/&lt;project&gt;probes.conf </h3>
<p />
Each Project requires a dedicated configuration file for the specific probes that only apply to that project. It can be left blank if no probes are needed, but the file must exists. The filename is the value of the variable <code>projectprobesconf</code> from the <code>oasisprojects.conf</code> file.
The format is the same than <code>oasisprobes.conf</code> 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="5_4_Configuration_of_the_login_h"></a> 5.4  Configuration of the login host </span></h2>
<p />
In case the users interact with <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> via an interface host where they can ssh and run interactively the oasis command, a new host need to be configured. 
For safety reasons, this host should always be a separate host than the server one. 
There are no specific requirements for this host in terms of Operative System needs, as it does not run any underlying technology. 
<p />
<strong>IMPORTANT: with <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> version 2.0.5-2 the login host and the server host MUST share a filesystem. The directory with the VO content files and the directory with the <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> flag files must be in a shared filesystem.</strong>
<p />
All configuration files explained for the server host should be copied to the login host. They must be identical, except for the variable <code>services</code> in the primary configuration file <code>/etc/oasis/oasis.conf</code>. 
Therefore, a typical file looks like 
<p />
<pre class="file">
[OASIS]

services = login
sleep = 100 
email = neo@matrix.net
SMTPServer = server
repositoriesconf = /etc/oasis/repositories.conf
projectsconf = /etc/oasis/projects.conf
probesconf = /etc/oasis/probes.conf
</pre>
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="5_5_Configuration_of_the_replica"></a> 5.5  Configuration of the replica host </span></h2>
<p />
For <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> version 2.0.5-2 no configuration files are needed at the replica host. 
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="5_6_Batch_oriented_configuration"></a> 5.6  Batch oriented configuration </span></h2>
<p />
If there is no interactive login host, and instead of that VO users interact with <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> via grid jobs, then a gatekeeper need to be deployed, and the local batch worker nodes act as a login host. 
Assuming the batch system is condor, an extra configuration variable is needed. A typical file would look like this:
<p />
<pre class="rootscreen">
[root@host ~]$ cat /etc/condor/config.d/condor_oasis.conf
USER_JOB_WRAPPER = /usr/libexec/oasis/oasis_job_wrapper.sh
</pre>
<p />
Also, the CE must add to the jobs environment the variable <code>$OSG_APP</code> with a proper value, in such a way the path <code>$OSG_APP/&lt;VO&gt;/...</code> corresponds with path <code>/repository_src_dir/projectr_src_dir/</code> 
<p />
<p />
<h1><a name="6_Setup_for_the_projects_and_rep"></a> 6  Setup for the projects and repositories </h1>
<p />
After the configuration files have been properly setup, each repository and project has to be created. 
This implies created the source directories -where the users place their files to be distributed- and the destination directories -where the underlying technology finds those files to be distributed-, 
as it has been explained in the previous sections. 
The corresponding UNIX accounts also need to be created, and the source directories must have proper right permissions. 
<p />
Command <code>oasis-admin-projectadd</code> facilitates that task, even it is not mandatory using it. 
For each project, it creates the corresponding source and destination paths: <code>project_src_dir</code> and <code>project_dest_dir</code>, and the UNIX IDs owning those directories: <code>project_src_owner</code> and <code>project_dest_owner</code>. 
It also creates, if needed, same paths and UNIX IDs for the repository that the project belongs to: <code>repository_src_dir</code>, <code>repository_dest_owner</code>, <code>repository_src_owner</code>, and <code>repository_dest_owner</code>.
In the case of the <code>project_dest_dir</code>, it creates the CVMFS repository properly, so the admin does <strong>not</strong> need to run command <code>cvmfs_server mkfs</code> by hand.
<p />
<pre class="rootscreen">
[root@oasis ~]$ oasis-admin-projectadd --help
oasis-admin-projectadd:
 
 Syntax:
     oasis-admin-projectadd [--help|-h] [--verbose|-v] [--project &lt;name&gt;]
 
 Description:
     prepares everything to start working with a new project.
     Creates, if needed, the UNIX user account,
     the scratch directory and destination directory.
     For the destination directory, a new repository in CVMFS is created if needed.
     All the needed information to create the project is read 
     from the "projects" and "repositories" configuration files.
     The value of input option --project must match the value
     of variable "projectname" in configuration file projects.conf
 
 Options:                    
     --help | -h         Displays usage and exits 
     --verbose | -v      Enters in DEBUG mode for the logging
     --project &lt;name&gt;    Name of the project being created

[root@oasis ~]$ oasis-admin-projectadd --project &lt;projectname&gt; 

[root@login ~]$ oasis-admin-projectadd --project &lt;projectname&gt; 
</pre>
<p />
<p />
<h1><a name="7_Start"></a> 7  Start </h1>
<p />
Once the configuration files have been properly setup, and the projects have been created, the oasis daemon must be started on the server host:
<p />
<pre class="rootscreen">
[root@oasis ~]$ service oasisd start
</pre>
<p />
<h1><a name="8_Validation"></a> 8  Validation </h1>
<p />
To validate an <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> 2 installation has been done properly, you can do it by loging into the login host as a regular user, and publish a dummy file. 
<p />
Users who log into the login host to update content should run two commands. 
First command is to ensure no orphan file has been left in the user scratch space from previous failed updates.
<p />
<pre class="screen">
[user@login ~]$ oasis-user-preinstall
</pre>
<p />
Then the user can run any compile or build command in their home directory. 
New content to be distributed should then be place in the user area. The user area path is composed as <code>/repository_src_dir/project_src_dir/</code>
where the config variables <code>repository_src_dir</code> and <code>project_src_dir</code> must be properly setup in the <a href="/bin/view/Documentation/Release3/OASIS" class="twikiLink">OASIS</a> configuration files. 
Then the user can publish:
<p />
<pre class="screen">
[user@login ~]$ oasis-user-publish --help
oasis-user-publish:
 
 Syntax:
     oasis-user-publish [--help|-h] [--wait &lt;value&gt;]
 
 Description:
     Transfers all files from the user scratch area
     to the destination area, and publishes them.
     The behavior in case there is already another publishing
     process going on for a different project depends on the
     value of the input option "wait".
     When "wait"  is TRUE, the process retains prompt and waits in a loop.
     This loop expires when the publishing can be done or when
     a timeout setup in the config files is reached.
     When "wait"  is FALSE, the process just aborts
     and a message is displayed asking the user to try later.
 
 Options:
     --help | -h         Displays usage and exits
     --wait  &lt;value&gt;     value can be False/No/Off or True/Yes/On
                         case insensitive.
                         DEFAULT: False

[user@login ~]$ oasis-user-publish 
</pre>
<p />
If everything worked fine, after a while the new dummy file should be at the server host underneath directory /cvmfs/.../
<p />
<p />
-- <span class="twikiNewLink">JoseCaballero<a href="/bin/edit/Main/JoseCaballero?topicparent=Documentation/Release3.OasisDeployment" rel="nofollow" title="JoseCaballero (this topic does not yet exist; you can create it)">?</a></span> - 08 Oct 2014</div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Documentation/Release3<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>OasisDeployment</span> <br />    
Topic revision: r29 - 12 Oct 2016 - 15:08:17 - <a href="/bin/view/Main/KyleGross" class="twikiLink">KyleGross</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />