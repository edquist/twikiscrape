<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> InstallVomsAlt &lt; Documentation/Release3 &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Documentation/Release3/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Documentation/Release3/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Documentation/Release3/InstallVomsAlt?_T=16 Feb 2017" type="application/x-wiki" title="edit InstallVomsAlt" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Documentation/Release3/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Documentation/Release3/InstallVomsAlt"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#FFFFFF;
	}
	.patternBookView {
		border-color:#FFFFFF;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--TWISTYPLUGIN_TWISTY--><style type="text/css" media="all">
@import url("https://twiki.opensciencegrid.org/twiki/pub/TWiki/TwistyContrib/twist.css");
</style>
<script type='text/javascript' src='https://twiki.opensciencegrid.org/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js'></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikiPref.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TwistyContrib/twist.compressed.js"></script>
<script type="text/javascript">
// <![CDATA[
var styleText = '<style type="text/css" media="all">.twikiMakeVisible{display:inline;}.twikiMakeVisibleInline{display:inline;}.twikiMakeVisibleBlock{display:block;}.twikiMakeHidden{display:none;}</style>';
document.write(styleText);
// ]]>
</script>

<!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

<!--TABLEPLUGIN_twikiAttachmentsTable--><style type="text/css" media="all">
.twikiTable#twikiAttachmentsTable td {border-style:solid none;}
.twikiTable#twikiAttachmentsTable th {border-style:solid none;}
.twikiTable#twikiAttachmentsTable td {vertical-align:middle;}
.twikiTable#twikiAttachmentsTable th {vertical-align:middle;}
.twikiTable#twikiAttachmentsTable td {vertical-align:top;}
.twikiTable#twikiAttachmentsTable th {background-color:#eceef2;}
.twikiTable#twikiAttachmentsTable th.twikiSortedCol {background-color:#e0e3e9;}
.twikiTable#twikiAttachmentsTable tr.twikiTableRowdataBg0 td {background-color:#ffffff;}
.twikiTable#twikiAttachmentsTable tr.twikiTableRowdataBg0 td.twikiSortedCol {background-color:#f2f3f6;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol0 {text-align:center;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol1 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol2 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol3 {text-align:right;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol4 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol5 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol6 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol7 {text-align:center;}
</style>
<!--TABLEPLUGIN_table4--><style type="text/css" media="all">
.tableSortIcon img {padding-left:.3em; vertical-align:text-bottom;}
</style></head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <h1><a name="This_page_is_deprecated_please_c"></a>  <strong>This page is deprecated, please check <a href="/bin/view/Documentation/Release3/InstallVoms" class="twikiLink">InstallVoms</a></strong> </h1>
<p />
<p />
<h1><a name="Install_VOMS"></a>  Install VOMS </h1>
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#About_this_Document"> About this Document</a>
</li> <li> <a href="?cover=print#Introduction"> Introduction</a>
</li> <li> <a href="?cover=print#How_to_get_Help"> How to get Help?</a>
</li> <li> <a href="?cover=print#Requirements"> Requirements</a> <ul>
<li> <a href="?cover=print#Host_and_OS"> Host and OS</a>
</li> <li> <a href="?cover=print#Users"> Users</a>
</li> <li> <a href="?cover=print#Certificates"> Certificates</a>
</li> <li> <a href="?cover=print#Networking"> Networking</a>
</li> <li> <a href="?cover=print#Additional_Requirements"> Additional Requirements:</a>
</li></ul> 
</li> <li> <a href="?cover=print#Installation_Procedure"> Installation Procedure</a> <ul>
<li> <a href="?cover=print#Install_the_Yum_Repositories_req"> Install the Yum Repositories required by OSG</a> <ul>
<li> <a href="?cover=print#Install_EPEL"> Install EPEL</a>
</li> <li> <a href="?cover=print#Install_the_Yum_priorities_packa"> Install the Yum priorities package</a>
</li> <li> <a href="?cover=print#Install_OSG_Repositories"> Install OSG Repositories</a>
</li></ul> 
</li> <li> <a href="?cover=print#Install_the_CA_Certificates_A_qu"> Install the CA Certificates: A quick guide</a>
</li> <li> <a href="?cover=print#Install_VOMS_AN1"> Install VOMS</a>
</li></ul> 
</li> <li> <a href="?cover=print#Initial_Configuration"> Initial Configuration</a> <ul>
<li> <a href="?cover=print#Configure_MySQL_Database"> Configure MySQL Database</a>
</li> <li> <a href="?cover=print#Setup_the_Service_Certificates"> Setup the Service Certificates</a>
</li> <li> <a href="?cover=print#Configure_Trust_Manager"> Configure Trust Manager</a>
</li> <li> <a href="?cover=print#Voms_admin_initial_setup"> Voms-admin initial setup</a>
</li></ul> 
</li> <li> <a href="?cover=print#Services_Startup_Shutdown"> Services Startup/Shutdown</a>
</li> <li> <a href="?cover=print#Configure_VOMS_and_VOMS_admin_to"> Configure VOMS and VOMS-admin to add a VO</a> <ul>
<li> <a href="?cover=print#Removing_a_VO"> Removing a VO</a>
</li></ul> 
</li> <li> <a href="?cover=print#Firewall_information"> Firewall information</a>
</li> <li> <a href="?cover=print#Advertise_your_VOMS_server"> Advertise your VOMS server</a>
</li> <li> <a href="?cover=print#Test"> Test</a> <ul>
<li> <a href="?cover=print#Voms_admin_test"> Voms-admin test</a>
</li> <li> <a href="?cover=print#Voms_core_test"> Voms-core test:</a>
</li> <li> <a href="?cover=print#Testing_edg_mkgridmap"> Testing edg-mkgridmap</a>
</li> <li> <a href="?cover=print#Testing_the_GUMS_interface"> Testing the GUMS interface</a>
</li></ul> 
</li> <li> <a href="?cover=print#Troubleshooting"> Troubleshooting</a> <ul>
<li> <a href="?cover=print#Useful_log_files"> Useful log files</a>
</li> <li> <a href="?cover=print#Fix_these_errors"> Fix these errors</a> <ul>
<li> <a href="?cover=print#VOMS_Server_for_VO_NAME_not_know"> VOMS Server for VO_NAME not known!</a>
</li> <li> <a href="?cover=print#Tomcat_is_not_starting"> Tomcat is not starting </a>
</li> <li> <a href="?cover=print#Problems_running_voms_admin"> Problems running voms-admin</a>
</li></ul> 
</li></ul> 
</li> <li> <a href="?cover=print#References"> References</a>
</li> <li> <a href="?cover=print#Comments"> Comments</a>
</li></ul> 
</div>
<p />
<!-- conventions used in this document <ul>
<li> Local UCL_HOST = voms
</li> <li> Local UCL_USER = user
</li> <li> Local UCL_DOMAIN = opensciencegrid.org
</li> <li> Set TWISTY_OPTS_DETAILED = mode="div" showlink="Show Detailed Output" hidelink="Hide" showimgleft="/twiki/pub/TWiki/TWikiDocGraphics/toggleopen-small.gif" hideimgleft="/twiki/pub/TWiki/TWikiDocGraphics/toggleclose-small.gif" remember="on" start="hide" 
</li></ul> 
-->
<p />
<form name="EDITTHIS" action="/bin/edit/Documentation/Release3/InstallVomsAlt" method="get"><input type="submit" value="Edit section" alt="Edit this section" title="Click to edit this section" class="twikiButton" style="font-size:0.75em;"><input type="hidden" value="1487214410" name="t"></form>
<p />
<h1><a name="About_this_Document"></a> About this Document </h1>
This document is for VO System Administrators. 
<p />
Here we describe how to install and configure VOMS on your Linux machine. When you install VOMS as described here, you get all three parts: MySQL database, VOMS admin and VOMS server.  Instructions for creating your VO are also on this page, in the configuration section.
<p />
We also describe how to remove a VO from VOMS if the need arises.
<p />
The installation section will give you a bare-bones installation. In order to use VOMS you need to go through the configuration: run <code>configure_voms</code> to create your VO, probably enable read-only access to your VO and probably set a VO-admin to add/remove users.
The other sections help in troubleshooting and knowing what is running.
<p />
This is not a complete reference. If you need to administer a VO, please check the <a href="https://twiki.cern.ch/twiki/bin/view/EMI/EMIVomsAdminUserGuide261" target="_top">VOMS User guide</a> linked also in the <a href="/bin/view/Documentation/Release3/InstallVomsAlt#Reference" class="twikiCurrentTopicLink twikiAnchorLink">reference</a> section.
<p />
<h1><a name="Introduction"></a> Introduction </h1>
<p />
The <a href="https://twiki.cern.ch/twiki/bin/view/EMI/EMIVomsDocumentation" target="_top">Virtual Organization Membership Service</a> allows to manage the members of a VO and their privileges (groups and roles).
It has three main parts:  <ul>
<li> MySQL database which is a persistent repository for VO membership information, 
</li> <li> VOMS admin which provides the Web UI/services to maintain the VO membership. This requires Apache/Tomcat.
</li> <li> VOMS server, a daemon process which services the <i>voms-proxy-init</i> requests.
</li></ul> 
<p />
<p />
<h1><a name="How_to_get_Help"></a> How to get Help? </h1>
To get assistance please use <a href="/bin/view/Documentation/Release3/HelpProcedure" class="twikiLink">Help Procedure</a>.
<p />
<p />
<h1><a name="Requirements"></a> Requirements </h1>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Host_and_OS"></a> Host and OS </span></h2> <ul>
<li> A host to install the VOMS Service (Pristine node)
</li> <li> OS is Red Hat Enterprise Linux 5, 6, 7, and variants (see <a href="/bin/view/Documentation/Release3/SupportedOperatingSystems" class="twikiLink">details...</a>). Currently most of our testing has been done on Scientific Linux 5.
</li> <li> Root access
</li></ul> 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Users"></a> Users </span></h2>
The VOMS and voms-admin installation will create two users unless they are already created.
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table1" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=0;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">User</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol1 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=1;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Comment</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>voms</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> Runs the VOMS daemons, one per VO. </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> <code>tomcat</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol twikiLast"> Runs tomcat5 and owns voms-admin configuration and certificates. </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Certificates"></a> Certificates </span></h2>
You will need two service certificates. <a href="/bin/view/Trash/ReleaseDocumentationGetHostServiceCertificates" class="twikiLink">Here</a> are instructions to request a host certificate. Optional, you can use the host certificate instead as explained in the <a href="/bin/view/Documentation/Release3/InstallVomsAlt#Setup_the_Service_Certificates" class="twikiCurrentTopicLink twikiAnchorLink">section below</a>.
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table2" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=0;table=2;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Certificate</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol1"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=1;table=2;up=0#sorted_table" title="Sort by this column"><font color="#252b37">User that owns certificate</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol2 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=2;table=2;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Path to certificate</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> VOMS service certificate </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> <code>voms</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> <code>/etc/grid-security/voms/vomscert.pem</code> <br> <code>/etc/grid-security/voms/vomskey.pem</code> </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> Tomcat service certificate </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLast"> <code>tomcat</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol twikiLast"> <code>/etc/grid-security/http/httpcert.pem</code> <br> <code>/etc/grid-security/http/httpkey.pem</code> </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Networking"></a> Networking </span></h2> <ul>
<li> Allow inbound and outbound network connection <em>to all GUMS servers that may query this VOMS</em>
</li> <li> Allow inbound and outbound network connection <em>to any clients who may need to voms-proxy-init</em>
</li></ul> 
|
 <strong>Service</strong> | <strong>Port</strong> | <strong>Comments</strong> |
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table3" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> VOMS server </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> 15001 * </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> The VOMS service responds to the voms-proxy-init command and to GUMS and edg-mkgridmap, it should be open to the Internet (At least all GUMS servers that may query this VOMS and any clients who may need to voms-proxy-init) </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> VOMS Admin </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLast"> 8443 </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol twikiLast"> VOMS Admin (which runs within Tomcat) is is the web interface, it must be available to VO administrators and users registering online </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
<p /> <dl>
<dt> <img src="/twiki/pub/TWiki/TWikiDocGraphics/help.gif" alt="HELP" title="HELP" width="16" height="16" border="0" />     <strong><font color="#ff0000"> NOTE </font></strong> </dt><dd>  15001 is the port specified in the <a href="/bin/view/Documentation/Release3/InstallVomsAlt#Configure_VOMS" class="twikiCurrentTopicLink twikiAnchorLink">configuration command</a>. You can choose a different one or have multiple ones if you support multiple VOs.
</dd></dl> 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Additional_Requirements"></a> Additional Requirements: </span></h2> <ul>
<li> Testing requirements <ul>
<li> The Subject and Issuer of a voms admin certificate (it could be your certificate)
</li> <li> Access to your own certificate if you want to create your voms proxy 
</li> <li> Your certificate uploaded into a browser if you want to test voms-admin WEB UI
</li></ul> 
</li></ul> 
<p />
<p /> <dl>
<dt> <img src="/twiki/pub/TWiki/TWikiDocGraphics/help.gif" alt="HELP" title="HELP" width="16" height="16" border="0" />     <strong><font color="#ff0000"> NOTE </font></strong> </dt><dd>  The configuration and testing require some familiarity with openssl commands, e.g. to extract the subject (DN) and the issuer of a certificate. If you are  not familiar please check the guides in the <a href="/bin/view/Documentation/Release3/InstallVomsAlt#References" class="twikiCurrentTopicLink twikiAnchorLink">reference section</a>: <div class="twistyPlugin twikiMakeVisibleInline">  <span id="twistyIdDocumentation/Release3InstallVomsAlt1show" class="twistyRememberSetting twistyStartHide twistyTrigger twikiUnvisited twistyInited0"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleopen-small.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">click to show an example</span></a> </span> <span id="twistyIdDocumentation/Release3InstallVomsAlt1hide" class="twistyRememberSetting twistyStartHide twistyTrigger twikiUnvisited twistyHidden twistyInited0"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleclose-small.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Hide</span></a> </span>  </div><!--/twistyPlugin twikiMakeVisibleInline--> <div class="twistyPlugin"><div id="twistyIdDocumentation/Release3InstallVomsAlt1toggle" class="twistyRememberSetting twistyStartHide twistyContent twikiMakeHidden twistyInited0">   <pre class="screen"># to whom was it issued (subject/DN)
[user@voms ~]$ openssl x509 -noout -in /etc/grid-security/hostcert.pem -subject
subject= /DC=org/DC=doegrids/OU=Services/CN=fermicloud002.fnal.gov
# issuer
[user@voms ~]$ openssl x509 -noout -in /etc/grid-security/hostcert.pem -issuer
issuer= /DC=org/DC=DOEGrids/OU=Certificate Authorities/CN=DOEGrids CA 1
</pre> </div></div> <!--/twistyPlugin-->
</dd></dl> 
<p />
<h1><a name="Installation_Procedure"></a> Installation Procedure </h1>
<p />
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Install_the_Yum_Repositories_req"></a> Install the Yum Repositories required by OSG </span></h2>
<p />
The OSG RPMs currently support Red Hat Enterprise Linux 5, 6, 7, and variants (see <a href="/bin/view/Documentation/Release3/SupportedOperatingSystems" class="twikiLink">details...</a>).
<p />
OSG RPMs are distributed via the OSG yum repositories. Some packages depend on packages distributed via the <a href="http://fedoraproject.org/wiki/EPEL" target="_top">EPEL</a> repositories. So both repositories must be enabled.
<p />
<h3><a name="Install_EPEL"></a> Install EPEL </h3>
<p /> <ul>
<li> Install the EPEL repository, if not already present. <strong>Note:</strong> This enables EPEL by default. Choose the right version to match your OS version. <pre class="rootscreen">
<font color="#ff0000"># EPEL 5 (For RHEL 5, CentOS 5, and SL 5) </font>
[root@voms ~]$ curl -O https://dl.fedoraproject.org/pub/epel/epel-release-latest-5.noarch.rpm
[root@voms ~]$ rpm -Uvh epel-release-latest-5.noarch.rpm
<font color="#ff0000"># EPEL 6 (For RHEL 6, CentOS 6, and SL 6) </font>
[root@voms ~]$ rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm
<font color="#ff0000"># EPEL 7 (For RHEL 7, CentOS 7, and SL 7) </font>
[root@voms ~]$ rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</pre>       <strong>WARNING</strong>: if you have your own mirror or configuration of the EPEL repository, you <strong>MUST</strong> verify that the OSG repository has a better yum priority than EPEL (<a href="/bin/view/Documentation/Release3/InstallBestPractices#YumPriorities" class="twikiAnchorLink">details</a>). Otherwise, you will have strange dependency resolution (<em>depsolving</em>) issues.
</li></ul> 
<p />
<h3><a name="Install_the_Yum_priorities_packa"></a> Install the Yum priorities package </h3>
<p />
For packages that exist in both OSG and EPEL repositories, it is important to prefer the OSG ones or else OSG software installs may fail. Installing the Yum priorities package enables the repository priority system to work.
<p /> <ol>
<li> <p>Choose the correct package name based on your operating system’s major version:</p> <ul>
<li> For EL&nbsp;5 systems, use <code>yum-priorities</code>
</li> <li> For EL&nbsp;6 and EL&nbsp;7 systems, use <code>yum-plugin-priorities</code>
</li></ul> 
</li> <li> <p>Install the Yum priorities package:</p>       <pre class="rootscreen">[root@voms ~]$ yum install <em>PACKAGE</em></pre>       <p>Replace <em><code>PACKAGE</code></em> with the package name from the previous step.</p>
</li> <li> <p>Ensure that <code>/etc/yum.conf</code> has the following line in the <code>[main]</code> section (particularly when using ROCKS), thereby enabling Yum plugins, including the priorities one:</p>       <pre class="file">plugins=1</pre>       <strong>NOTE</strong>: If you do not have a required key you can force the installation using <code>--nogpgcheck</code>; e.g., <code>yum install --nogpgcheck yum-priorities</code>.
</li></ol> 
<p />
<h3><a name="Install_OSG_Repositories"></a> Install OSG Repositories </h3>
<p />
<!--   1. <p>First, determine which OSG series you will be installing; 3.1 or 3.2.  The OSG 3.1 and 3.2 series are each well tested and contain the entire OSG software stack.  The 3.1 series continues to support all packages that have been released throughout its lifetime, while the 3.2 series contains newer versions of software (including HTCondor, Hadoop, glideinWMS) and removes support for obsolete packages (including CEMonitor).  Initially, most packages are identical between 3.1 and 3.2, but we expect the new series to diverge over time. <br/><br/>Note that some packages (eg, Hadoop) do not inter-operate between 3.1 and 3.2, and therefore require all nodes to use the same series.</p> -->
<p />
<ol>
   <li>
      <p>If you are upgrading from OSG 3.1 (or 3.2) to OSG 3.2 (or 3.3), remove the old OSG repository definition files and clean the Yum cache:</p>         <pre class="rootscreen">[root@voms ~]$ yum clean all
[root@voms ~]$ rpm -e osg-release</pre>       <p>This step ensures that local changes to <code>*.repo</code> files will not block the installation of the new OSG repositories. After this step, <code>*.repo</code> files that have been changed will exist in <code>/etc/yum.repos.d/</code> with the <code>*.rpmsave</code> extension. After installing the new OSG repositories (the next step) you may want to apply any changes made in the <code>*.rpmsave</code> files to the new <code>*.repo</code> files.</p>
   </li>
   <li>
      <p>Install the OSG repositories using one of the following methods depending on your EL version:</p>      <ol>
         <li>
            <p>For EL versions greater than EL5, install the files directly from <code>repo.grid.iu.edu</code>:</p>            <pre class="rootscreen">[root@voms ~]$ rpm -Uvh <font color="#ff0000">URL</font></pre>            <p>Where <code><font color="#ff0000">URL</font></code> is one of the following:</p><table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table4" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=0;table=4;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Series</font></a> </th>
			<th bgcolor="#d8dde4" align="center" valign="top" class="twikiTableCol1"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=1;table=4;up=0#sorted_table" title="Sort by this column"><font color="#252b37">EL6 URL (for RHEL 6, CentOS 6, or SL 6)</font></a> </th>
			<th bgcolor="#d8dde4" align="center" valign="top" class="twikiTableCol2 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=2;table=4;up=0#sorted_table" title="Sort by this column"><font color="#252b37">EL7 URL (for RHEL 7, CentOS 7, or SL 7)</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <font color="#252b37">OSG 3.2</font> </th>
			<td bgcolor="#ffffff" align="center" valign="top" class="twikiTableCol1"> <code>https://repo.grid.iu.edu/osg/3.2/osg-3.2-el6-release-latest.rpm</code> </td>
			<td bgcolor="#ffffff" align="center" valign="top" class="twikiTableCol2 twikiLastCol"> N/A </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> <font color="#252b37">OSG 3.3</font> </th>
			<td bgcolor="#f2f3f6" align="center" valign="top" class="twikiTableCol1 twikiLast"> <code>https://repo.grid.iu.edu/osg/3.3/osg-3.3-el6-release-latest.rpm</code> </td>
			<td bgcolor="#f2f3f6" align="center" valign="top" class="twikiTableCol2 twikiLastCol twikiLast"> <code>https://repo.grid.iu.edu/osg/3.3/osg-3.3-el7-release-latest.rpm</code> </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
         </li>
         <li>
            <p>For EL5, download the repo file and install it using the following:</p>
            <pre class="rootscreen">[root@voms ~]$ curl -O https://repo.grid.iu.edu/osg/3.2/osg-3.2-el5-release-latest.rpm
[root@voms ~]$ rpm -Uvh osg-3.2-el5-release-latest.rpm</pre>
         </li>
      </ol>
   </li>
</ol>
<p />
For more details, please see our <a href="/bin/view/Documentation/Release3/YumRepositories" class="twikiLink">yum repository documentation</a>.
<p />
<p />
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Install_the_CA_Certificates_A_qu"></a> Install the CA Certificates: A quick guide </span></h2>
<p />
You must perform one of the following <code>yum</code> commands below to select this host's CA certificates.
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table5" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=0;table=5;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Set of CAs</font></a> </th>
			<th bgcolor="#d8dde4" align="right" valign="top" class="twikiTableCol1"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=1;table=5;up=0#sorted_table" title="Sort by this column"><font color="#252b37">CA certs name</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol2 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=2;table=5;up=0#sorted_table" title="Sort by this column"><font color="#252b37"> Installation command (as root)</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> OSG </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> osg-ca-certs </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> <code>yum install osg-ca-certs</code> <font color="#ff0000"><b>Recommended</b></font> </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> IGTF </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> igtf-ca-certs </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol"> <code>yum install igtf-ca-certs</code> </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> None* </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> empty-ca-certs </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> <code>yum install empty-ca-certs --enablerepo=osg-empty</code> </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> Any** </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLast"> Any </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol twikiLast"> <code>yum install osg-ca-scripts</code> </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
* The <code>empty-ca-certs</code> RPM indicates you will be manually installing the CA certificates on the node. <br/>
** The <code>osg-ca-scripts</code> RPM provides a cron script that automatically downloads CA updates, and requires further configuration. <br/>
<p />
<p /> <dl>
<dt> <img src="/twiki/pub/TWiki/TWikiDocGraphics/help.gif" alt="HELP" title="HELP" width="16" height="16" border="0" />     <strong><font color="#ff0000"> NOTE </font></strong> </dt><dd>  If you use options 1 or 2, then you will need to run "yum update" in order to get the latest version of CAs when they are released. With option 4 a cron service is provided which will always download the updated CA package for you.
</dd></dl> 
<p /> <dl>
<dt> <img src="/twiki/pub/TWiki/TWikiDocGraphics/help.gif" alt="HELP" title="HELP" width="16" height="16" border="0" />     <strong><font color="#ff0000"> NOTE </font></strong> </dt><dd>  If you use services like Apache's httpd you must restart them after each update of the CA certificates, otherwise they will continue to use the old version of the CA certificates.
</dd></dl> 
For more details and options, please see our <a href="/bin/view/Documentation/Release3/InstallCertAuth" class="twikiLink">CA certificates documentation</a>. 
<p />
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Install_VOMS_AN1"></a> Install VOMS </span></h2>
<p /> <ol>
<li> Install OSG-VOMS:<pre class="rootscreen">
[root@voms ~]$ yum install osg-voms
</pre>  <div class="twistyPlugin twikiMakeVisibleInline">  <span id="twistyIdDocumentation/Release3InstallVomsAlt2show" class="twistyRememberSetting twistyStartHide twistyTrigger twikiUnvisited twistyInited0"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleopen-small.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Show Detailed Output</span></a> </span> <span id="twistyIdDocumentation/Release3InstallVomsAlt2hide" class="twistyRememberSetting twistyStartHide twistyTrigger twikiUnvisited twistyHidden twistyInited0"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleclose-small.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Hide</span></a> </span>  </div><!--/twistyPlugin twikiMakeVisibleInline--> <div class="twistyPlugin"><div id="twistyIdDocumentation/Release3InstallVomsAlt2toggle" class="twistyRememberSetting twistyStartHide twistyContent twikiMakeHidden twistyInited0">   <pre class="rootscreen">
[root@voms ~]$ yum install osg-voms
Loaded plugins: kernel-module
Setting up Install Process
Resolving Dependencies
--> Running transaction check
---> Package osg-voms.noarch 0:3.0.0-1 set to be updated
--> Processing Dependency: voms-mysql-plugin for package: osg-voms
--> Processing Dependency: voms-server for package: osg-voms
--> Processing Dependency: voms-admin-server for package: osg-voms
--> Processing Dependency: voms-admin-client for package: osg-voms
--> Processing Dependency: mysql-server for package: osg-voms
...
Dependencies Resolved

=================================================================================================================================
 Package                                Arch              Version                                Repository                 Size
=================================================================================================================================
Installing:
 osg-voms                               noarch            3.0.0-1                                osg                       1.6 k
Installing for dependencies:
 PyXML                                  x86_64            0.8.4-4.el5_4.2                        fermi-security            1.0 M
 alsa-lib                               x86_64            1.0.17-1.el5                           sl-base                   414 k
...
Transaction Summary
=================================================================================================================================
Install      67 Package(s)
Upgrade       0 Package(s)

Total download size: 247 M
Is this ok [y/N]: y
Downloading Packages:
(1/67): osg-voms-3.0.0-1.noarch.rpm                                                                       | 1.6 kB     00:00     
(2/67): geronimo-specs-compat-1.0-0.M2.2jpp.12.x86_64.rpm                                                 | 5.4 kB     00:00     
(3/67): libXtst-1.0.1-3.1.x86_64.rpm                                                                      |  16 kB     00:00     
(4/67): xml-commons-1.3.02-0.b2.7jpp.10.x86_64.rpm                                                        |  19 kB     00:00     
...
(67/67): jdk-1.6.0_26-fcs.x86_64.rpm                                                                      |  68 MB     00:02     
---------------------------------------------------------------------------------------------------------------------------------
Total                                                                                             14 MB/s | 247 MB     00:17     
warning: rpmts_HdrFromFdno: Header V3 DSA signature: NOKEY, key ID 217521f6
epel/gpgkey                                                                                               | 1.7 kB     00:00     
Importing GPG key 0x217521F6 "Fedora EPEL <epel@fedoraproject.org>" from /etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL
Is this ok [y/N]: y
Running rpm_check_debug
Running Transaction Test
Finished Transaction Test
Transaction Test Succeeded
Running Transaction
  Installing     : perl-DBI                                                                                                 1/67 
  Installing     : mysql                                                                                                    2/67 
  Installing     : PyXML                                                                                                    3/67 
...
  Installing     : osg-voms                                                                                                67/67 

Installed:
  osg-voms.noarch 0:3.0.0-1                                                                                                      

Dependency Installed:
  PyXML.x86_64 0:0.8.4-4.el5_4.2                                 alsa-lib.x86_64 0:1.0.17-1.el5                                 
  ant.x86_64 0:1.6.5-2jpp.2                                      antlr.x86_64 0:2.7.6-4jpp.2            
...
  xerces-j2.x86_64 0:2.7.1-7jpp.2.el5_4.2                        xml-commons.x86_64 0:1.3.02-0.b2.7jpp.10                       
  xml-commons-apis.x86_64 0:1.3.02-0.b2.7jpp.10                  xml-commons-resolver.x86_64 0:1.1-1jpp.12                      

Complete!
</pre> </div></div> <!--/twistyPlugin-->
</li></ol> 
<p />
<p />
<p />
<h1><a name="Initial_Configuration"></a> Initial Configuration </h1>
This section is presenting only the basic configuration. All the servers are useless until you add at least one VO by completing also the <a href="/bin/view/Documentation/Release3/InstallVomsAlt#Configure_VOMS_and_VOMS_admin_to" class="twikiCurrentTopicLink twikiAnchorLink">VO configuration</a>.
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Configure_MySQL_Database"></a> Configure MySQL Database </span></h2>
<p />
Before you will be able configure VOMS you will need to have access to MySQL database.  The MySQL software is installed with the <code>osg-voms</code> package. By default it will be using port 3306 and will not have password for <code><b>root</b></code>. 
<p />
It is not necessary to change the port number if you don't want to. If you want to modify the port you will need to edit <code><b>/etc/my.cnf</b></code> file and add a new port:<pre class="file">
[mysqld]
datadir=/var/lib/mysql
socket=/var/lib/mysql/mysql.sock
port=<font color="#ff0000">MYSQL_PORT_NUMBER</font>
</pre>   
It is wise to set a password for the <code><b>root</b></code> user. Run the following command to set the password:<pre class="rootscreen">
[root@voms ~]$ /etc/init.d/mysqld start
[root@voms ~]$ mysqladmin -u root password <font color="#ff0000">top_secret</font>
</pre> 
<p />
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Setup_the_Service_Certificates"></a> Setup the Service Certificates </span></h2>
Make sure that you have the host, VOMS and Tomcat service certificates/keys in the right directories and with the correct owners and permissions (<code>600</code> for key and <code>644</code> the certificate). <a href="/bin/view/Trash/ReleaseDocumentationGetHostServiceCertificates" class="twikiLink">Host certificate</a> is required and must be in <code>/etc/grid-security/hostcert.pem</code> and <code>hostkey.pem</code>. It is recommended to provide also service certificates for VOMS and Tomcat. If you don't, here are the instructions to copy the host certificate/key and set the correct owner (permissions are preserved).  Note that if you did not previously have a voms or tomcat user on your system, they were added during the RPM install: <ol>
<li> VOMS-core daemon is running as user <code><b>voms</b></code> and requires its service certificate and key in <code><b>/etc/grid-security/voms</b></code>. To copy the host certificate/key for this service, you need to do the following:<pre class="rootscreen">
[root@voms ~]$ cd /etc/grid-security
[root@voms ~]$ cp hostcert.pem voms/vomscert.pem
[root@voms ~]$ cp hostkey.pem voms/vomskey.pem
[root@voms ~]$ chown -R voms:voms voms
</pre>
</li> <li> Tomcat service is running as user <code><b>tomcat</b></code> and requires its service certificate and key in <code><b>/etc/grid-security/http</b></code>. To copy the host certificate/key for this service, you need to do the following:<pre class="rootscreen">
[root@voms ~]$ cd /etc/grid-security
[root@voms ~]$ mkdir /etc/grid-security/http
[root@voms ~]$ cp hostcert.pem http/httpcert.pem
[root@voms ~]$ cp hostkey.pem http/httpkey.pem
[root@voms ~]$ chown -R tomcat:tomcat http
</pre>
</li></ol> 
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Configure_Trust_Manager"></a> Configure Trust Manager </span></h2>
<p />
Configure Tomcat's trust manager. This must be done once, before starting up Tomcat for the first time: <ol>
<li> You have to configure Tomcat in order to enable EMI trustmanager:<pre class="rootscreen">
[root@voms ~]$ /var/lib/trustmanager-tomcat/configure.sh
Info: using default install root: /
Info: using default configuration file: //var/lib/trustmanager-tomcat/config.properties
Info: using default configuration directory: //var/lib/trustmanager-tomcat
Info: you can clean up using the following commands
      mv -f /etc/tomcat5/server.xml.old-trustmanager /etc/tomcat5/server.xml
      rm -f /usr/share/tomcat5/server/lib/bcprov*.jar
      rm -f /usr/share/tomcat5/server/lib/log4j*.jar
      rm -f /usr/share/tomcat5/server/lib/trustmanager-*.jar
      rm -f /etc/tomcat5/log4j-trustmanager.properties
      rm -f //var/lib/trustmanager-tomcat/server.xml
</pre>
</li></ol> 
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Voms_admin_initial_setup"></a> Voms-admin initial setup </span></h2>
You need to preform some initial configuration to be able to startup the services.
<p />
<p /> <dl>
<dt> <img src="/twiki/pub/TWiki/TWikiDocGraphics/warning.gif" alt="ALERT!" title="ALERT!" width="16" height="16" border="0" />     <strong><font color="#ff0000"> WARNING! </font></strong> </dt><dd>  <a href="https://twiki.opensciencegrid.org/twiki/pub/Documentation/Release3/InstallVomsAlt/voms-admin-configure-zero" target="_top">voms-admin-configure-zero</a>: voms-admin-configure-zero is not yet in the RPM, it is attached to this document. You need to download and install it in <code>/usr/sbin</code>.
</dd></dl> 
<p />
<pre class="rootscreen">
[root@voms ~]$ voms-admin-configure-zero
</pre>
<p />
<p />
<h1><a name="Services_Startup_Shutdown"></a> Services Startup/Shutdown </h1>
VOMS has its persistent repository in a MySQL database, that requires <code>mysql</code> to be running in order to be queried.
All grid interactions require updated CA certificates and CRLs.
Then the <em>voms server</em> is a daemon servicing authentication requests and <em>voms-admin</em>, requiring Tomcat, is a Web UI/service to manage the VO membership. 
<p />
<p /> <dl>
<dt> <img src="/twiki/pub/TWiki/TWikiDocGraphics/help.gif" alt="HELP" title="HELP" width="16" height="16" border="0" />     <strong><font color="#ff0000"> NOTE </font></strong> </dt><dd>  If there are no VO configured (see next section) the services will actually perform no action. 
</dd></dl> 
<p />
<p />
To start VOMS you need to start several services: <ol>
<li>  You need to fetch the latest CA Certificate Revocation Lists (CRLs) and you should enable the fetch-crl service to keep the CRLs up to date:<pre class="rootscreen">
<font color="#ff0000"># For RHEL 5, CentOS 5, and SL5 </font>
[root@voms ~]$ /usr/sbin/fetch-crl3   # This fetches the CRLs 
[root@voms ~]$ /sbin/service fetch-crl3-boot start
[root@voms ~]$ /sbin/service fetch-crl3-cron start
<font color="#ff0000"># For RHEL 6, CentOS 6, and SL6, or OSG 3 _older_ than 3.1.15 </font>
[root@voms ~]$ /usr/sbin/fetch-crl   # This fetches the CRLs 
[root@voms ~]$ /sbin/service fetch-crl-boot start
[root@voms ~]$ /sbin/service fetch-crl-cron start
<font color="#ff0000"># For RHEL 7, CentOS 7, and SL7 </font>
[root@voms ~]$ /usr/sbin/fetch-crl   # This fetches the CRLs 
[root@voms ~]$ systemctl start fetch-crl-boot
[root@voms ~]$ systemctl start fetch-crl-cron
</pre> For more details and options, please see our <a href="/bin/view/Documentation/Release3/InstallCertAuth#Managing_Certificate_Revocation" class="twikiAnchorLink">CRL documentation</a>.  
</li> <li> MySQL server needs to be running if it is not already:<pre class="rootscreen">
[root@voms ~]$ /sbin/chkconfig mysqld on
[root@voms ~]$ /sbin/service mysqld start
</pre>
</li> <li> Start voms server (you should see one <code>voms</code> process for each VO you have configured)<pre class="rootscreen">
[root@voms ~]$ /sbin/chkconfig voms on
[root@voms ~]$ service voms start
</pre>
</li> <li> Start Tomcat, required by voms-admin:<pre class="rootscreen">
[root@voms ~]$ /sbin/chkconfig tomcat5 on
[root@voms ~]$ service tomcat5 start
</pre>
</li> <li> Start voms-admin (you will see only a <code>tomcat</code> process, since voms-admin is a webapp running within Tomcat):<pre class="rootscreen">
[root@voms ~]$ /sbin/chkconfig voms-admin on
[root@voms ~]$ service voms-admin start
</pre>
</li></ol> 
<p />
<p />
<p />
To stop VOMS you need to stop voms and voms-admin, and also the services they use if nothing else is using them: <ol>
<li> Stop voms-admin:<pre class="rootscreen">
[root@voms ~]$ service voms-admin stop
</pre>
</li> <li> Stop voms server<pre class="rootscreen">
[root@voms ~]$ service voms stop
</pre>
</li> <li> , Stop Tomcat, if no other application is using it:<pre class="rootscreen">
[root@voms ~]$ service tomcat5 stop
</pre>
</li> <li> Stop MySQL server if no other application is using it:<pre class="rootscreen">
[root@voms ~]$ service mysql stop
</pre>
</li> <li>  To stop fetch-crl:<pre class="rootscreen">
<font color="#ff0000"># For RHEL 5, CentOS 5, and SL5 </font>
[root@voms ~]$ /sbin/service fetch-crl3-boot stop
[root@voms ~]$ /sbin/service fetch-crl3-cron stop
<font color="#ff0000"># For RHEL 6, CentOS 6, and SL6, or OSG 3 _older_ than 3.1.15 </font>
[root@voms ~]$ /sbin/service fetch-crl-boot stop
[root@voms ~]$ /sbin/service fetch-crl-cron stop
<font color="#ff0000"># For RHEL 7, CentOS 7, and SL7 </font>
[root@voms ~]$ systemctl stop fetch-crl-boot
[root@voms ~]$ systemctl stop fetch-crl-cron
</pre> For more details and options, please see our <a href="/bin/view/Documentation/Release3/InstallCertAuth#Managing_Certificate_Revocation" class="twikiAnchorLink">CRL documentation</a>.  
</li></ol> 
<p />
<p />
<p />
<h1><a name="Configure_VOMS_and_VOMS_admin_to"></a> Configure VOMS and VOMS-admin to add a VO </h1>
These steps will create the database and configure VOMS-core and VOMS-admin to add a VO and will perform some basic setup to make it manageable. 
Before proceeding with the next steps make sure that voms, tomcat5 and voms-admin are running.
If you'd like to add multiple VOs you need to repeat the following steps for each VO and make sure that the name (<code>--vo</code>) and the VOMS server port (<code>--port</code>) selected in the first step are different for each VO
<p />
<p /> <ol>
<li> Run <code><b>voms-admin-configure</b></code> script to create a new VO:<pre class="rootscreen">
[root@voms ~]$ voms-admin-configure install --dbtype mysql --vo <font color="#ff0000">VO_NAME</font> \
    --createdb --deploy-database  --dbauser root  --dbapwd <font color="#ff0000">MYSQL_ROOT_PASSD</font> \
    --dbusername  admin-<font color="#ff0000">VO_NAME</font> --dbpassword <font color="#ff0000">secret </font> --dbport  <font color="#ff0000">DB_PORT</font> \
    --port <font color="#ff0000">VOMS_PORT</font>  --mail-from <font color="#ff0000">email</font> --smtp-host <font color="#ff0000">smtp.domain</font> \
    --sqlloc /usr/lib<font color="#ff0000">64</font>/voms/libvomsmysql.so --cert /etc/grid-security/voms/vomscert.pem \
    --key  /etc/grid-security/voms/vomskey.pem --read-access-for-authenticated-clients 
</pre> For example for the test1 VO:<pre class="rootscreen">
[root@voms ~]$ voms-admin-configure install --dbtype mysql --vo test1 --createdb \
     --deploy-database --dbauser root --dbapwd  top_secret \
     --dbusername admin_test1 --dbpassword secret --dbport 3306 \
     --port 15001 --mail-from tlevshin@fnal.gov --smtp-host smtp.fnal.gov \
     --sqlloc /usr/lib64/voms/libvomsmysql.so --cert /etc/grid-security/voms/vomscert.pem \
     --key  /etc/grid-security/voms/vomskey.pem --read-access-for-authenticated-clients 
</pre> If the above command is executed correctly a lot of sql stuff will scroll across the screen, followed by <pre class="rootscreen">
Deploying voms database...
Database deployed correctly!



VO test1 installation finished.
 
You can start the voms services using the following commands:
    /etc/init.d/voms start test1
    /etc/init.d/voms-admin start test1
</pre>
</li> <li> Restart VOMS and VOMS-admin:<pre class="rootscreen">
[root@voms ~]$ service voms restart 
[root@voms ~]$ service voms-admin start
</pre>
</li> <li> Add a local admin:<pre class="rootscreen">
[root@voms ~]$ /usr/sbin/voms-db-deploy.py add-admin --vo <font color="#ff0000">VO_NAME</font>  \
        --dn  <font color="#ff0000">HOST_CERT_SUBJECT</font> \
        --ca <font color="#ff0000">HOST_CERT_ISSUER</font> 
</pre>For example:<pre class="rootscreen">
[root@voms ~]$ /usr/sbin/voms-db-deploy.py add-admin --vo test1 \
     --dn /DC=org/DC=doegrids/OU=Services/CN=fermicloud002.fnal.gov \
     --ca "/DC=org/DC=DOEGrids/OU=Certificate Authorities/CN=DOEGrids CA 1"
</pre>
</li> <li>  Do the following command to allow <code>GUMS</code> and <code>edg-mkgridmap</code> to query your VO for the set of users: <pre class="rootscreen">
voms-admin --nousercert --vo <font color="#ff0000">VO_NAME</font> add-ACL-entry /<font color="#ff0000">VO_NAME</font> ANYONE VOMS_CA "CONTAINER_READ,MEMBERSHIP_READ" true
</pre> For example: <pre class="rootscreen">
voms-admin --nousercert --vo test1 add-ACL-entry /test1 ANYONE VOMS_CA "CONTAINER_READ,MEMBERSHIP_READ" true
</pre>
</li> <li> Allow compatibility with <code>GUMS</code> and <code>edg-mkgridmap</code>. Edit <code>/etc/voms-admin/<font color="#ff0000">VO_NAME</font>/voms.service.properties</code> by adding the following line to the file: <pre class="rootscreen">
voms.csrf.log_only = true
</pre>
</li></ol> 
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Removing_a_VO"></a> Removing a VO </span></h2>
If you added the VO just for testing purposes, you can remove it using <code>voms-admin-configure remove --vo <font color="#ff0000">VONAME</font></code> as documented in the [[https://twiki.cern.ch/twiki/bin/view/EMI/EMIVomsAdminUserGuide261#Removing_a_VO][user guide], e.g.: <pre class="rootscreen">
[root@voms ~]$ voms-admin-configure remove --vo test1
voms-admin-configure, version 2.6.1

Removing vo  test1
VO test1 succesfully removed.
</pre>
<p />
<p />
<p />
<h1><a name="Firewall_information"></a> Firewall information </h1>
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table6" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=0;table=6;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Service</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol1"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=1;table=6;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Port</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol2 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=2;table=6;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Comments</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> VOMS server </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> 15001 </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> The VOMS service responds to the voms-proxy-init command and to GUMS and edg-mkgridmap, it should be open to the Internet </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> VOMS Admin </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLast"> 8443 </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol twikiLast"> VOMS Admin (which runs within Tomcat) is is the web interface, it must be available to VO administrators and users registering online </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
<p /> <dl>
<dt> <img src="/twiki/pub/TWiki/TWikiDocGraphics/help.gif" alt="HELP" title="HELP" width="16" height="16" border="0" />     <strong><font color="#ff0000"> NOTE </font></strong> </dt><dd>  15001 is the port specified in the <a href="/bin/view/Documentation/Release3/InstallVomsAlt#Configure_VOMS" class="twikiCurrentTopicLink twikiAnchorLink">configuration command</a>. You can choose a different one or have multiple ones if you support multiple VOs.
</dd></dl> 
<p />
<h1><a name="Advertise_your_VOMS_server"></a> Advertise your VOMS server </h1>
<p />
A working VOMS server can be contacted to sign certificates extensions (e.g., by <code>voms-proxy-init</code>) or to verify VO memberships (e.g., by <a href="/bin/view/Documentation/GlossaryG#DefsGridUserManagementSystem" class="twikiAnchorLink">GUMS</a>) only if it is on the list of valid VOMS servers (<code><b>/etc/vomses</b></code>) and if there is an LSC file for that VO. Some grid services (glite-FTS and glite-WMS) even require a copy of the VOMS server certificate.
<p />
The file <code><b>/etc/vomses</b></code> contains a list of VOs and their VOMS servers. A VOMS server may appear on multiple lines if it is serving multiple VOs on different ports. All lines contain:<pre class="file">
"<font color="#ff0000">alias</font>" "<font color="#ff0000">HOST_NAME</font>" "<font color="#ff0000">PORT</font>" "<font color="#ff0000">HOST_DN</font>" "<font color="#ff0000">VO_NAME</font>"
</pre> For example:
<pre class="file">
"test1" "fermicloud002.fnal.gov" "15001" "/DC=org/DC=doegrids/OU=Services/CN=fermicloud002.fnal.gov" "test1"
</pre> 
<p />
The <a href="https://twiki.cern.ch/twiki/bin/view/LCG/VOMSLSCfileConfiguration" target="_top">LSC file</a> (LiSt of Certificates) is another description of your VOMS server:
<p /> <ul>
<li> It is located in <code><b>$X509_VOMS_DIR/${VO}</b></code>, by default <code><b>/etc/grid-security/vomsdir/${VO}</b></code>
</li> <li> The filename is the fully qualified hostname (FQDN) of your server, followed by <code><b>.lsc</b></code>
</li> <li> The first line contains the subject DN of the VOMS server host certificate, without quotes
</li> <li> The second line contains the subject DN of the CA that issued the VOMS server host certificate, also without quotes
</li></ul> 
<p />
For example, for the VO named <code>test1</code> hosted on <code>fermicloud002</code>, the LSC file named <code><b>/etc/grid-security/vomsdir/test1/fermicloud002.fnal.gov.lsc</b></code> might contain: <pre class="file">
/DC=org/DC=doegrids/OU=Services/CN=fermicloud002.fnal.gov
/DC=org/DC=DOEGrids/OU=Certificate Authorities/CN=DOEGrids CA 1
</pre> 
<p />
The VOMS server manager must distribute the line for <code>/etc/vomses</code> and the LSC file to all hosts that will contact the VOMS server. OSG distributes with all its client and server installations a default list of VOMS servers (<code>/etc/vomses</code>) and a default set of LSC files. These are part of the <code>vo-client</code> RPM.
<p />
To be included, use the VO Registration function at <a href="https://oim.grid.iu.edu/oim/vo" target="_top">OIM VO Registration</a>.  Even if you are already registered as a VO you need to notify the Grid Operations Center if the information in the vomses file or the LSC file has changed.
<p />
<p />
<p />
<h1><a name="Test"></a> Test </h1>
To test VOMS you can add a member (her/his certificate) to a VO using voms-admin, login in the Web UI and then: <ul>
<li> use the voms server to generate a proxy for that certificate. 
</li> <li> or generate a grid-mapfile
</li> <li> or query with GUMS
</li></ul> 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Voms_admin_test"></a> Voms-admin test </span></h2>
Add a member(yourself) to the VO:<pre class="rootscreen">
[root@voms ~]$ voms-admin --vo <font color="#ff0000">VO_NAME</font> --host <font color="#ff0000">HOST_NAME</font> \
       --nousercert create-user <font color="#ff0000">USER_CERT_SUBJECT</font> <font color="#ff0000">USER_CERT_ISSUER</font> \
       <font color="#ff0000">USER_COMMON_NAME</font> <font color="#ff0000">email</font> 
</pre> For example:<pre class="rootscreen">
[root@voms ~]$ voms-admin --vo test1 --host fermicloud002 --nousercert create-user \
   "/DC=org/DC=doegrids/OU=People/CN=Joe Doe 12345" "/DC=org/DC=DOEGrids/OU=Certificate Authorities/CN=DOEGrids CA 1" 
   "Joe Doe" jdoe@fnal.gov
</pre>Assign VOAdmin role to yourself, so you can manage the VO using the Web UI:<pre class="rootscreen">
voms-admin --vo <font color="#ff0000">VO_NAME</font> --host <font color="#ff0000">HOST_NAME</font> \
    --nousercert assign-role  <font color="#ff0000">/VO_NAME</font>  VO-Admin  \
      <font color="#ff0000">USER_CERT_SUBJECT</font> <font color="#ff0000">USRT_CERT_ISSUER</font> 
</pre>For example:<pre class="rootscreen">
[root@voms ~]$ voms-admin --vo test1 --host fermicloud002 --nousercert assign-role /test1   VO-Admin  \
   "/DC=org/DC=doegrids/OU=People/CN=Joe Doe 12345" "/DC=org/DC=DOEGrids/OU=Certificate Authorities/CN=DOEGrids CA 1" </pre>
<p />
Check the Web UI by accessing <code><b>https://<font color="#ff0000">hostname</font>:8443/vomses</b></code>. If you have your certificate loaded into the browser you will be able to manage the VO.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Voms_core_test"></a> Voms-core test: </span></h2>
To use your VOMS you need to add a line with its description (similar to the following) to <code><b>/etc/vomses</b></code>, a file containing a list of all valid voms servers:<pre class="file">
"<font color="#ff0000">alias</font>" "<font color="#ff0000">HOST_NAME</font>" "<font color="#ff0000">PORT</font>" "<font color="#ff0000">HOST DN</font>" "<font color="#ff0000">VO_NAME</font>"
</pre> For example:
<pre class="file">
"test1" "fermicloud002.fnal.gov" "15001" "/DC=org/DC=doegrids/OU=Services/CN=fermicloud002.fnal.gov" "test1"
</pre> 
Use <code><b>voms-proxy-init</b></code> to generate proxy. Login as user, create <code><b>vomses</b></code> file (e.g. <code>~/.vomses</code>). Generate voms proxy<pre class="screen">
[user@voms ~]$ voms-proxy-init -voms <font color="#ff0000">VO_NAME</font> -vomses ~/vomses
</pre>
<p />
<a href="/bin/view/Documentation/Release3/TestOSGClient#Authentication_using_a_VOMS_Prox" class="twikiAnchorLink">Click here</a> for a more detailed example on using and verifying a VOMS proxy.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Testing_edg_mkgridmap"></a> Testing edg-mkgridmap </span></h2>
The <code>edg-mkgridmap</code> command is run on a site's %GLOSSARY_CE% node to generated a <code>grid-mapfile</code> file.  This script is not provided as a part of the VOMS installation, so you will have to go a CE node to test this.  You do not have to be the <code>root</code> user on the CE node, but you will need to have a personal certificate available.
<p />
The <code>mkgridmap</code> file syntax/values for each VO you create, can be viewed on the WEB UI for your VO by selecting <code>Configuration information</code> on the left hand menu of the main page.
<p />
<pre class="file">
group vomss://cms-xen3.fnal.gov:8443/voms/VDT  vdt
</pre>
<p />
<p /> <dl>
<dt> <img src="/twiki/pub/TWiki/TWikiDocGraphics/help.gif" alt="HELP" title="HELP" width="16" height="16" border="0" />     <strong><font color="#ff0000"> NOTE </font></strong> </dt><dd>  The <code>vdt</code> (3rd token) is an EDG format for the account name.   You will likely want to change it to the group unix account you want assigned for your CE node.  The example above is for a <code>group</code> account assignment.
</dd></dl> 
<p />
To test, you will need to do this on a CE node where the authorization mode is "gridmap" (lcmaps or PRIMA are not enabled): <ol>
<li> In some writable area, create a <code>edg-mkgridmap.conf</code> file and populate it with the example configuration file on your VOMS server.  It will be the only entry. <pre class="rootscreen">
[root@voms ~]$ echo 'group vomss://cms-xen3.fnal.gov:8443/voms/VDT  vdt' >./edg-mkgridmap.conf
</pre>
</li> <li> Execute the edg-mkgridmap: <pre class="rootscreen">
[root@voms ~]$ source $VDT_LOCATION/setup.sh
[root@voms ~]$ edg-mkgridmap --conf ./edg-mkgridmap.conf 
  <em>... the output will be in /etc/grid-security/grid-mapfile and will look as follows ...</em>
  "/DC=org/DC=doegrids/OU=People/CN=John Weigand 458491"  vdt
  "/DC=org/DC=doegrids/OU=Services/CN=cms-xen3.fnal.gov"   vdt
</pre>
</li></ol> 
<p />
You can find more in the <a href="/bin/view/Documentation/Release3/InstallComputeElement#CeEdgMkgridmap" class="twikiAnchorLink">Compute Element install document</a>.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Testing_the_GUMS_interface"></a> Testing the GUMS interface </span></h2>
The GUMS authorization server periodically 'pulls' the VO membership data for it's authorization and account assignment  functions from the various VO's VOMS servers.  
<p />
Unfortunately, there is no way of testing this except with an installed GUMS server which this document does not address.
<p />
See <a href="/bin/view/Trash/ReleaseDocumentationInstallConfigureAndManageGUMS" class="twikiLink">Install Configure and Manage GUMS</a> for more information. 
<p />
<p />
<h1><a name="Troubleshooting"></a> Troubleshooting </h1>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Useful_log_files"></a> Useful log files </span></h2>
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table7" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=0;table=7;up=0#sorted_table" title="Sort by this column"><font color="#252b37">File</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol1 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=1;table=7;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Description</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>/var/log/tomcat5/catalina.out</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> This is the Tomcat log file. Problems (and a lot of noise) are reported here. </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>/var/log/tomcat5/voms-admin-VO_NAME.log</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> This is the vo-by-vo log for voms-admin Web UI </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> <code>/var/log/tomcat5/trustmanager.log</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> The trustmanager handles things related to authentication. Useful errors are sometimes here. </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> <code>/var/log/voms/voms.VO_NAME</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol twikiLast"> This is the log of the VOMS daemon for each VO </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Fix_these_errors"></a> Fix these errors </span></h2>
<h3><a name="VOMS_Server_for_VO_NAME_not_know"></a> VOMS Server for VO_NAME not known! </h3>
If you saw an error like "VOMS Server for VO_NAME not known!" probably you did not add the VO VO_NAME (e.g. test1) to <code>/etc/vomses</code>
<p />
<h3><a name="Tomcat_is_not_starting"></a> Tomcat is not starting </h3>
If Tomcat is not starting and <code>/var/log/tomcat5/catalina.out</code> contains an error like "/usr/bin/tomcat5: line 331: /usr/lib/java/bin/java: No such file or directory", then you may have to uncomment the line <code><b>JAVA_HOME="/usr/lib/jvm/java"</b></code> in <code><b>/etc/tomcat5/tomcat5.conf</b></code>. The Jpackage repository is known to provide a misconfigured tomcat5 package.
<p />
<h3><a name="Problems_running_voms_admin"></a> Problems running voms-admin </h3>
Verify if voms-admin was configured and started correctly: <ul>
<li> If voms-admin is not responding and you get a "Socket error 111" try restartig tomcat5 and voms-admin
</li> <li> If there are BC (bouncycastle) related errors in Tomcat's log file (<code>/var/log/tomcat5/catalina.out</code>), the trust manager may not be configured correctly. Try to run <code>/var/lib/trustmanager-tomcat/configure.sh</code>
</li> <li> If you get an error like "Socket error: (1, 'error:14094416:SSL routines:SSL3_READ_BYTES:sslv3 alert certificate unknown')" probably you have no CRLs for your CA certificates. You can see in <code>/var/log/tomcat5/trustmanager.log</code> that Tomcat is discarding CA certificates without CRL. Run <code>fetch-crl</code>.
</li></ul> 
<p />
<p />
<h1><a name="References"></a> References </h1>
EMI documentation: <ol>
<li> <a href="https://twiki.cern.ch/twiki/bin/view/EMI/EMIVomsDocumentation" target="_top">EMI VOMS documentation</a>
</li> <li> <a href="https://twiki.cern.ch/twiki/bin/view/EMI/EMIVomsAdminUserGuide261" target="_top">VOMS Admin User Guide</a>
</li> <li> <a href="https://twiki.cern.ch/twiki/bin/view/EMI/VOMSystemAdministratorGuide" target="_top">VOMS System Admin Guide</a>
</li> <li> <a href="https://twiki.cern.ch/twiki/bin/view/LCG/VOMSLSCfileConfiguration" target="_top">How to configure VOMS LSC files</a>
</li></ol> 
<p />
<!--
<a href="http://www.eu-emi.eu/documentation" target="_top">EMI</a>/gLite documentation:
<a href="https://twiki.cnaf.infn.it/twiki/bin/view/VOMS/WebArchitecture" target="_top">https://twiki.cnaf.infn.it/twiki/bin/view/VOMS/WebArchitecture</a>
<a href="https://twiki.cern.ch/twiki/bin/view/EGEE/VomsAdminUserGuide" target="_top">https://twiki.cern.ch/twiki/bin/view/EGEE/VomsAdminUserGuide</a>
<a href="https://twiki.cern.ch/twiki/bin/view/EGEE/VomsInstallGuide_32" target="_top">https://twiki.cern.ch/twiki/bin/view/EGEE/VomsInstallGuide_32</a>
<a href="https://twiki.cern.ch/twiki/bin/view/LCG/VomsFAQforServiceManagers" target="_top">https://twiki.cern.ch/twiki/bin/view/LCG/VomsFAQforServiceManagers</a>
<a href="https://edms.cern.ch/file/973684/1/voms-guide.pdf" target="_top">https://edms.cern.ch/file/973684/1/voms-guide.pdf</a>
-->
<p />
Openssl commands: <ul>
<li> brief: <a href="http://www.switch.ch/grid/certificates/openssl/index.html" target="_top">http://www.switch.ch/grid/certificates/openssl/index.html</a>
</li> <li> more comprehensive: <a href="http://security.ncsa.illinois.edu/research/grid-howtos/usefulopenssl.html" target="_top">http://security.ncsa.illinois.edu/research/grid-howtos/usefulopenssl.html</a>
</li></ul> 
<p />
<p />
<p />
<h1><a name="Comments"></a> Comments </h1>
<p />
<form method="post" action="https://twiki.opensciencegrid.org/bin/save/Documentation/Release3/InstallVomsAlt" enctype="multipart/form-data" name="tableappend0" id="tableappend0">
<p />
<div class="commentPlugin commentPluginPromptBox">
<table><tr valign="middle"><td><textarea  rows="3" cols="70" name="comment" wrap="soft" onfocus="if(this.value=='')this.value=''" onblur="if(this.value=='')this.value=''"></textarea></td><td><input  type="submit" value="Add comment" /></td></tr></table>
</div><!--/commentPlugin-->
<p />
<input type="hidden" name="comment_action" value="save"  />
<input type="hidden" name="comment_type" value="tableappend"  />
<input type="hidden" name="comment_index" value="0"  /></form>
<p />
<p />
<!-- CONTENT MANAGEMENT PROJECT
############################################################################################################
 DEAR DOCUMENT OWNER
 <code><b>===============</b></code>
<p />
 Thank you for claiming ownership for this document! Please fill in your <span class="twikiNewLink">FirstLast<a href="/bin/edit/Documentation/Release3/FirstLast?topicparent=Documentation/Release3.InstallVomsAlt" rel="nofollow" title="FirstLast (this topic does not yet exist; you can create it)">?</a></span> name here: <ul>
<li> Local OWNER = <span class="twikiNewLink">MarcoMambelli<a href="/bin/edit/Documentation/Release3/MarcoMambelli?topicparent=Documentation/Release3.InstallVomsAlt" rel="nofollow" title="MarcoMambelli (this topic does not yet exist; you can create it)">?</a></span>
</li></ul> 
<p />
 Please define the document area, choose one of the defined areas from the next line
 DOC_AREA = (<span class="twikiNewLink">ComputeElement<a href="/bin/edit/Documentation/Release3/ComputeElement?topicparent=Documentation/Release3.InstallVomsAlt" rel="nofollow" title="ComputeElement (this topic does not yet exist; you can create it)">?</a></span>|Storage|VO|Security|User|Monitoring|General|Trash/Trash/Integration|Operations|Tier3) <ul>
<li> Local DOC_AREA       = VO
</li></ul> 
<p />
 define the primary role the document serves, choose one of the defined roles from the next line
 DOC_ROLE = (<span class="twikiNewLink">EndUser<a href="/bin/edit/Documentation/Release3/EndUser?topicparent=Documentation/Release3.InstallVomsAlt" rel="nofollow" title="EndUser (this topic does not yet exist; you can create it)">?</a></span>|Student|Developer|SysAdmin|VOManager) <ul>
<li> Local DOC_ROLE       = <span class="twikiNewLink">SysAdmin<a href="/bin/edit/Documentation/Release3/SysAdmin?topicparent=Documentation/Release3.InstallVomsAlt" rel="nofollow" title="SysAdmin (this topic does not yet exist; you can create it)">?</a></span>
</li></ul> 
<p />
 Please define the document type, choose one of the defined types from the next line
 DOC_TYPE = (Troubleshooting|Training|Installation|HowTo|Planning|Navigation|Knowledge) <ul>
<li> Local DOC_TYPE       = Installation  Please define if this document in general needs to be reviewed before release ( 1 | 0 )
</li> <li> Local INCLUDE_REVIEW = 1
</li></ul> 
<p />
 Please define if this document in general needs to be tested before release ( 1 | 0 ) <ul>
<li> Local INCLUDE_TEST   = 1
</li></ul> 
<p />
 change to 1 once the document is ready to be reviewed and back to 0 if that is not the case <ul>
<li> Local REVIEW_READY   = 1
</li></ul> 
<p />
 change to 1 once the document is ready to be reviewed and back to 0 if that is not the case <ul>
<li> Local TEST_READY   = 1
</li></ul> 
<p />
 change to 1 only if the document has passed the review and the test (if applicable) and is ready for release <ul>
<li> Local RELEASE_READY  = 1
</li></ul> 
<p />
<p />
 DEAR DOCUMENT REVIEWER
 <code><b>==================</b></code>
<p />
 Thank for reviewing this document! Please fill in your <span class="twikiNewLink">FirstLast<a href="/bin/edit/Documentation/Release3/FirstLast?topicparent=Documentation/Release3.InstallVomsAlt" rel="nofollow" title="FirstLast (this topic does not yet exist; you can create it)">?</a></span> name here: <ul>
<li> Local REVIEWER       = <span class="twikiNewLink">StevenTimm<a href="/bin/edit/Documentation/Release3/StevenTimm?topicparent=Documentation/Release3.InstallVomsAlt" rel="nofollow" title="StevenTimm (this topic does not yet exist; you can create it)">?</a></span> Please define the review status for this document to be in progress ( 2 ), failed ( 0 ) or passed ( 1 )
</li> <li> Local REVIEW_PASSED  = 1
</li></ul> 
<p />
<p />
DEAR DOCUMENT TESTER
 <code><b>================</b></code>
<p />
 Thank for testing this document! Please fill in your <span class="twikiNewLink">FirstLast<a href="/bin/edit/Documentation/Release3/FirstLast?topicparent=Documentation/Release3.InstallVomsAlt" rel="nofollow" title="FirstLast (this topic does not yet exist; you can create it)">?</a></span> name here: <ul>
<li> Local TESTER         = <span class="twikiNewLink">StevenTimm<a href="/bin/edit/Documentation/Release3/StevenTimm?topicparent=Documentation/Release3.InstallVomsAlt" rel="nofollow" title="StevenTimm (this topic does not yet exist; you can create it)">?</a></span> Please define the test status for this document to be in progress ( 2 ), failed ( 0 ) or passed ( 1 )
</li> <li> Local TEST_PASSED    = 1
</li></ul> 
<p />
############################################################################################################
--></div><!-- /patternTopic-->
<p />
<p />
<div class="twikinetRounded twikinetRoundedAttachments"><div class="rCRounded"><div class="rCTR"><div class="rCTL"></div><!--/rCTL--><div class="twikiAttachments">
<div class="twistyPlugin twikiMakeVisibleInline">  <span id="topicattachmentslistshow" class="twistyRememberSetting twistyTrigger twikiUnvisited twistyHidden twistyInited"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleopen.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Attachments</span></a> </span> <span id="topicattachmentslisthide" class="twistyRememberSetting twistyTrigger twikiUnvisited twistyHidden twistyInited"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleclose.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Attachments</span></a> </span>  </div><!--/twistyPlugin twikiMakeVisibleInline--> <div class="twistyPlugin"><div id="topicattachmentslisttoggle" class="twistyRememberSetting twistyContent twikiMakeHidden twistyInited">
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table summary="Topic attachments" cellspacing="0" id="twikiAttachmentsTable" cellpadding="0" class="twikiTable" rules="rows" border="1"><caption>Topic attachments</caption>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=0;table=8;up=0#sorted_table" title="Sort by this column"><font color="#252b37">I</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol1"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=1;table=8;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Attachment</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol2"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=2;table=8;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Action</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol3"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=3;table=8;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Size</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol4"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=4;table=8;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Date</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol5"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=5;table=8;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Who</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol6 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallVomsAlt?cover=print;sortcol=6;table=8;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Comment</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" align="center" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> <img width="16" alt="else" align="top" src="/twiki/pub/TWiki/TWikiDocGraphics/else.gif" height="16" border="0" /><span class="twikiHidden">EXT</span> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol1 twikiLast"> <a href="/twiki/pub/Documentation/Release3/InstallVomsAlt/voms-admin-configure-zero">voms-admin-configure-zero</a> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol2 twikiLast"> <a href="/bin/attach/Documentation/Release3/InstallVomsAlt?filename=voms-admin-configure-zero;revInfo=1" title="change, update, previous revisions, move, delete..." rel="nofollow">manage</a> </td>
			<td bgcolor="#ffffff" align="right" valign="top" class="twikiTableCol3 twikiLast"> 2.2&nbsp;K </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol4 twikiLast"> <span class="twikiNoBreak">05 Jan 2012 - 02:08</span> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol5 twikiLast"> <a href="/bin/view/Main/MarcoMambelli" class="twikiLink">MarcoMambelli</a> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol6 twikiLastCol twikiLast"> &nbsp; </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
</div></div> <!--/twistyPlugin--></div><!--//twikiAttachments--></div><!--/rCTR--><div class="rCBR"><div class="rCBL"></div><!--/rCBL--></div><!--/rCBR--></div><!--/rCRounded--></div><!--/twikinetRounded--></div><!-- /patternContent-->
<hr />
This topic: Documentation/Release3<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>InstallVomsAlt</span> <br />    
Topic revision: r14 - 07 Feb 2017 - 19:34:17 - <a href="/bin/view/Main/BrianBockelman" class="twikiLink">BrianBockelman</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />