<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> UpdateOasis &lt; Documentation/Release3 &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Documentation/Release3/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Documentation/Release3/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Documentation/Release3/UpdateOasis?_T=16 Feb 2017" type="application/x-wiki" title="edit UpdateOasis" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Documentation/Release3/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Documentation/Release3/UpdateOasis"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#FFFFFF;
	}
	.patternBookView {
		border-color:#FFFFFF;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> 
<p />
<h1><a name="Updating_Software_on_OASIS"></a>  Updating Software on OASIS </h1>
<p />
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#About_OASIS"> About OASIS</a>
</li> <li> <a href="?cover=print#About_this_Document"> About this Document</a>
</li> <li> <a href="?cover=print#Requirements"> Requirements</a>
</li> <li> <a href="?cover=print#How_to_use_OASIS"> How to use OASIS</a> <ul>
<li> <a href="?cover=print#Enable_OASIS"> Enable OASIS</a>
</li> <li> <a href="?cover=print#Log_in_with_GSISSH"> Log in with GSISSH</a>
</li> <li> <a href="?cover=print#Install_and_update_software"> Install and update software</a>
</li> <li> <a href="?cover=print#Limitations_on_repository_conten"> Limitations on repository content</a>
</li> <li> <a href="?cover=print#Testing"> Testing</a>
</li></ul> 
</li> <li> <a href="?cover=print#References"> References</a>
</li> <li> <a href="?cover=print#Comments"> Comments</a>
</li></ul> 
</div>
<p />
<p />
The applicable software versions for this document are 
<font color="#ff0000">
<strong>osg-version 3.1.13</strong> 
</font>
(or higher)
<p />
<h1><a name="About_OASIS"></a> About OASIS </h1>
OASIS is the OSG Application Software Installation Service.  It is the recommended method to install software on the Open Science Grid.  It is implemented using CernVM FileSystem (CVMFS) technology.
<p />
<h1><a name="About_this_Document"></a> About this Document </h1>
This document is a step by step explanation of how a Virtual Organization (VO) Software Adminstrator can enable the OASIS service and use it to publish and update software on OSG Worker Nodes under /cvmfs/oasis.opensciencegrid.org.  For information on how to configure a client for OASIS see the <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallCvmfs" target="_top">OSG CVMFS Installation documentation</a>.  For information on hosting your own opensciencegrid.org repository see <a href="/bin/view/Documentation/Release3/OasisExternalRepositories" class="twikiLink">OasisExternalRepositories</a>.
<p />
<h1><a name="Requirements"></a> Requirements </h1>
To begin the process to distribute software on OASIS using the service hosted at the OSG GOC, you must: <ul>
<li> have a personal grid certificate. The process for getting one is detailed <a href="https://www.opensciencegrid.org/bin/view/Documentation/Release3/CertificateUserGet" target="_top">here</a>.
</li> <li> register that certificate in <a href="http://oim.grid.iu.edu/oim/home" target="_top">OIM</a>.  In order to register, the certificate has to be <a href="https://twiki.opensciencegrid.org/bin/view/Documentation/CertificateGetWeb#Installing_into_a_Web_Browser" target="_top">installed in your browser</a>.  If you are then not registered, clicking "Login" on the page will prompt you to register.
</li> <li> be associated with a VO that is registered in OIM. The list of registered VOs appears <a href="http://oim.grid.iu.edu/oim/vo" target="_top">here</a>.
</li> <li> register your certificate in the <a href="/bin/view/Documentation/GlossaryV#DefsVoms" class="twikiAnchorLink">VOMS</a>      for your <a href="/bin/view/Documentation/GlossaryV#DefsVirtualOrganization" class="twikiAnchorLink">Virtual Organization</a>.  Click on the VO name that you're associated with in the above list and in the VO page click on the <em>"Membership Services URL"</em> to register with that VO VOMS.
</li></ul> 
<p />
<h1><a name="How_to_use_OASIS"></a> How to use OASIS </h1>
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Enable_OASIS"></a> Enable OASIS </span></h2>
When you are ready to distribute your software with OASIS, submit a <a href="https://ticket.grid.iu.edu/goc/submit" target="_top">GOC ticket</a> with a request to enable OASIS for your VO. In your request, please specify your VO and provide a list of people who will install and administer the VO software in OASIS. 
<p />
The GOC will enable OASIS for your VO in <a href="https://oim.grid.iu.edu/oim/home" target="_top">OIM</a> and add your list of administrators to the "!OASIS Managers" list (which is near the bottom of the page of information about each VO in OIM).  oasis-login will then grant access to the people who are listed as OASIS managers.  Any time the list is to be modified, submit another GOC ticket.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Log_in_with_GSISSH"></a> Log in with GSISSH </span></h2>
The next step is to generate a proxy and log into <code>oasis-login.opensciencegrid.org</code> with <code>gsissh</code>.  These commands should be run on a computer that has the <a href="/bin/view/Documentation/Release3/InstallOSGClient" class="twikiLink">OSG client</a> software.  First make sure that your grid certificate is installed in <code>~/.globus/usercred.p12</code> on that computer and that it is mode 600, then run these commands:
<pre class="screen">
[user@client ~]$ voms-proxy-init -voms <font color="#ff0000">VO</font>
[user@client ~]$ gsissh -o GSSAPIDelegateCredentials=yes oasis-login.opensciencegrid.org
</pre>
<p />
In case the user can be mapped to more than one account, specify it explicitly in a command like this
<pre class="screen">
[user@client ~]$ gsissh -o GSSAPIDelegateCredentials=yes ouser.<font color="#ff0000">VO</font>@oasis-login.opensciencegrid.org
</pre>
<p />
<p />
Instead of putting <pre>-o GSSAPIDelegateCredentials&#61;yes</pre> on the command line, you can put it in your <code>~/.ssh/config</code> like this:
<pre class="screen">
Host oasis-login.opensciencegrid.org
    GSSAPIDelegateCredentials yes
</pre>
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Install_and_update_software"></a> Install and update software </span></h2>
Once you log in, you can add/modify/remove content on a staging area at <code>/stage/oasis/$VO</code> where $VO is the name of the VO represented by the manager.
<p />
Files here are visible to both <code>oasis-login</code> and the Stratum 0 server (oasis.opensciencegrid.org)
<p />
NOTE that <code>/stage/oasis/$VO</code> is not your home directory, which you can use for staging purposes but is not visible in OASIS.
<p />
As OASIS manager for the VO requests an oasis update with: 
<pre class="screen">
[user@client ~]$ osg-oasis-update
</pre>
This command queues a process to sync the content of OASIS with the content of <code>/stage/oasis/$VO</code>
<p />
<code>osg-oasis-update</code> returns immediately, but only one update can run at a time (across all VOs); your request may be queued behind a different VO.  If you encounter severe delays before the update is finished being published (more than 4 hours), please file a GOC ticket.
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Limitations_on_repository_conten"></a> Limitations on repository content </span></h2>
<p />
Although CVMFS provides a POSIX filesystem, it does not work well with all types of content.   Content in OASIS is expected to adhere to the <a href="http://cernvm.cern.ch/portal/filesystem/repository-limits" target="_top">CVMFS repository content limitations</a> so please review those guidelines carefully.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Testing"></a> Testing </span></h2>
<p />
After <code>osg-oasis-update</code> completes and the changes have been propagated to the CVMFS stratum 1 servers (typically between 0 and 60 minutes, but possibly longer if the servers are busy with updates of other repositories) then the changes can be visible under <code>/cvmfs/oasis.opensciencegrid.org</code> on a computer that has the <a href="/bin/view/Documentation/Release3/InstallCvmfs" class="twikiLink">CVMFS client installed</a>.  A client normally only checks for updates if at least an hour has passed since it last checked, but people who have superuser access on the client machine can force it to check again with 
<pre class="screen">
[root@client ~]$ cvmfs_talk -i oasis.opensciencegrid.org remount
</pre>
This can be done while the filesystem is mounted (despite what the name sounds like it does not do umount/mount).  If the filesystem is not mounted, it will automatically check for new updates the next time it is mounted.
<p />
In order to find out if an update has reached the CVMFS stratum 1 server, you can find out the latest <code>osg-oasis-update</code> time seen by the stratum 1 most favored by your CVMFS client with the following long command on your client machine:
<p />
<pre class="screen">
[user@client ~]$ date -d "1970-1-1 GMT + $(wget -qO- $(attr -qg host /cvmfs/oasis.opensciencegrid.org)/.cvmfspublished | \
                                                            cat -v|sed -n '/^T/{s/^T//p;q;}') sec"
</pre>
<p />
<h1><a name="References"></a> References </h1>
<a href="https://twiki.cern.ch/twiki/bin/view/CvmFS" target="_top">CERN CVMFS home page</a>
<h1><a name="Comments"></a> <strong>Comments</strong> </h1>
<form method="post" action="https://twiki.opensciencegrid.org/bin/save/Documentation/Release3/UpdateOasis" enctype="multipart/form-data" name="tableappend0" id="tableappend0">
<p />
<div class="commentPlugin commentPluginPromptBox">
<table><tr valign="middle"><td><textarea  rows="3" cols="70" name="comment" wrap="soft" onfocus="if(this.value=='')this.value=''" onblur="if(this.value=='')this.value=''"></textarea></td><td><input  type="submit" value="Add comment" /></td></tr></table>
</div><!--/commentPlugin-->
<p />
<input type="hidden" name="comment_action" value="save"  />
<input type="hidden" name="comment_type" value="tableappend"  />
<input type="hidden" name="comment_index" value="0"  /></form>
<p />
<p />
<!-- CONTENT MANAGEMENT PROJECT
############################################################################################################
 DEAR DOCUMENT OWNER
 <code><b>===============</b></code>
<p />
 Thank you for claiming ownership for this document! Please fill in your <span class="twikiNewLink">FirstLast<a href="/bin/edit/Documentation/Release3/FirstLast?topicparent=Documentation/Release3.UpdateOasis" rel="nofollow" title="FirstLast (this topic does not yet exist; you can create it)">?</a></span> name here: <ul>
<li> Local OWNER = <span class="twikiNewLink">ScottTeige<a href="/bin/edit/Documentation/Release3/ScottTeige?topicparent=Documentation/Release3.UpdateOasis" rel="nofollow" title="ScottTeige (this topic does not yet exist; you can create it)">?</a></span>
</li></ul> 
<p />
 Please define the document area, choose one of the defined areas from the next line
 DOC_AREA = (<span class="twikiNewLink">ComputeElement<a href="/bin/edit/Documentation/Release3/ComputeElement?topicparent=Documentation/Release3.UpdateOasis" rel="nofollow" title="ComputeElement (this topic does not yet exist; you can create it)">?</a></span>|Storage|VO|Security|User|Monitoring|General|Trash/Trash/Integration|Operations|Tier3) <ul>
<li> Local DOC_AREA       = General
</li></ul> 
<p />
 define the primary role the document serves, choose one of the defined roles from the next line
 DOC_ROLE = (<span class="twikiNewLink">EndUser<a href="/bin/edit/Documentation/Release3/EndUser?topicparent=Documentation/Release3.UpdateOasis" rel="nofollow" title="EndUser (this topic does not yet exist; you can create it)">?</a></span>|Student|Developer|SysAdmin|VOManager) <ul>
<li> Local DOC_ROLE       = <span class="twikiNewLink">SysAdmin<a href="/bin/edit/Documentation/Release3/SysAdmin?topicparent=Documentation/Release3.UpdateOasis" rel="nofollow" title="SysAdmin (this topic does not yet exist; you can create it)">?</a></span>
</li></ul> 
<p />
 Please define the document type, choose one of the defined types from the next line
 DOC_TYPE = (Troubleshooting|Training|Installation|HowTo|Planning|Navigation|Knowledge) <ul>
<li> Local DOC_TYPE       = <span class="twikiNewLink">HowTo<a href="/bin/edit/Documentation/Release3/HowTo?topicparent=Documentation/Release3.UpdateOasis" rel="nofollow" title="HowTo (this topic does not yet exist; you can create it)">?</a></span>
</li></ul> 
<p />
  Please define if this document in general needs to be reviewed before release ( 1 | 0 ) <ul>
<li> Local INCLUDE_REVIEW = 1
</li></ul> 
<p />
 Please define if this document in general needs to be tested before release ( 1 | 0 ) <ul>
<li> Local INCLUDE_TEST   = 1
</li></ul> 
<p />
 change to 1 once the document is ready to be reviewed and back to 0 if that is not the case <ul>
<li> Local REVIEW_READY   = 1
</li></ul> 
<p />
 change to 1 once the document is ready to be tested and back to 0 if that is not the case <ul>
<li> Local TEST_READY     = 1
</li></ul> 
<p />
 change to 1 only if the document has passed the review and the test (if applicable) and is ready for release <ul>
<li> Local RELEASE_READY  = 1
</li></ul> 
<p />
<p />
 DEAR DOCUMENT REVIEWER
 <code><b>==================</b></code>
<p />
 Thank for reviewing this document! Please fill in your <span class="twikiNewLink">FirstLast<a href="/bin/edit/Documentation/Release3/FirstLast?topicparent=Documentation/Release3.UpdateOasis" rel="nofollow" title="FirstLast (this topic does not yet exist; you can create it)">?</a></span> name here: <ul>
<li> Local REVIEWER       = <span class="twikiNewLink">MarcoMambelli<a href="/bin/edit/Documentation/Release3/MarcoMambelli?topicparent=Documentation/Release3.UpdateOasis" rel="nofollow" title="MarcoMambelli (this topic does not yet exist; you can create it)">?</a></span>
</li></ul> 
<p />
 Please define the review status for this document to be in progress ( 2 ), failed ( 0 ) or passed ( 1 ) <ul>
<li> Local REVIEW_PASSED  = 1
</li></ul> 
<p />
<p />
 DEAR DOCUMENT TESTER
 <code><b>================</b></code>
<p />
 Thank for testing this document! Please fill in your <span class="twikiNewLink">FirstLast<a href="/bin/edit/Documentation/Release3/FirstLast?topicparent=Documentation/Release3.UpdateOasis" rel="nofollow" title="FirstLast (this topic does not yet exist; you can create it)">?</a></span> name here: <ul>
<li> Local TESTER         = <span class="twikiNewLink">DaveDykstra<a href="/bin/edit/Documentation/Release3/DaveDykstra?topicparent=Documentation/Release3.UpdateOasis" rel="nofollow" title="DaveDykstra (this topic does not yet exist; you can create it)">?</a></span>
</li></ul> 
<p />
 Please define the test status for this document to be in progress ( 2 ), failed ( 0 ) or passed ( 1 ) <ul>
<li> Local TEST_PASSED    = 1
</li></ul> 
############################################################################################################
--></div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Documentation/Release3<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>UpdateOasis</span> <br />    
Topic revision: r18 - 06 Dec 2016 - 18:12:45 - <a href="/bin/view/Main/KyleGross" class="twikiLink">KyleGross</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />