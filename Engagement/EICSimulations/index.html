<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> EICSimulations &lt; Engagement &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Engagement/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Engagement/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Engagement/EICSimulations?_T=16 Feb 2017" type="application/x-wiki" title="edit EICSimulations" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Engagement/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Engagement/EICSimulations"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#D0D0D0;
	}
	.patternBookView {
		border-color:#D0D0D0;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <div class="twikiToc"> <ul>
<li> <a href="?cover=print#Introduction"> Introduction.</a>
</li> <li> <a href="?cover=print#Requirements"> Requirements</a> <ul>
<li> <a href="?cover=print#Production_requirements"> Production requirements</a> <ul>
<li> <a href="?cover=print#Handling_the_Density_Profile_Tab"> Handling the Density Profile Table</a>
</li> <li> <a href="?cover=print#Producing_the_Amplitude_Table"> Producing the Amplitude Table</a>
</li></ul> 
</li> <li> <a href="?cover=print#Platform_requirements"> Platform requirements</a>
</li> <li> <a href="?cover=print#I_O_Data_requirements"> I/O Data requirements</a>
</li></ul> 
</li> <li> <a href="?cover=print#Current_Solution_and_Program_of"> Current Solution and Program of Work</a>
</li> <li> <a href="?cover=print#Status"> Status</a>
</li></ul> 
</div>
<p />
<h1><a name="Electron_Ion_Collider_EIC_Simula"></a>  Electron Ion Collider (EIC) Simulations on OSG (Proof-of-principle Phase) </h1>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Introduction"></a> Introduction. </span></h2>
The OSG User Support group is working with Thomas Ullrich and Tobias Toll from BNL on porting event simulations for the Electron Ion Collider (EIC) project to OSG. The project attracts collaborators from the Nuclear Physics community and is currently preparing the physics case for the collider for 2012/2013.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Requirements"></a> Requirements </span></h2>
<p />
<h3><a name="Production_requirements"></a> Production requirements </h3>
<p />
The application is one of the first implementations of an event generator for Electron / Ion collisions. There are three parts: (1) produce  a table containing the density profiles of the nucleon configurations, (2) calculate tables of moment amplitudes with the help of the density profiles, and (3) use the amplitude tables to actually simulate the event.
<p />
We plan to be doing primarily Part (2) on OSG. Parts (1) and (3) are fairly quick, and don't require grid computing.
<p />
<h4><a name="Handling_the_Density_Profile_Tab"></a> Handling the Density Profile Table </h4>
<p />
The table of density profiles is produced before starting to generate the amplitude table.
<p />
This table can be <ol>
<li type="A"> computed completely by every job, or
</li> <li type="A"> partially computed by each job, if each job could examine just a single configuration, or
</li> <li type="A"> pre-computed completely and shipped with every job, or
</li> <li type="A"> pre-computed completely and pre-staged at all sites.
</li></ol> 
<p />
 (A) is inefficient as it duplicates the same computation at all worker nodes for every job, (B) requires too many code modifications, (C) requires to move ~1 GB per job, (D) is considered the least expensive: data will be deployed using the OSG Match Maker.
<p />
<h4><a name="Producing_the_Amplitude_Table"></a> Producing the Amplitude Table </h4>
<p />
The goal is to calculate the values of four variables over a three dimensional phase space. The phase space is divided into bins, and
each bin requires a quantum mechanical average over about 400 different nucleon configurations.
<p />
To parallelize the application, we plan to partition the set of bins into small subsets.
Then each worker node will run a single-threaded job that will calculate the variables for the bins in a single subset.
<p />
The original simulation application runs about 100 event generator threads concurrently, but running a single-threaded application on 100 nodes is a more appropriate fit to the DHTC model of OSG.
<p />
Generating one amplitude table for 1 nucleus requires about 50 CPU yrs -&gt; ~45 days on ~400 CPUs. This is the target computation for the proof-of-principle phase.
<p />
It is possible to partition the set of bins in any way, and the complete amplitude calculation for a bin takes
about a half hour, so we can get individual jobs that are any multiple of a half hour. We plan to
divide up the phase space so that the total job time is not too long.
<p />
<h3><a name="Platform_requirements"></a> Platform requirements </h3>
<p /> <ul>
<li> Job duration on common OSG platforms = 6-12 hours / job (easily tuned)
</li> <li> Job application = SL5 64bits binaries
</li> <li> Job Memory requirement = 1 GB (??)
</li> <li> Local WN disk requirements = 1 GB (??)
</li></ul> 
<p />
<h3><a name="I_O_Data_requirements"></a> I/O Data requirements </h3>
<p /> <ul>
<li> Input to the simulation job: <ul>
<li> Common data: a table of the density profiles <ul>
<li> Data are fairly static
</li> <li> 2 GB uncompressed; ~1GB compressed  -- the compression happens automatically by the application
</li> <li> Each job needs access to the table file
</li> <li> These are pre-installed in $OSG_DATA/engage/EIC 
</li></ul> 
</li> <li> A small parameter file ~1KB large.
</li></ul> 
</li></ul> 
<p /> <ul>
<li> Output of the simulation job:       * A few MB per job       * Output data from all jobs will be aggregated offline
</li></ul> 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Current_Solution_and_Program_of"></a> Current Solution and Program of Work </span></h2>
<p />
At a high level, the current setup has the following
parts:
<p /> <ol>
<li> The Engage OSGMM server tries to move the common   data to the shared file systems at many different   sites.
</li> <li> The Engage pilot jobs run a script that    sets a machine classad attribute if the data file is    at the site.
</li> <li> We have another script that creates a DAG input file   that will run the submit file from Step 3 as many   times as requested. We use DAGs solely for their   ability to automatically resubmit failed jobs.
</li> <li> The user then runs condor_submit_dag to start the   jobs going. They will only go to sites that have the required data,   as indicated by the attribute set in Step 2.
</li></ol> 
<p />
We did some initial exploratory runs, and are now working through 24 groups
of 3,300 runs to get the real table data. This includes six groups for
each of four different nuclei.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Status"></a> Status </span></h2>
<p />
9/9/11: The common data has been staged to many sites, though some have errors.
We have run small test jobs using this data. The main program, called  tableGeneratorMain,
now runs single-threaded. It also gets the range of bins to process from the command line,
which makes it easier to set up the jobs.<br />    
9/28/11: The user has run for about 8500 hours as of today.<br />    
11/16/11: Have done about 85,000 hours of runs to date in debugging and exploratory analysis.<br />    
11/21/11: The first group of 3,300 jobs, out of the 24 planned ones, just ran. It needed about 35,000 hours.<br />    
12/21/11: Sent configuration data for proton to sites. Have used an additional 124,700 hours of time in three batches.<br />    
1/17/12: Sent data for calcium to sites. Have run for about 270k more hours. To date, have finished 8 sets of 3344 jobs for gold.<br />    
&nbsp;&nbsp;&nbsp;&nbsp;Still expect to <ul>
<li> finish 4 similar sets for calcium, which are about halfway done,
</li> <li> to do the simulation for protons, although that should be much easier,
</li> <li> and to continue checking that the results are alright.
</li></ul> 
4/13/12: Have been redoing some regions of the phase space for gold with a new
   lookup table. This new batch of runs started 4/2 and has gone for 58,000 hours
   so far.
<p />
<img alt="EIC_runs_to_4_13.png" src="https://twiki.opensciencegrid.org/twiki/pub/Engagement/EICSimulations/EIC_runs_to_4_13.png" />
<p />
<p />
<p />
-- OSG User Support</div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Engagement<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Engagement/WebHome" class="twikiCurrentWebHomeLink twikiLink">WebHome</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>EICSimulations</span> <br />    
Topic revision: r13 - 13 Apr 2012 - 16:54:35 - <span class="twikiNewLink">MarkoSlyz<a href="/bin/edit/Engagement/MarkoSlyz?topicparent=Engagement.EICSimulations" rel="nofollow" title="MarkoSlyz (this topic does not yet exist; you can create it)">?</a></span>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />