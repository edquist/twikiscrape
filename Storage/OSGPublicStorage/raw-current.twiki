---+!! *OSG Public Storage*
%TOC%

---+ Introduction

These pages describe use of OSG Public Storage. The software upon which OSG Public Storage is based is the Federated Storage Service . 

To read about OSG Public Storage functions, please see

   * *[[FSSStorageManagement][Federated Storage Service Storage Management]]*: Making and cleaning up allocations.

   * *[[FSSTransferManagement][Federated Storage Service Transfer Management]]*: Accessing OSG Public Storage as a user.

   * *[[FSSDatasetOperations][Federated Storage Service Dataset Operations]]*: Defining datasets and performing dataset operations.

   * *[[FSSUserAdministration][Federated Storage Service User Administration]]*: For VO Administrators, setting up users and making suballocations.

For detailed documentation of all the OSG Public Storage commands, please see the [[FSSCommandReference][Federated Storage Service Command Reference]].


---+ The service components

The Federated Storage Service software is divided into these services and their corresponding tools or utilities. The words “tool” and “utility” are somewhat interchangeable, though in general a tool supports more complex operations and may invoke utilities.
It should be noted that this document describes a high-level design, not implementation. Therefore the following should not necessarily be interpreted as representing new software. Issues of adaptation of currently available services, code reuse, and new development have informed the design and will be finalized as a further step in the development process.

---+++ Allocation Accounting Service

An allocation is an amount of space usable by a VO (and no other) on a specific storage resource for a specific period on time. Site’s public storage areas are registered in the AAS Storage Area Registry, and allocations are made and tracked using the service’s Allocation Database. 

---+++ Site Monitoring Service

Information on the accessibility of a storage resource by a Virtual Organization is maintained in the Access Record Repository by this service. This information is used by the OSG Production coordinator to make allocation decisions and to work with sites on providing public storage.

---+++ Public Storage Catalog

The public storage catalog consists of three parts. The Namespace Service stores metadata, such as ownership and the logical directory structure, of all the VO’s files. The Replica Catalog is used to track the locations of files based on their logical names. This allows flexibility in the storage management and data transfer operations. The Dataset Catalog is used to define sets of files, as a convenient unit of data placement and manipulation.

---+++ Transfer Coordination Service

The Transfer Coordination Service is used in conjunction with the Public Storage Catalog to direct file operations to the appropriate storage resource, to register new files in the PSC, and to provide for storage operations on datasets. The TCS contains the User Registry, which contains the authorization info for users and groups.
Clients for the above services are bundled into packages according to role: PC Utilities, VOA Utilities, and User Utilities. Public Storage tools for site administrators will be made part of the existing OSG Storage Operations Toolkit.


---++ End-to-End Example


   1. A site administrator (SA) installs a Storage Element and configures a public storage area .
   1. A Virtual Organization production Administrator (VOA) installs the Federated Storage Service software, which consists of the Allocation Accounting Service, the Public Storage Catalog, the Site Monitoring Service, and the Transfer Coordination Service.
   1. The VOA uses VOA Utilities to discover and verify public storage areas on the OSG. The storage area’s discovery information is registered in the VO’s Site Monitoring Service. The storage area’s verification information is registered in the VO’s Site Monitoring Service.
   1. The VOA makes a request to the PC for an allocation.
   1. The OSG Production Coordinator (PC) uses the PC Utilities to register sites’ public storage. Each public storage area’s space information is saved in the VO’s Allocation Accounting Service.
   1. The PC makes an allocation for the VO in one of the registered storage areas. The available space in the storage area is first determined from a report of other VOs allocations.

A VO member (user) writes a file, and these steps occur 

   1. 	Sample source and destination URLs are obtained from the Public Storage Catalog.
   1. 	The sample URLs are used to compose actual source and destination URLs.
   1. 	The file is written directly from the client node to the Storage Element.
   1. 	The file is registered in Public Storage Catalog.
   1. 	The allocation’s space used is updated in the Allocation Accounting Service.
   1. A tag is optionally placed in the file’s catalog entry indicating that it is a member of a dataset.

For reads, copies, and deletes the sequence is similar, though the updates are only needed for deletes.


   1. 	A dataset is no longer needed, and the files in it are deleted by the user with one of the Client Utilities.
   1. Datasets or allocations expire, and the files in them are deleted, in order of preference. By the user (for datasets), using the User Utilities. By the VOA, using the VOA Utilities. By the SA, at the request of PC, using the OSG Storage Operations Toolkit.
   1. An allocation is no longer needed by a VO, and the VO relinquishes it using the VOA Utilities. Any remaining files in the allocation are removed. The allocation is deactivated in the Allocation Accounting Service.


   * Diagram of making and using an allocation &lt;br /&gt;
     &lt;img src=&quot;https://twiki.grid.iu.edu/twiki/pub/Storage/OSGPublicStorage/DesignE2E2.png&quot; alt=&quot;DesignE2E2.png&quot; width=&#39;800&#39; height=&#39;600&#39; /&gt; 

---++ Links

Supplemental material may be found here.

[[http://indico.fnal.gov/materialDisplay.py?contribId=14&amp;sessionId=18&amp;materialId=slides&amp;confId=3377][Presentation at OSG Storage Forum]]

[[https://osg-docdb.opensciencegrid.org:440/cgi-bin/ShowDocument?docid=978][OSG Public Storage Requirements]]

[[https://osg-docdb.opensciencegrid.org:440/cgi-bin/ShowDocument?docid=981][OSG Public Storage Design]]

[[FSSImplementationNotes][Federated Storage Service Implementation Notes]]

-- Main.TedHesselroth - 14 Sep 2010
    

