<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> GratiaReportGuide &lt; Accounting &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Accounting/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Accounting/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Accounting/GratiaReportGuide?_T=16 Feb 2017" type="application/x-wiki" title="edit GratiaReportGuide" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Accounting/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Accounting/GratiaReportGuide"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#D0D0D0;
	}
	.patternBookView {
		border-color:#D0D0D0;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Gratia_Report_Guide"></a> Gratia Report Guide </span></h2>
<p />
<TABLE BORDER=1 BGCOLOR=#ffffff CELLSPACING=0><FONT FACE="Arial" ><CAPTION><B>Report Reference</B></CAPTION>
<p />
<THEAD>
<TR>
<TH BGCOLOR=#c0c0c0 BORDERCOLOR=#000000 ><FONT style=FONT-SIZE:10pt FACE="Arial" COLOR=#000000>Report Name</TH>
<TH BGCOLOR=#c0c0c0 BORDERCOLOR=#000000 >&nbsp;</TH>
<TH BGCOLOR=#c0c0c0 BORDERCOLOR=#000000 ><FONT style=FONT-SIZE:10pt FACE="Arial" COLOR=#000000>Query Text</TH>
<TH BGCOLOR=#c0c0c0 BORDERCOLOR=#000000 ><FONT style=FONT-SIZE:10pt FACE="Arial" COLOR=#000000>Drill-Through Report(s)</TH>
<p />
</TR>
</THEAD>
<TBODY>
<TR VALIGN=TOP>
<TD> customSqlReport</TD>
<TD>&nbsp;</TD>
<TD> <BR></TD>
<TD> <BR></TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>DailyJobsByFacility</TD>
<p />
<TD>&nbsp;</TD>
<TD> call DailyJobsByFacility(?,?,?,?,?)</TD>
<TD>DailyJobsByProbe -L
  <br>DailyJobsByFacility -X</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>DailyJobsByFacilityAndDate</TD>
<TD>&nbsp;</TD>
<TD> call DailyJobsByFacilityAndDate(?,?,?)</TD>
<TD>DailyJobsByProbe -L
  <br>DailyJobsByCETable -Y-error</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>DailyJobsByProbe</TD>
<TD>&nbsp;</TD>
<TD> call DailyJobsByProbe(?,?,?,?,?)</TD>
<TD>DailyJobsByProbe -L
  <br>
 DailyJobsByProbe -Y</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>DailyJobsByProbeAndDate</TD>
<TD>&nbsp;</TD>
<TD> call DailyJobsByProbeAndDate(?,?,?)</TD>
<p />
<TD>DailyJobsByProbe -L</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>DailyJobsByVO</TD>
<TD>&nbsp;</TD>
<TD> call DailyJobsByVO(?,?,?,?,?)</TD>
<TD>DailyJobsByProbe -L
  <br>DailyJobsByVO -Y</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>DailyJobsByVOAndDate</TD>
<TD>&nbsp;</TD>
<TD> call DailyJobsByVOAndDate(?,?,?)</TD>
<TD>DailyJobsByProbe -L<br>DailyJobsByVO -X</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>DailyUsageByFacility</TD>
<TD>&nbsp;</TD>
<TD> call DailyUsageByFacility(?,?,?,?,?)</TD>
<TD>DailyJobsByProbe -L
  <br>DailyUsageByFacility -X</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>DailyUsageByFacilityAndDate</TD>
<TD>&nbsp;</TD>
<TD> call DailyUsageByFacilityAndDate(?,?,?)</TD>
<TD>DailyUsageByProbe -L<br>DailyUsageByCETable -Y-error</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD> DailyUsageByProbe</TD>
<TD>&nbsp;</TD>
<TD> call DailyUsageByProbe(?,?,?,?,?)</TD>
<TD>DailyJobsByProbe -L
  <br>DailyUsageByProbe -Y</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>DailyUsageByProbeAndDate</TD>
<TD>&nbsp;</TD>
<TD> call DailyUsageByProbeAndDate(?,?,?)</TD>
<TD>DailyUsageByProbe -Y</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>DailyUsageBySite</TD>
<p />
<TD>&nbsp;</TD>
<TD> select JobUsageRecord.SiteName,  Date( JobUsageRecord.EndTime) as EndTime, <BR>
        sum( JobUsageRecord.WallDuration), <BR>
        sum( JobUsageRecord.CpuUserDuration+ JobUsageRecord.CpuSystemDuration)<BR>
         from JobUsageRecord
where EndTime &gt;= ? and EndTime &lt;= ?<BR>
group by date_format( JobUsageRecord.EndTime,?), JobUsageRecord.SiteName <BR>
order by date_format( JobUsageRecord.EndTime,?)</TD>
<TD>DailyJobsByProbe -L
  <br>DailyUsageBySite -X</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>DailyUsageByVO</TD>
<TD>&nbsp;</TD>
<TD> select V.VOName as voname, 
       Date( V.EndTime) as EndTime, 
       sum( V.WallDuration) as WallDuration,
       sum( V.CpuUserDuration+ V.CpuSystemDuration) as systemduration
from VOProbeSummary V
where (? &lt;= V.EndTime and V.EndTime &lt;= ?)
group by date_format( V.EndTime, ?), V.VOName
order by date_format( V.EndTime, ?)</TD>
<TD>DailyJobsByProbe -L
  <br>DailyUsageByVO -X</TD>
<p />
</TR>
<p />
<TR VALIGN=TOP>
<TD>DailyUsageByVOAndDate</TD>
<TD>&nbsp;</TD>
<TD> call DailyUsageByVOAndDate(?,?,?)</TD>
<TD>DailyJobsByProbe -L
  <br>DailyUsageByVO -Y</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>DateSummary1a</TD>
<TD>&nbsp;</TD>
<TD> SELECT sum( J.CpuUserDuration+ J.CpuSystemDuration)/(3600*1000) as cpuabs,  
date_format( J.EndTime, "%Y-%m") as yearmonth, 
 J.VOName as voname,
 J.LocalUserID as locuserid,
sum( J.CpuUserDuration+ J.CpuSystemDuration) 
*C.!BenchmarkScore/(3600*1000) as cpunorm
 FROM JobUsageRecord J, CpuInfo C, CEProbes P, CETable CE
where J.HostDescription = C.NodeName
and date_format( J.EndTime, "%Y-%m") = ?
<p />
and J.ProbeName = P.ProbeName
and P.facility_id = CE.facility_id
and facility_name = ?
<p />
and J.VOName = ?
group by yearmonth, locuserid
order by yearmonth</TD>
<TD> <BR></TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>JobsByFacility</TD>
<TD>&nbsp;</TD>
<TD> call JobsByFacility(?,?,?,?)</TD>
<TD>JobsByProbe -Y</TD>
</TR>
<p />
<TR VALIGN=TOP>
<p />
<TD>JobsByProbe</TD>
<TD>&nbsp;</TD>
<TD> select CEProbes.ProbeName, sum( ProbeSummary.Njobs)
from CETable, CEProbes, ProbeSummary
where (? = 'All' or CETable.facility_name = ?)
and CEProbes.facility_id = CETable.facility_id
and ProbeSummary.!ProbeName = CEProbes.!ProbeName
and (date(?) &lt;= ProbeSummary.EndTime and ProbeSummary.!EndTime &lt;= date(?))
group by CEProbes.ProbeName
order by CEProbes.ProbeName</TD>
<TD> <BR></TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>JobsByProbeNoFacility</TD>
<TD>&nbsp;</TD>
<TD> call JobsByProbeNoFacility(?,?,?,?)</TD>
<TD>UsageReport -Y</TD>
<p />
</TR>
<p />
<TR VALIGN=TOP>
<TD>JobsBySite</TD>
<TD>&nbsp;</TD>
<TD> select JobUsageRecord.SiteName, sum( JobUsageRecord.Njobs)
from JobUsageRecord
where (? &lt;= JobUsageRecord.EndTime and JobUsageRecord.EndTime &lt;= ?)
group by JobUsageRecord.SiteName
order by JobUsageRecord.SiteName</TD>
<TD> JobsByUser -Y</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>JobsByUser</TD>
<TD>&nbsp;</TD>
<TD> select JobUsageRecord.CommonName as UserName, sum( JobUsageRecord.Njobs)
from JobUsageRecord
where (? &lt;= JobUsageRecord.EndTime and JobUsageRecord.EndTime &lt;= ?)
group by JobUsageRecord.CommonName
order by JobUsageRecord.CommonName</TD>
<TD> <BR></TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>JobsByUserforSite</TD>
<TD>&nbsp;</TD>
<TD> select JobUsageRecord.CommonName as UserName, sum( JobUsageRecord.Njobs)
from JobUsageRecord
where (? &lt;= JobUsageRecord.EndTime and JobUsageRecord.EndTime &lt;= ?)
and JobUsageRecord.SiteName = ?
group by JobUsageRecord.CommonName
order by JobUsageRecord.CommonName</TD>
<p />
<TD> <BR></TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>JobsByUserforVO</TD>
<TD>&nbsp;</TD>
<TD> select JobUsageRecord.CommonName as UserName, sum( JobUsageRecord.Njobs)
from JobUsageRecord
where (? &lt;= JobUsageRecord.EndTime and JobUsageRecord.EndTime &lt;= ?)
and JobUsageRecord.VOName = ?
group by JobUsageRecord.CommonName
order by JobUsageRecord.CommonName</TD>
<TD> <BR></TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>JobsByVO</TD>
<TD>&nbsp;</TD>
<TD> select JobUsageRecord.VOName, sum(JobUsageRecord.Njobs)
from JobUsageRecord
where (? &lt;= JobUsageRecord.!EndTime and JobUsageRecord.EndTime &lt;= ?)
group by JobUsageRecord.VOName
order by JobUsageRecord.VOName</TD>
<TD> JobsByUserforVO -Y</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>ProbeStatus</TD>
<TD>&nbsp;</TD>
<TD> call ProbeStatus(?,?,?,?,?)</TD>
<TD>ProbeStatus -L
  <br>DailyJobsByProbe -Y</TD>
</TR>
<p />
<TR VALIGN=TOP>
<p />
<TD>UsageByFacility</TD>
<TD>&nbsp;</TD>
<TD> call UsageByFacility(?,?,?,?)</TD>
<TD>UsageByProbe -Y</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD> UsageByProbe</TD>
<TD>&nbsp;</TD>
<TD> select CEProbes.ProbeName, sum( JobUsageRecord.WallDuration)
from CETable, CEProbes, JobUsageRecord
where (? = 'All' or CETable.facility_name = ?)
and CEProbes.facility_id = CETable.facility_id
and JobUsageRecord.ProbeName = CEProbes.ProbeName
and (? &lt;= JobUsageRecord.EndTime and JobUsageRecord.EndTime &lt;= ?)
group by CEProbes.ProbeName
order by CEProbes.ProbeName</TD>
<p />
<TD> <BR></TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>UsageBySite</TD>
<TD>&nbsp;</TD>
<TD> select JobUsageRecord.SiteName, 
   sum( JobUsageRecord.WallDuration),
	sum( JobUsageRecord.CpuUserDuration+ JobUsageRecord.CpuSystemDuration)
from JobUsageRecord
where (? &lt;= JobUsageRecord.EndTime and JobUsageRecord.EndTime &lt;= ?)
group by JobUsageRecord.SiteName
order by JobUsageRecord.!SiteName</TD>
<TD> UsageByUser -Y</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>UsageByUser</TD>
<TD>&nbsp;</TD>
<TD> select JobUsageRecord.!CommonName as UserName, 
   sum( JobUsageRecord.WallDuration),
	sum( JobUsageRecord.CpuUserDuration+ JobUsageRecord.CpuSystemDuration),
	JobUsageRecord.VOName as VOName,
	JobUsageRecord.SiteName as SiteName
	from JobUsageRecord
where (? &lt;= JobUsageRecord.!EndTime and JobUsageRecord.EndTime &lt;= ?)
and (VOName = ? or (? = 'NoVO' and (VOName like '%' or VOName is null)))
and (SiteName = ? or (? = 'NoSite' and (SiteName like '%' or SiteName is null)))
group by JobUsageRecord.CommonName
order by JobUsageRecord.CommonName</TD>
<TD> <BR></TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>UsageByVO</TD>
<TD>&nbsp;</TD>
<TD> select JobUsageRecord.VOName, 
   sum( JobUsageRecord.WallDuration),
	sum( JobUsageRecord.CpuUserDuration+ JobUsageRecord.CpuSystemDuration)
from JobUsageRecord
where (? &lt;= JobUsageRecord.EndTime and JobUsageRecord.EndTime &lt;= ?)
group by JobUsageRecord.VOName
order by JobUsageRecord.VOName</TD>
<p />
<TD> UsageByUser -Y</TD>
</TR>
<p />
<TR VALIGN=TOP>
<TD>UsageReport</TD>
<TD>&nbsp;</TD>
<TD> select JobUsageRecord.JobName, CETable.facility_name, CEProbes.ProbeName, 
 JobUsageRecord.StartTime, JobUsageRecord.EndTime, JobUsageRecord.JobNameDescription 
from JobUsageRecord, CETable, CEProbes
where CEProbes.facility_id = CETable.facility_id
and JobUsageRecord.ProbeName = CEProbes.ProbeName
and (? &lt;= JobUsageRecord.EndTime and JobUsageRecord.EndTime &lt;= ?)
and (? = 'All' or JobUsageRecord.!ProbeName = ?)
and (? = 'All' or CETable.facility_name = ?)</TD>
<TD> <BR></TD>
</TR>
<p />
<tr>
<TD colspan="4" bgcolor="#F4F4F4">
<p align="center"><b>Process Accounting Reports</b></TD>
</tr>
<tr>
<TD>DailyUsageByGroup-pacct</TD>
<p />
<TD>&nbsp;</TD>
<TD> select V.VOName, C.facility_name,
       Date( V.EndTime) as EndTime, 
       sum( V.CpuUserDuration+ V.CpuSystemDuration)
from VOProbeSummary V, CETable C, CEProbes P 
where V.ProbeName = P.ProbeName
and P.facility_id = C.facility_id
and C.facility_name =?
and ( EndTime &gt;= ?  and EndTime &lt;= ?)
group by date_format( V.EndTime, ?), V.VOName
order by date_format( V.EndTime, ?)</TD>
<TD>DailyUsageByGroup-pacct -Y
  <br>DailyUsageByGroup-pacct -L</TD>
</tr>
<tr>
<TD>DailyUsageByGroup1-pacct</TD>
<TD>&nbsp;</TD>
<TD> select JobUsageRecord.VOName, JobUsageRecord.ProbeName,
       Date( JobUsageRecord.EndTime) as EndTime, 
       sum( JobUsageRecord.CpuUserDuration+ JobUsageRecord.CpuSystemDuration)
from JobUsageRecord 
where (? = 'All' or JobUsageRecord.ProbeName =?)
and (? &lt;= EndTime and EndTime &lt;= ?)
group by date_format( EndTime, ?), JobUsageRecord.VOName
order by JobUsageRecord.EndTime</TD>
<p />
<TD>DailyUsageByGroup1-pacct -Y</TD>
</tr>
<tr>
<TD>DailyUsageByGroup2-pacct</TD>
<TD>&nbsp;</TD>
<TD> select J.VOName as voname,
       Date( J.EndTime) as EndTime, 
       sum( J.CpuUserDuration+ J.CpuSystemDuration)
from VOProbeSummary J, CEProbes P, CETable C 
where J.ProbeName = P.ProbeName
and P.facility_id = C.Facility_id
and C.facility_name = ?
and (? &lt;= EndTime and EndTime &lt;= ?)
group by date_format(EndTime, ?), J.VOName
order by J.EndTime</TD>
<TD> DailyUsageByGroup2a-pacct -X</TD>
</tr>
<tr>
<TD>DailyUsageByGroup2a-pacct</TD>
<TD>&nbsp;</TD>
<TD> select J.VOName as voname,
       Date( J.EndTime) as EndTime, 
       sum( J.CpuUserDuration+ J.CpuSystemDuration)
from VOProbeSummary J, CEProbes P, CETable C 
where J.ProbeName = P.ProbeName
and P.facility_id = C.Facility_id
and C.facility_name = ?
and (? &lt;= EndTime and EndTime &lt;= ?)
and J.VOName = ?
group by date_format(EndTime, ?), J.VOName
order by J.EndTime</TD>
<TD>DailyUsageByGroup-pacct -L
  <br>DailyUsageByGroup2a-pacct -X</TD>
</tr>
<tr>
<TD>DailyUsage-pacct</TD>
<p />
<TD>&nbsp;</TD>
<TD> select J.ProbeName, J.EndTime as EndTime,  
<p />
sum(( J.CpuUserDuration+ J.CpuSystemDuration)) as cputime,
sum(( J.CpuUserDuration+ J.CpuSystemDuration)* CpuInfo.BenchmarkScore/1000) as normcpu
FROM JobUsageRecord J, CpuInfo CpuInfo
where J.HostDescription= CpuInfo.NodeName 
and J.ProbeName = ?
and (? &lt;= J.EndTime and J.EndTime &lt;= ?)
group by date_format( J.EndTime, ?)
order by J.EndTime</TD>
<TD>DailyJobsByProbe -L
  <br>DailyUsage-pacct -Y1
  <br>DailyUsage-pacct -Y2</TD>
</tr>
<tr>
<TD>DailyUsage-pacct-usersys</TD>
<TD>&nbsp;</TD>
<TD> select J.ProbeName,
sum( J.CpuUserDuration) as usercpu,
sum( J.CpuSystemDuration) as syscpu, 
 J.EndTime as EndTime, 
<p />
sum(( J.CpuUserDuration+ J.CpuSystemDuration)) as cputotal,
sum(( J.CpuUserDuration+ J.CpuSystemDuration)* CpuInfo.BenchmarkScore/1000) as normcputotal
FROM JobUsageRecord J, CpuInfo CpuInfo
where J.HostDescription= CpuInfo.!NodeName 
and J.ProbeName = ?
and (? &lt;= EndTime and EndTime &lt;= ?)
group by date_format( J.EndTime, ?)
order by J.EndTime</TD>
<p />
<TD>DailyJobsByProbe -L
  <br>DailyUsage-pacct-usersys -X
  <br>DailyUsage-pacct-usersys -X</TD>
</tr>
<tr>
<TD>DailyUsage1-pacct</TD>
<TD>&nbsp;</TD>
<TD> select C.facility_name,sum( J.CpuUserDuration) as usercpu,
sum( J.CpuSystemDuration) as syscpu, J.EndTime as EndTime,sum(( J.CpuUserDuration+ J.CpuSystemDuration)) as cputotal,
sum(( J.CpuUserDuration+ J.CpuSystemDuration)*CpuInfo.BenchmarkScore/1000) as normcputotal
FROM JobUsageRecord J, CpuInfo CpuInfo, CETable C, CEProbes P
where J.HostDescription=!CpuInfo.NodeName 
and J.ProbeName = P.ProbeName
and P.facility_id = C.facility_id
and  C.facility_name = ?
and (? &lt;= EndTime and EndTime &lt;= ?)
group by date_format( J.EndTime, ?)
order by J.EndTime</TD>
<p />
<TD>DailyJobsByProbe -L
  <br>DailyUsage1-pacct -X
  <br>DailyUsage1-pacct -X</TD>
</tr>
<tr>
<p />
<TD>DateSummary1-pacct</TD>
<TD>&nbsp;</TD>
<TD> SELECT sum( J.CpuUserDuration+ J.CpuSystemDuration)/(3600*1000) as cpuabs,  
date_format( J.EndTime, "%Y-%m") as yearmonth, 
J.VOName as voname,
sum( J.CpuUserDuration+ J.CpuSystemDuration) 
*C.!BenchmarkScore/(3600*1000) as cpunorm
 FROM JobUsageRecord J, CpuInfo C, CETable CE, CEProbes P
where J.HostDescription = C.!NodeName
and J.EndTime &gt;= ?
and J.EndTime &lt; '2010-12-31'
and J.ProbeName = P.ProbeName
and P.facility_id = CE.facility_id
and facility_name = ?
group by yearmonth, voname
order by yearmonth</TD>
<TD> DateSummary1a -Y</TD>
</tr>
<tr>
<TD>DateSummary2-pacct</TD>
<TD>&nbsp;</TD>
<TD> SELECT facility_name, sum( N.CpuUserTime+ NN.CpuSystemTime)/3600*( N.BenchmarkScore/1000)
as cpunorm, 
sum( N.BenchmarkScore /1000 * N.CpuCount*24 ) as cpuavail,
date_format( N.EndTime, "%Y-%m") as monthyear,
 N.CpuCount as CpuCount,
 N.DaysInMonth as DaysInMonth,
 N.BenchmarkScore as BenchmarkScore,
N.Node as node
FROM NodeSummary N, CETable C, CEProbes P
where N.EndTime &gt;= ?
and N.EndTime &gt;= '2006-04-01'
and N.EndTime &lt; '2012-12-31'
and N.ProbeName = P.ProbeName
and P.facility_id = C.facility_id
and facility_name = ?
group by monthyear
order by monthyear</TD>
<p />
<TD> <BR></TD>
</tr>
<tr>
<TD>MonthlySummary1-pacct</TD>
<TD>&nbsp;</TD>
<TD> select distinct facility_name from CETable C, CEProbes
where C.facility_id = CEProbes.facility_id
 and CEProbes.!ProbeName like "psacct%"</TD>
<p />
<TD> <BR></TD>
</tr>
<tr>
<TD colspan="5" bgcolor="#F4F4F4">
<p align="center"><b>OSG Daily Reports</b></TD>
</tr>
<tr>
<TD>DailyUsageBySite-osgdaily</TD>
<TD>&nbsp;</TD>
<TD>select JobUsageRecord.SiteName, <BR>       Date( JobUsageRecord.EndTime) 
as endtime, <BR>        sum( JobUsageRecord.WallDuration),<BR>        sum( JobUsageRecord.CpuUserDuration+ 
JobUsageRecord.CpuSystemDuration)<BR>         from JobUsageRecord<BR>where EndTime 
&gt;= ? and EndTime &amp;lt;= ?<BR>group by date_format( JobUsageRecord.EndTime,<BR>
?), JobUsageRecord.SiteName<BR>order by date_format( JobUsageRecord.EndTime,?)</TD>
<TD>DailyJobsByProbe -L<BR>DailyUsageBySite -X</TD>
<TD><BR></TD>
</tr>
<tr>
<TD>DailyUsageByVO-daily</TD>
<TD>&nbsp;</TD>
<TD>select V.VOName as voname, <BR>       Date( V.EndTime) as endtime, <BR>       sum( V.WallDuration) as wallduration,<BR>       sum( V.CpuUserDuration+ V.CpuSystemDuration)as systemduration<BR>from VOProbeSummary V<BR>where (? &amp;lt;= V.EndTime and V.EndTime &amp;lt;= ?)<BR>group by date_format( V.EndTime, ?), V.VOName<BR>order by date_format( V.EndTime, ?)</TD>
<TD>DailyJobsByProbe -L<BR>DailyUsageByVO -X</TD>
<TD><BR></TD>
</tr>
<tr>
<TD>JobsBySite-osgdaily</TD>
<TD>&nbsp;</TD>
<TD>select JobUsageRecord.SiteName, sum( JobUsageRecord.Njobs)<BR>from JobUsageRecord<BR>where (? &amp;lt;= JobUsageRecord.EndTime and JobUsageRecord.EndTime &amp;lt;= ?)<BR>group by JobUsageRecord.SiteName<BR>order by JobUsageRecord.SiteName</TD>
<TD>JobsByUser -Y</TD>
<TD><BR></TD>
</tr>
<p />
<TR VALIGN=TOP>
<TD>JobsByVO-osgdaily</TD>
<TD>&nbsp;</TD>
<TD>select JobUsageRecord.VOName, sum( JobUsageRecord.Njobs)<BR>from JobUsageRecord<BR>where (? &amp;lt;= JobUsageRecord.EndTime and JobUsageRecord.EndTime &amp;lt;= ?)<BR>group by JobUsageRecord.VOName<BR>order by JobUsageRecord.VOName</TD>
<TD>JobsByUserforVO -Y</TD>
<TD><BR></TD>
</TR>
<tr>
<TD>UsageBySite-osgdaily</TD>
<TD>&nbsp;</TD>
<TD>select JobUsageRecord.SiteName, <BR>   sum( JobUsageRecord.WallDuration),<BR>&#09;sum( JobUsageRecord.CpuUserDuration+ JobUsageRecord.CpuSystemDuration)<BR>from JobUsageRecord<BR>where (? &amp;lt;= JobUsageRecord.EndTime and JobUsageRecord.EndTime &amp;lt;= ?)<BR>group by JobUsageRecord.SiteName<BR>order by JobUsageRecord.SiteName</TD>
<TD>UsageByUser -Y</TD>
<TD><BR></TD>
</tr>
<TR VALIGN=TOP>
<TD>UsageByVO-osgdaily</TD>
<TD>&nbsp;</TD>
<TD>select JobUsageRecord.VOName, <BR>   sum( JobUsageRecord.WallDuration),<BR>&#09;sum( JobUsageRecord.CpuUserDuration+ JobUsageRecord.CpuSystemDuration)<BR>from JobUsageRecord<BR>where (? &amp;lt;= JobUsageRecord.EndTime and JobUsageRecord.EndTime &amp;lt;= ?)<BR>group by JobUsageRecord.VOName<BR>order by JobUsageRecord.VOName</TD>
<TD>UsageByUser -Y</TD>
<TD><BR></TD>
</TR>
<p />
</TBODY>
</TABLE>
-- <span class="twikiNewLink">JeffreyMack<a href="/bin/edit/Main/JeffreyMack?topicparent=Accounting.GratiaReportGuide" rel="nofollow" title="JeffreyMack (this topic does not yet exist; you can create it)">?</a></span> - 12 April 2007</div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Accounting<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Accounting/WebHome" class="twikiCurrentWebHomeLink twikiLink">WebHome</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>GratiaReportGuide</span> <br />    
Topic revision: r7 - 11 Dec 2008 - 18:51:44 - <a href="/bin/view/Main/KyleGross" class="twikiLink">KyleGross</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />