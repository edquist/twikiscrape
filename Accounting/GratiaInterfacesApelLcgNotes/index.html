<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> GratiaInterfacesApelLcgNotes &lt; Accounting &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Accounting/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Accounting/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Accounting/GratiaInterfacesApelLcgNotes?_T=16 Feb 2017" type="application/x-wiki" title="edit GratiaInterfacesApelLcgNotes" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Accounting/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Accounting/GratiaInterfacesApelLcgNotes"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#D0D0D0;
	}
	.patternBookView {
		border-color:#D0D0D0;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--TWISTYPLUGIN_TWISTY--><style type="text/css" media="all">
@import url("https://twiki.opensciencegrid.org/twiki/pub/TWiki/TwistyContrib/twist.css");
</style>
<script type='text/javascript' src='https://twiki.opensciencegrid.org/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js'></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikiPref.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TwistyContrib/twist.compressed.js"></script>
<script type="text/javascript">
// <![CDATA[
var styleText = '<style type="text/css" media="all">.twikiMakeVisible{display:inline;}.twikiMakeVisibleInline{display:inline;}.twikiMakeVisibleBlock{display:block;}.twikiMakeHidden{display:none;}</style>';
document.write(styleText);
// ]]>
</script>

<!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

<!--TABLEPLUGIN_twikiAttachmentsTable--><style type="text/css" media="all">
.tableSortIcon img {padding-left:.3em; vertical-align:text-bottom;}
.twikiTable#twikiAttachmentsTable td {border-style:solid none;}
.twikiTable#twikiAttachmentsTable th {border-style:solid none;}
.twikiTable#twikiAttachmentsTable td {vertical-align:middle;}
.twikiTable#twikiAttachmentsTable th {vertical-align:middle;}
.twikiTable#twikiAttachmentsTable td {vertical-align:top;}
.twikiTable#twikiAttachmentsTable th {background-color:#eceef2;}
.twikiTable#twikiAttachmentsTable th.twikiSortedCol {background-color:#e0e3e9;}
.twikiTable#twikiAttachmentsTable tr.twikiTableRowdataBg0 td {background-color:#ffffff;}
.twikiTable#twikiAttachmentsTable tr.twikiTableRowdataBg0 td.twikiSortedCol {background-color:#f2f3f6;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol0 {text-align:center;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol1 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol2 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol3 {text-align:right;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol4 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol5 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol6 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol7 {text-align:center;}
</style></head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <h1><a name="Gratia_Interfaces_APEL_WLCG_Note"></a>  Gratia Interfaces - APEL/WLCG - Notes </h1>
<p />
<!-- <ul>
<li> Set VORS_SITES = <a href="http://vors.grid.iu.edu/cgi-bin/tindex.cgi?region=0&amp;VO=0&amp;res=0&amp;grid=1)" target="_top">VORS</a>
</li></ul> 
<p /> <ul>
<li> Set EGEE_PORTAL_OSG_VIEW =  EGEE Portal OSG view: <a href="http://www3.egee.cesga.es/gridsite/accounting/CESGA/osg_view.html" target="_top">http://www3.egee.cesga.es/gridsite/accounting/CESGA/osg_view.html</a>
</li> <li> Set EGEE_PORTAL_TIER1_VIEW = EGEE Portal Tier 1 view: <a href="http://www3.egee.cesga.es/gridsite/accounting/CESGA/tier1_view.html" target="_top">http://www3.egee.cesga.es/gridsite/accounting/CESGA/tier1_view.html</a>
</li> <li> Set EGEE_PORTAL_TIER2_VIEW = EGEE Portal Tier 2 view: <a href="http://www3.egee.cesga.es/gridsite/accounting/CESGA/tier2_view.html" target="_top">http://www3.egee.cesga.es/gridsite/accounting/CESGA/tier2_view.html</a>
</li></ul> 
<p /> <ul>
<li> Set EGEE_PORTAL_ACCOUNTING_ISSUES= UK Grid Operations Outstanding Accounting Issues: <a href="http://goc.grid.sinica.edu.tw/gocwiki/Outstanding_Accounting_Issues" target="_top">http://goc.grid.sinica.edu.tw/gocwiki/Outstanding_Accounting_Issues</a>
</li> <li> Set EGEE_PORTAL_VO_MAPPINGS = Accounting Portal - Treatment of VO Accounting section: <a href="http://goc.grid.sinica.edu.tw/gocwiki/Outstanding_Accounting_Issues#head-f60e4af38c1f855b02e7ad065bc0871f39f8a4f5" target="_top">http://goc.grid.sinica.edu.tw/gocwiki/Outstanding_Accounting_Issues#head-f60e4af38c1f855b02e7ad065bc0871f39f8a4f5</a> 
</li> <li> Set EGEE_PORTAL_ASSOCIATION_TABLE = Accounting Portal - Unregistered Site Association Table: <a href="http://goc.grid.sinica.edu.tw/gocwiki/Outstanding_Accounting_Issues#head-c1c04b4c3ed06c5a7dc95efe037fc55cd6085623" target="_top">http://goc.grid.sinica.edu.tw/gocwiki/Outstanding_Accounting_Issues#head-c1c04b4c3ed06c5a7dc95efe037fc55cd6085623</a> 
</li></ul> 
<p />
<p />
-->
<p />
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#Description"> Description</a>
</li> <li> <a href="?cover=print#Description_of_change_process"> Description of change process</a>
</li> <li> <a href="?cover=print#Determining_when_WLCG_data_is_fr"> Determining when WLCG data is "frozen"</a>
</li> <li> <a href="?cover=print#Providing_visibility_to_Gratia_A"> Providing visibility to Gratia-APEL interface data</a>
</li> <li> <a href="?cover=print#Visibility_Maintenance_of_Normal"> Visibility / Maintenance of Normalization factors</a>
</li> <li> <a href="?cover=print#Insuring_all_Tier_1_2_Sites_are"> Insuring all Tier 1/2 Sites are included in the interface.</a>
</li> <li> <a href="?cover=print#Tracking_actual_vs_pledged_usage"> Tracking actual vs pledged usage</a>
</li> <li> <a href="?cover=print#Contact_information_on_Tier1_2_S"> Contact information on Tier1/2 Site administrators</a>
</li> <li> <a href="?cover=print#Usage_of_non_LCG_VOs_at_Tier_1_2"> Usage of non-LCG VOs at Tier 1/2 sites</a>
</li> <li> <a href="?cover=print#Include_Tier_3_sites"> Include Tier 3 sites</a>
</li> <li> <a href="?cover=print#Other_Issues"> Other Issues</a>
</li></ul> 
</div>
<p />
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Description"></a> Description </span></h2>
This topic is a working document to keep track of notes, to-dos, et al.  There is not likely to be much organization to it.
<p />
The purpose of this little project is to tighten up the procedures for reporting CMS/ATLAS Tier 1/2 reporting to WLCG. The TOC sections address these areas.
<p />
Although, this topic mainly references Tier 2 sites, it is intended to cover Tier 1, as well.
<p />
There is a little logic (fuzzy in nature) to the font colors used: <ul>
<li> normal - is kind of a general statement of what exists today (sortof)
</li> <li> <font color="green"><b>green</b></font> - items that are already in place in some manner
</li> <li> <font color="blue"><b>blue</b></font> - to-do type items
</li> <li> <font color="red"><b>red</b></font>- areas in which I have no clue about what I am saying (although that could overlap with any other area).
</li></ul> 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Description_of_change_process"></a> Description of change process </span></h2>
The following is the text of an email from Sue Foffano of the LCG Office (<a href="mailto&#58;Lcg&#46;Office&#64;cern&#46;ch">Lcg.Office&#64;cern.ch</a>) describing the process 
changing/migrating Site reported to APEL for view at EGEE.
<pre>
The recommended route is an email to lcg.office@cern.ch with a
meaningful title e.g. Change to the USA Purdue CMS T2 Federation.

This will then trigger the change to be made and the relevant services
(APEL, GRIDVIEW) to be alerted. There is no ticketing system for this as
although changes do and will continue to occur, there are not enough to
warrant one.

The monthly accounting and availability reports which are sent from
lcg.office give people the chance to cross-check and signal any
anomalies which can either be in the data which is corrected at the
source, or the Federation/site mapping or pledge information which we
correct before the reports are published. The earlier reply from
Cristina hopefully confirms that work is on-going to correct the Purdue
sites in the portal. 
</pre>
<p />
The other groups/people involved in this at this time are: <ul>
<li> egee-admin (<a href="mailto&#58;egee&#45;admin&#64;cesga&#46;es">egee-admin&#64;cesga.es</a>)
</li> <li> sergio diaz (<a href="mailto&#58;sdiaz&#64;cesga&#46;es">sdiaz&#64;cesga.es</a>)
</li> <li> <a href="mailto&#58;APEL&#45;SUPPORT&#64;JISCMAIL&#46;AC&#46;UK">APEL-SUPPORT&#64;JISCMAIL.AC.UK</a>
</li> <li> <a href="mailto&#58;Sue&#46;Foffano&#64;cern&#46;ch">Sue.Foffano&#64;cern.ch</a>
</li></ul> 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Determining_when_WLCG_data_is_fr"></a> Determining when WLCG data is "frozen" </span></h2>
Currently, the interface is being executed and updating the APEL database for the previous month (eg. March) up through the 15th of the current month (e.g. April 15).  This was an arbitrary date in order to accommodate sites that may be down for maintenance (or some other reason) and allow them to 'catch-up' when they came back on-line.
<p />
It appears that there is a <code>cutoff</code> or <code>freeze date</code> based on the Accounting report that follows.
<p />
<strong>Tier 2 Accounting report</strong> <br />    
There is a draft report that is issued via email (<strong>????</strong> days before the final).  This was from Ruth on 4/16.  It looks like this is sent <strong>3 days prior to the cutoff</strong> .
<pre>
Subject:  	March 2008 - Tier2 Accounting Report
Date: 	Fri, 11 Apr 2008 16:20:08 +0200
From: 	Lcg Office (Lcg.Office@cern.ch)
To: 	project-wlcg-tier2 (project-wlcg-tier2@cern.ch)
CC: 	worldwide-lcg-management-board (LCG Management Board)

Dear WLCG Collaboration Board Member and associated collaborators,
Attached is the draft Tier2 Accounting report for March 2008, which will be published 
on the LCG Planning Page at the end of this week. 
Please therefore signal any anomalies that you find to LCG office (lcg.office@cern.ch), 
before Friday 14 April 2008 pm

Regards,
Fabienne Baud-Lavigne
**********************
Fabienne Baud-Lavigne
LHC Computing Grid Project
Assistant to Les Robertson
IT Department
CERN
European Organization for Nuclear Research
</pre>
<a href="https://twiki.opensciencegrid.org/twiki/pub/Accounting/GratiaInterfacesApelLcgNotes/Tier-2_Accounting_Report_March2008.pdf" target="_top">Tier-2 Accounting Report March 2008.pdf</a>
<p />
<p />
<b><font color="blue">
<u>To do:</u><br />    
Based on this, it appears that an afternoon execution of the interface cron script (lcg.sh) might be necessary. <ul>
<li> we are currently running at 01:00 daily
</li> <li> need to account for time differential between here and Cern when the email stated 4/14 pm.  So it may be a mid-afternoon run. 
</li> <li> this appears to be the date those numbers are frozen.  We should <u>NOT</u> update prior months anymore.
</li></ul> 
</font></b>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Providing_visibility_to_Gratia_A"></a> Providing visibility to Gratia-APEL interface data </span></h2>
The only visibility anyone has had to the Gratia-APEL interface data was either via: <ul>
<li> EGEE Portal OSG view: <a href="http://www3.egee.cesga.es/gridsite/accounting/CESGA/osg_view.html" target="_top">http://www3.egee.cesga.es/gridsite/accounting/CESGA/osg_view.html</a>
</li> <li> EGEE Portal Tier 1 view: <a href="http://www3.egee.cesga.es/gridsite/accounting/CESGA/tier1_view.html" target="_top">http://www3.egee.cesga.es/gridsite/accounting/CESGA/tier1_view.html</a>
</li> <li> EGEE Portal Tier 2 view: <a href="http://www3.egee.cesga.es/gridsite/accounting/CESGA/tier2_view.html" target="_top">http://www3.egee.cesga.es/gridsite/accounting/CESGA/tier2_view.html</a>
</li></ul> 
or<br />     <ul>
<li> The Monthly Accounting Report mentioned previously.
</li></ul> 
<p />
<b><font color="green">
On April 15th, changes were made to the Gratia-APEL interface (LCG.py) to generate 2 files (xml and html formats) containing the APEL database's Gratia data.  The data is extracted immediately after the daily updates are made.  This data is currently (and temporarily) viewable here on Brian Bockleman's Nebraska web site: <ul>
<li> <a href="http://t2.unl.edu/gratia/wlcg_reporting" target="_top">http://t2.unl.edu/gratia/wlcg_reporting</a>
</li></ul> 
</font></b>
<p />
<b><font color="blue">
<u>To do:</u><br />    
The following items need to be addressed to  incorporate them in Gratia or a module of Gratia: <ol>
<li> The xml file used by Brian's site is temporarily being made available on <a href="http://home.fnal.gov/~weigand/apel-wlcg/" target="_top">http://home.fnal.gov/~weigand/apel-wlcg/</a> . This was done to expedite and test the viability of the process.<br />           This could be made available on the Gratia tomcat server in a directory similar to where the static (pdf) reports are:        <a href="http://gratia.opensciencegrid.org:8880/gratia-reports/apel-wlcg" target="_top">http://gratia.opensciencegrid.org:8880/gratia-reports/apel-wlcg</a><br />           This may require the cron process for the interface be moved to the gratia09 host thus requiring a change to the authorized user in the APEL database which is currently only the gratia06 host. A very nice feature of Brian's web site is that it accesses the xml file directly at the source.  No data transfer is required. So this web could be on another machine so long as the data is available external to the host it is on.
</li> <li> Brian's code needs to be moved to the fnal cvs repository as its own module or a module of Gratia.
</li></ol> 
</font></b>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Visibility_Maintenance_of_Normal"></a> Visibility / Maintenance of Normalization factors </span></h2>
The current method of updating of Normalization factors is completely manual, time consuming and not very timely.  It is usually not until the Monthly Accounting Reports are issued that anyone realizes they are outdated and then it is a mad rush to get them updated.  Additionally, there is no visibility into them other than the documentation here: <a href="https://twiki.grid.iu.edu/twiki/bin/view/Accounting/GratiaInterfacesApelLcg#Normalization_Factor" target="_top">https://twiki.grid.iu.edu/twiki/bin/view/Accounting/GratiaInterfacesApelLcg#Normalization_Factor</a> .  The EGEE portal does not display this information even though it is included in the Gratia-APEL interface data.
<p />
<b>Note: This will not address the value/validity of using <span class="twikiNewLink">SI2K<a href="/bin/edit/Accounting/SI2K?topicparent=Accounting.GratiaInterfacesApelLcgNotes" rel="nofollow" title="SI2K (this topic does not yet exist; you can create it)">?</a></span> or any other SpecINT type number used in determining the Normalization Factor.  That is entirely outside the scope of this interface.</b>
<p />
<b><font color="green">
Since the normalization factor is a part of the Gratia-APEL interface data, it is now (as of 4/15) visible at the Nebraska site with the other metrics: <ul>
<li> <a href="http://t2.unl.edu/gratia/wlcg_reporting" target="_top">http://t2.unl.edu/gratia/wlcg_reporting</a>
</li></ul> 
<p />
Additionally, at the above url, if you scroll down the page, you will see 2 additional tables related to normalization factors: <ol>
<li> GIP Subcluster Information
</li> <li> Site Normalization Calculation Comparison
</li></ol> 
<p />
In place of the current method of updating the normalization factors, the site admins will advertise the make-up of each subcluster for the their site using the GIP.  The normalization factor for each subcluster will be displayed in the <code>GIP Subcluster Information</code> table. 
<p />
<b><font color="red">
Brian, I need you to elaborate on this part as to where the <span class="twikiNewLink">SI2K<a href="/bin/edit/Accounting/SI2K?topicparent=Accounting.GratiaInterfacesApelLcgNotes" rel="nofollow" title="SI2K (this topic does not yet exist; you can create it)">?</a></span> will come from and the use of the alter-attributes.conf file whatever it is.  The only place I find documentation on it is here (it is the 0.8.0 doc as well): <a href="https://twiki.grid.iu.edu/twiki/bin/view/Trash/Trash/Trash/Trash/Integration/ITB090/GenericInformationProviders" target="_top">https://twiki.grid.iu.edu/twiki/bin/view/Trash/Trash/Trash/Trash/Integration/ITB090/GenericInformationProviders</a>
</font></b>
<p />
The <code>Site Normalization Calculation</code> Comparison table is temporary in nature to show the differences between the manually maintained factor and the GIP calculated one.  If agreement can be obtain from all sites to use the GIP generated value, then the need for this table should go away.  
</font></b>
<p />
<b><font color="blue">
<u>To do:</u><br />     <ol>
<li> Get agreement to use the GIP generated number from all sites/VOs
</li> <li> Define the process/procedure for determining the <span class="twikiNewLink">SI2K<a href="/bin/edit/Accounting/SI2K?topicparent=Accounting.GratiaInterfacesApelLcgNotes" rel="nofollow" title="SI2K (this topic does not yet exist; you can create it)">?</a></span> number when new processors come online.
</li> <li> Develop the process to mechanically use the GIP generated number in the interface
</li> <li> Develop (in-progress already by Brian) the capability to display the details of the subcluster calculations.
</li> <li> Determine what data needs to be maintained in the Gratia database or if a separate database is required.
</li> <li> Determine if the gratia probes need to be enhanced to capture better data for recording <code>HostDescription</code> which is intended to contain information on the processor used when a job was run.  This data field  is very  incomplete in the production gratia database.
</li></ol> 
</font></b>
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Insuring_all_Tier_1_2_Sites_are"></a> Insuring all Tier 1/2 Sites are included in the interface. </span></h2>
It became apparent during the past few days (4/11 - 4/15) that the sites being selected for the Gratia-APEL interface were out-of-date.  After reviewing the EGEE Tier1 and Tier2 views manually by drilling down on each "Site", I saw the following discrepancies: <ol>
<li>  For CMS sites,  <ul>
<li> UFlorida-HPC and UFlorida-IHEPA were not being reported by the interface.
</li> <li> HEPGRID_UERJ and SPRACE are being reported, but do not appear in the Tier2 drill down and, hence, should not be reported.
</li></ul> 
</li> <li>  For ATLAS sites,  <ul>
<li> UC_Teraport and OU_OSCER_ATLAS are being reported, but do not appear in the Tier2 drill down and, hence, should not be reported.
</li></ul> 
</li></ol> 
<p />
The 2 Florida sites have been added to the interface (4/15).  
<p />
The 4 sites that we are reporting, but do not show in the EGEE view, are still in the interface.  I left them in the event my manual evaluation was in error.   <ul>
<li> The problem with leaving them is that the view of the interface data shown at <a href="http://t2.unl.edu/gratia/wlcg_reporting" target="_top">http://t2.unl.edu/gratia/wlcg_reporting</a> will be misleading.
</li> <li> Additionally, if we provide the capability of tracking actual vs pledged data (next section), it will likely be even more misleading unless we take this into account.
</li></ul> 
<p />
<b><font color="green">
There are 2 mapping tables in the APEL accounting database ( <code>goc-accounting.grid-support.ac.uk</code> ) that identify the Tier 1 and Tier 2 groups/sites: <ul>
<li> org_Tier1
</li> <li> org_Tier2
</li></ul> 
<p />
The tables are identical in the terms of columns:
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table1" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> Field </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> Description </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> Name </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> Name of the Group/Site that appears in the View on the EGEE portal </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> Path </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> Hierarchy used in displaying on the EGEE portal </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> RefID </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> In the <code>org_Tier2</code> table, indicates a site as opposed to a grouping<br />     In the <code>org_Tier1</code> table, indicates a reference id into another database tables. </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> MapID </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol twikiLast"> Not Applicable </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
The data relevant to the OSG sites for each table is:
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table2" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> org_Tier1 </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> org_Tier2 </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> select * from org_Tier1 where Path like '1.4%' or Path like '1.10%' order by Path; </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> select * from org_Tier2 where Path like '1.31%' order by Path; </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> <pre>+-------------------+--------+-------+-------+
| Name              | Path   | RefID | MapID |
+-------------------+--------+-------+-------+
| US-FNAL-CMS       | 1.10   |     0 |     0 | 
| USCMS-FNAL-WC1-CE | 1.10.1 |    16 |     0 | 
| US-T1-BNL         | 1.4    |     0 |     0 | 
| BNL               | 1.4.1  |     9 |     0 | 
| BNL_ATLAS_1       | 1.4.2  |  9998 |     0 | 
+-------------------+--------+-------+-------+
</pre> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol twikiLast"> <pre>+-----------------+-----------+-------+-------+
| Name            | Path      | RefID | MapID |
+-----------------+-----------+-------+-------+
| USA             | 1.31      |     0 |     0 | 
| US-AGLT2        | 1.31.1    |     0 |     0 | 
| AGLT2           | 1.31.1.1  |     1 |     0 | 
| T2_US_Purdue    | 1.31.10   |     0 |     0 | 
| Purdue-Lear     | 1.31.10.1 |     1 |     0 | 
| Purdue-RCAC     | 1.31.10.2 |     1 |     0 | 
| T2_US_UCSD      | 1.31.11   |     0 |     0 | 
| UCSDT2          | 1.31.11.1 |     1 |     0 | 
| T2_US_Wisconsin | 1.31.12   |     0 |     0 | 
| GLOW            | 1.31.12.1 |     1 |     0 | 
| US-NET2         | 1.31.2    |     0 |     0 | 
| BU_ATLAS_Tier2  | 1.31.2.1  |     1 |     0 | 
| US-MWT2         | 1.31.3    |     0 |     0 | 
| MWT2_UC         | 1.31.3.1  |     1 |     0 | 
| MWT2_IU         | 1.31.3.2  |     1 |     0 | 
| UC_ATLAS_MWT2   | 1.31.3.3  |     1 |     0 | 
| IU_OSG          | 1.31.3.4  |     1 |     0 | 
| US-SWT2         | 1.31.4    |     0 |     0 | 
| OU_OCHEP_SWT2   | 1.31.4.1  |     1 |     0 | 
| UTA_SWT2        | 1.31.4.2  |     1 |     0 | 
| SWT2_CPB        | 1.31.4.3  |     1 |     0 | 
| US-WT2          | 1.31.5    |     0 |     0 | 
| PROD_SLAC       | 1.31.5.1  |     1 |     0 | 
| T2_US_Caltech   | 1.31.6    |     0 |     0 | 
| CIT_CMS_T2      | 1.31.6.1  |     1 |     0 | 
| T2_US_Florida   | 1.31.7    |     0 |     0 | 
| Uflorida-PG     | 1.31.7.1  |     1 |     0 | 
| Uflorida-IHEPA  | 1.31.7.2  |     1 |     0 | 
| UFlorida-HPC    | 1.31.7.3  |     1 |     0 | 
| T2_US_MIT       | 1.31.8    |     0 |     0 | 
| MIT_CMS         | 1.31.8.1  |     1 |     0 | 
| T2_US_Nebraska  | 1.31.9    |     0 |     0 | 
| Nebraska        | 1.31.9.1  |     1 |     0 | 
+-----------------+-----------+-------+-------+</pre> </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
<p />
</font></b>
<p />
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Tracking_actual_vs_pledged_usage"></a> Tracking actual vs pledged usage </span></h2>
Currently, there is no means to track actual vs pledged usage for the current month.  I believe (but do not know for sure) that the emailed <code>Tier 2 Accounting Report</code> pdf file, mentioned in a previous section, is the 1st view of this metric.
<p />
<strong>Pledge information (From Ruth (4/16):</strong> <br />    
The location of the Tier-2 pledge information we should use is: <ul>
<li> <a href="http://lcg.web.cern.ch/LCG/MB/accounting/Tier-2/T2%20Federation%20and%20site%20names.xls" target="_top">http://lcg.web.cern.ch/LCG/MB/accounting/Tier-2/T2%20Federation%20and%20site%20names.xls</a>
</li> <li> <a href="http://lcg.web.cern.ch/LCG/MB/accounting/" target="_top">http://lcg.web.cern.ch/LCG/MB/accounting/</a> gives some documentation but no contact information.
</li></ul> 
<p />
<b><font color="blue">
To Do:<br />    
Brian is currently working on providing this capability for his web site.
</font></b>
<p />
<b><font color="red">
Brian,  can you give me some details here.
</font></b>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Contact_information_on_Tier1_2_S"></a> Contact information on Tier1/2 Site administrators </span></h2>
<b><font color="blue">
To Do:<br />    
Need some form of contact list for the Tier1/2 site administrators.
</font></b>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Usage_of_non_LCG_VOs_at_Tier_1_2"></a> Usage of non-LCG VOs at Tier 1/2 sites </span></h2>
<b><font color="red">
To Do:<br />    
Need some help here.
</font></b>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Include_Tier_3_sites"></a> Include Tier 3 sites </span></h2>
<b><font color="red">
To Do:<br />    
Need some help here.
</font></b>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Other_Issues"></a> Other Issues </span></h2>
<p />
<p />
<p />
<p />
<p />
<p />
<!-- MAJOR UPDATES
For significant updates to the topic, consider adding your 'signature' (beneath this editing box) !-->
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Major_updates"></a>  Major updates </span></h2>
<!--Future editors should add their signatures beneath yours!-->
-- <a href="/bin/view/Main/JohnWeigand" class="twikiLink">JohnWeigand</a> - 17 Apr 2008 <ul>
<li> <a href="https://twiki.opensciencegrid.org/twiki/pub/Accounting/GratiaInterfacesApelLcgNotes/Tier-2_Accounting_Report_March2008.pdf" target="_top">Tier-2_Accounting_Report_March2008.pdf</a>: Tier 2 Accounting Report - March 2008
</li></ul> </div><!-- /patternTopic-->
<p />
<p />
<div class="twikinetRounded twikinetRoundedAttachments"><div class="rCRounded"><div class="rCTR"><div class="rCTL"></div><!--/rCTL--><div class="twikiAttachments">
<div class="twistyPlugin twikiMakeVisibleInline">  <span id="topicattachmentslistshow" class="twistyRememberSetting twistyTrigger twikiUnvisited twistyHidden twistyInited"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleopen.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Attachments</span></a> </span> <span id="topicattachmentslisthide" class="twistyRememberSetting twistyTrigger twikiUnvisited twistyHidden twistyInited"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleclose.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Attachments</span></a> </span>  </div><!--/twistyPlugin twikiMakeVisibleInline--> <div class="twistyPlugin"><div id="topicattachmentslisttoggle" class="twistyRememberSetting twistyContent twikiMakeHidden twistyInited">
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table summary="Topic attachments" cellspacing="0" id="twikiAttachmentsTable" cellpadding="0" class="twikiTable" rules="rows" border="1"><caption>Topic attachments</caption>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Accounting/GratiaInterfacesApelLcgNotes?cover=print;sortcol=0;table=3;up=0#sorted_table" title="Sort by this column"><font color="#252b37">I</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol1"> <a rel="nofollow" href="/bin/view/Accounting/GratiaInterfacesApelLcgNotes?cover=print;sortcol=1;table=3;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Attachment</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol2"> <a rel="nofollow" href="/bin/view/Accounting/GratiaInterfacesApelLcgNotes?cover=print;sortcol=2;table=3;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Action</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol3"> <a rel="nofollow" href="/bin/view/Accounting/GratiaInterfacesApelLcgNotes?cover=print;sortcol=3;table=3;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Size</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol4"> <a rel="nofollow" href="/bin/view/Accounting/GratiaInterfacesApelLcgNotes?cover=print;sortcol=4;table=3;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Date</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol5"> <a rel="nofollow" href="/bin/view/Accounting/GratiaInterfacesApelLcgNotes?cover=print;sortcol=5;table=3;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Who</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol6 twikiLastCol"> <a rel="nofollow" href="/bin/view/Accounting/GratiaInterfacesApelLcgNotes?cover=print;sortcol=6;table=3;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Comment</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" align="center" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> <img width="16" alt="pdf" align="top" src="/twiki/pub/TWiki/TWikiDocGraphics/pdf.gif" height="16" border="0" /><span class="twikiHidden">pdf</span> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol1 twikiLast"> <a href="/twiki/pub/Accounting/GratiaInterfacesApelLcgNotes/Tier-2_Accounting_Report_March2008.pdf">Tier-2_Accounting_Report_March2008.pdf</a> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol2 twikiLast"> <a href="/bin/attach/Accounting/GratiaInterfacesApelLcgNotes?filename=Tier-2_Accounting_Report_March2008.pdf;revInfo=1" title="change, update, previous revisions, move, delete..." rel="nofollow">manage</a> </td>
			<td bgcolor="#ffffff" align="right" valign="top" class="twikiTableCol3 twikiLast"> 273.6&nbsp;K </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol4 twikiLast"> <span class="twikiNoBreak">17 Apr 2008 - 14:56</span> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol5 twikiLast"> <a href="/bin/view/Main/UnknownUser" class="twikiLink">UnknownUser</a> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol6 twikiLastCol twikiLast"> Tier 2 Accounting Report - March 2008 </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
</div></div> <!--/twistyPlugin--></div><!--//twikiAttachments--></div><!--/rCTR--><div class="rCBR"><div class="rCBL"></div><!--/rCBL--></div><!--/rCBR--></div><!--/rCRounded--></div><!--/twikinetRounded--></div><!-- /patternContent-->
<hr />
This topic: Accounting<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Accounting/WebHome" class="twikiCurrentWebHomeLink twikiLink">WebHome</a> &gt; <a href="/bin/view/Accounting/GratiaInterfacesApelLcg" class="twikiLink">GratiaInterfacesApelLcg</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>GratiaInterfacesApelLcgNotes</span> <br />    
Topic revision: r9 - 12 Oct 2016 - 15:10:07 - <a href="/bin/view/Main/KyleGross" class="twikiLink">KyleGross</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />