---+ IPv6 Testing Log: !Bestman2

This testing log is part of [[Sandbox.OperationsServicesIPv6CompatibilityTable][OSG IPv6 tests]]. This page captures the specific IPv6 compatibility testing process used for one software component, Bestman2. The more general IPv6 template for testing is [[https://twiki.grid.iu.edu/bin/view/SoftwareTeam/IPV6Testing][here]].


---++ Initial Setup

This test used two hosts:

| *Host* | *OS* | *OSG Release* |
| cmssrm2.hep.wisc.edu | ?? |  3.2  |
| ipv6vm010.fnal.gov | Scientific Linux Fermi release 6.6(Ramsey) | 3.2 |

---+++ Installing software

Next, OSG software was installed on each system. The UCSD host was the client and the FNAL host was the server. And VOMS software was installed following the instructions here [[https://twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallVoms][VOMSInstallation]]

| *Host* | *Package* | *Version* |
| cmssrm2.hep.wisc.edu | bestman2-server-2.3.0-21.osg32.el6 |  NA |
| ipv6vm010.fnal.gov |  bestman2-client-2.3.0-21.osg32.el6  | 3.2 |
| ipv6vm010.fnal.gov |  dcache-srmclient-2.2.27-1.osg32.el6 | 3.2 |


---++ Testing

---+++ Testing the dual-dual configuration: Yes

&lt;pre class=&quot;screen&quot;&gt;
&lt;strong&gt; -bash-4.1$ srm-copy srm://cmssrm2.hep.wisc.edu:8443/srm/v2/server?SFN=/hdfs//store/user/tapas/file.list file:///tmp/file.list&lt;/strong&gt;
srm-copy   2.2.2.3.0  Wed Nov  7 16:03:09 CST 2012

BeStMan and SRM-Clients Copyright(c) 2007-2012,
Lawrence Berkeley National Laboratory. All rights reserved.
Support at SRM@LBL.GOV and documents at http://sdm.lbl.gov/bestman
OSG Support at osg-software@opensciencegrid.org and 
documentation at https://www.opensciencegrid.org/bin/view/Documentation/Release3/
  
SRM-CLIENT: Wed Mar 18 17:17:16 CDT 2015 Connecting to httpg://cmssrm2.hep.wisc.edu:8443/srm/v2/server

SRM-CLIENT: Wed Mar 18 17:17:16 CDT 2015 Calling SrmPrepareToGet Request now ...
request.token= get:868139

Request.status=SRM_SUCCESS
Request.explanation=null

SRM-CLIENT: RequestFileStatus for SURL=srm://cmssrm2.hep.wisc.edu:8443/srm/v2/server?SFN=/hdfs//store/user/tapas/file.list is Ready.
SRM-CLIENT: received TURL=gsiftp://g14n27.hep.wisc.edu//hdfs/store/user/tapas/file.list

SRM-CLIENT: Wed Mar 18 17:17:25 CDT 2015 start file transfer
SRM-CLIENT:Source=gsiftp://g14n27.hep.wisc.edu//hdfs/store/user/tapas/file.list
SRM-CLIENT:Target=file:////tmp/file.list

SRM-CLIENT: Wed Mar 18 17:17:30 CDT 2015 end file transfer for srm://cmssrm2.hep.wisc.edu:8443/srm/v2/server?SFN=/hdfs//store/user/tapas/file.list

SRM-CLIENT: Wed Mar 18 17:17:30 CDT 2015 Calling releaseFile

SRM-CLIENT:  ...Calling srmReleaseFiles...
	status=SRM_SUCCESS
	explanation=null
	status=SRM_SUCCESS
	explanation=null

SRM-CLIENT: Request completed with success

SRM-CLIENT: Printing text report now ...

SRM-CLIENT*REQUESTTYPE=get
SRM-CLIENT*TOTALFILES=1
SRM-CLIENT*TOTAL_SUCCESS=1
SRM-CLIENT*TOTAL_FAILED=0
SRM-CLIENT*REQUEST_TOKEN=get:868139
SRM-CLIENT*REQUEST_STATUS=SRM_SUCCESS
SRM-CLIENT*SOURCEURL[0]=srm://cmssrm2.hep.wisc.edu:8443/srm/v2/server?SFN=/hdfs//store/user/tapas/file.list
SRM-CLIENT*TARGETURL[0]=file:///tmp/file.list
SRM-CLIENT*TRANSFERURL[0]=gsiftp://g14n27.hep.wisc.edu//hdfs/store/user/tapas/file.list
SRM-CLIENT*ACTUALSIZE[0]=230307
SRM-CLIENT*FILE_STATUS[0]=SRM_FILE_PINNED

&lt;strong&gt; srmcp -debug srm://cmssrm2.hep.wisc.edu:8443/srm/v2/server?SFN=/hdfs//store/user/tapas/file.list file:////tmp/file-srmcp.list &lt;/strong&gt;
&lt;strong&gt;md5sum /tmp/file*&lt;/strong&gt;
cb16c36a7ef4705b402e62996186a0bd  /tmp/file.list
cb16c36a7ef4705b402e62996186a0bd  /tmp/file-srmcp.list
&lt;/pre&gt;


---+++ Testing that dual-dual communication defaults to IPv6: Yes / No

&lt;pre class=&quot;screen&quot;&gt;
&lt;strong&gt; srmcp srm://cmssrm2.hep.wisc.edu:8443/srm/v2/server?SFN=/hdfs//store/user/tapas/file.list file:////tmp/file-tcpdump-srmcp.list&lt;/strong&gt;
[root@ipv6vm010 ~]# tcpdump -i eth0 -vv ip6 -n host cmssrm2.hep.wisc.edu 
tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes
0 packets captured
7 packets received by filter
0 packets dropped by kernel
&lt;strong&gt; srm-copy srm://cmssrm2.hep.wisc.edu:8443/srm/v2/server?SFN=/hdfs//store/user/tapas/file.list file:////tmp/file-tcpdump-srmcp.list&lt;/strong&gt;
tcpdump -i eth0 -vv ip6 -n host cmssrm2.hep.wisc.edu 
tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes
0 packets captured
7 packets received by filter
0 packets dropped by kernel
&lt;strong&gt; lcg-cp -vbD srmv2 srm://cmssrm2.hep.wisc.edu:8443/srm/v2/server?SFN=/hdfs//store/user/tapas/file.list file:///tmp/file.list &lt;/strong&gt;
Using grid catalog type: UNKNOWN
Using grid catalog : (null)
VO name: (null)
Checksum type: None
Trying SURL srm://cmssrm2.hep.wisc.edu:8443/srm/v2/server?SFN=/hdfs//store/user/tapas/file.list ...
Source SE type: SRMv2
Source SRM Request Token: get:869689
Source URL: srm://cmssrm2.hep.wisc.edu:8443/srm/v2/server?SFN=/hdfs//store/user/tapas/file.list
File size: 230307
Source URL for copy: gsiftp://g19n16.hep.wisc.edu//hdfs/store/user/tapas/file.list
Destination URL: file:/tmp/file.list
# streams: 1
            0 bytes      0.00 KB/sec avg      0.00 KB/sec inst
            0 bytes      0.00 KB/sec avg      0.00 KB/sec inst
            0 bytes      0.00 KB/sec avg      0.00 KB/sec inst
            0 bytes      0.00 KB/sec avg      0.00 KB/sec inst

Transfer took 3040 ms
&lt;strong&gt; tcpdump -i eth0 -vv ip6 -n host cmssrm2.hep.wisc.edu&lt;/strong&gt;
75 packets captured
82 packets received by filter
&lt;strong&gt;gfal-copy srm://cmssrm2.hep.wisc.edu:8443/srm/v2/server?SFN=/hdfs//store/user/tapas/file.list file:////tmp/file-tcpdump-gfal-copy.list&lt;/strong&gt;
&lt;/pre&gt;

Had to modify the file =/etc/gfal2.d/gsiftp_plugin.conf= set =IPv6= to True
---+++ Testing the dual server / IPv4 client configuration: Yes

Same tests were done as in the other cases



-- Main.EdgarMauricioFajardoHernandez2 - 18 Mar 2015

