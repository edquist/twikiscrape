<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> EnstoreAppaNetworkControls &lt; Sandbox &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Sandbox/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Sandbox/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Sandbox/EnstoreAppaNetworkControls?_T=16 Feb 2017" type="application/x-wiki" title="edit EnstoreAppaNetworkControls" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><meta name="robots" content="noindex,nofollow"> 
<base href="https://twiki.opensciencegrid.org/bin/view/Sandbox/EnstoreAppaNetworkControls"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#DDDDDD;
	}
	.patternBookView {
		border-color:#DDDDDD;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> This appendix discusses the control of ethernets on client systems when the client interacts directly with Enstore via encp, as opposed to interacting with the dCache as a front-end. 
<p />
<h1><a name="Default_Routing_for_Encp"></a> Default Routing for Encp </h1>
By default, encp uses the DNS name obtained by the hostname command for control messages. Encp uses whatever routing the client system or network administrator sets between the client system and the Enstore system for data transfers. 
<p />
Typically, the default configuration suffices for machines having a single network interface, or having a single network interface dedicated to data movement. 
<p />
<h1><a name="Routing_via_the_enstore_conf_Fil"></a> Routing via the enstore.conf File </h1>
For large client machines with multiple network connections (interfaces), each network interface is attached to a different (virtual) router. A one-to-one mapping is made between the IP address of each interface and the IP of the router it is attached to. The Computing Division&#8217;s networking group must perform the configuration for this. 
<p />
Administrators can create an enstore.conf file to configure the routing to allow for multiple network interface cards dedicated to Enstore, and/or to allow for a different IP address to be used for the encp control socket. The default location for the file is <code>/etc/enstore.conf</code>. The location of the file can be overridden with the environment variable ENSTORE_CONF. 
<p />
The file format supports comments, a host ip line, and zero or more interface \lines (all these line types are optional). 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Comment_Lines"></a> Comment Lines </span></h2>
<p />
Comment lines begin with a "pound" sign, "#", e.g.,: 
<p />
<pre>
# this is s comment line
</pre>
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Hostip_Line"></a> Hostip Line </span></h2>
<p />
The hostip line gives the host IP address used to override the DNS name that encp uses to bind(2) with. This is used when doing a (passive) open on a socket used to listen for a call back from the mover. One and only one hostname line is necessary per enstore.conf file. For example: 
<p />
<pre>
hostip&#61;131.225.42.42
</pre>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Interface_Lines"></a> Interface Lines </span></h2>
<p />
Lines starting with interface are used in this file to specify more than one network interface for data transfers. An enstore.conf file would typically contain either zero or at least two of these lines, since a single interface can be controlled more conventionally with static routes. 
<p />
This functionality is known to work on IRIX machines. It has not been tested on <span class="twikiNewLink">SunOS<a href="/bin/edit/Sandbox/SunOS?topicparent=Sandbox.EnstoreAppaNetworkControls" rel="nofollow" title="SunOS (this topic does not yet exist; you can create it)">?</a></span> or OSF1, although it is expected to work; the Linux kernel doesn&#8217;t support it. 
<p />
The underlying implementation mechanisms for multiple interfaces are portable, and the scheme can be extended on demand. When more than two interfaces are used, it is necessary to have each interface on its own subnet. (The system or network administrator needs to configure the subnets.) The enroute2 executable (part of the encp product) must be installed and have setuid root on the machine in order to enable this feature. 
<p />
In order for the interface lines in the /etc/enstore.conf to be used; an executable named enroute2 with the setuid bit turned on needs to be in encp&#8217;s path. This executable is included with the encp product from UPS/UPD, but the setuid bit is not set by default. 
<p />
The search path for this executable with the setuid bit set is: 
<p /> <ol>
<li> <code>$ENROUTE2</code> 
</li> <li> <code>$ENCP_DIR/enroute2</code> 
</li> <li> <code>$ENSTORE_DIR/sbin/enroute2</code> 
</li> <li>  <code>/usr/local/bin/enroute2</code> 
</li> <li>  <code>/etc/enroute2</code>
</li></ol> 
<p />
An interface line must specify four keywords (with an optional fifth for IRIX): 
<p /> <ul>
<li> <code>interface</code>: specifies the network device. 
</li> <li> <code>weight</code>: specifies the relative capacity of each interface. For example, if 1 Gb/s and 100 Mb/s interfaces are used, they might be assigned weights of 30 and 10, respectively.  <dl>
<dt> <img src="/twiki/pub/TWiki/TWikiDocGraphics/help.gif" alt="HELP" title="HELP" width="16" height="16" border="0" />     <strong><font color="#0000ff">NOTE</font></strong> </dt><dd> Despite the 1Gb name, these cards typically get 30 MB/s. A 100Mb/s network card typically gets a 10/MB/s rate. Hence, the weights 30 and 10. 
</dd></dl> 
</li> <li> <code>ip</code>: specifies the ip address corresponding to the device given by interface. 
</li> <li> <code>gw</code>: specifies the ip address corresponding to the gateway to the Enstore movers for the device given by interface. (Get this information from the networking admins.) 
</li> <li> <code>cpu</code>: The cpu keyword is used on IRIX systems only. Its use is desirable for minimizing the amount of CPU used per transfer, though it is technically not required. The performance enhancements will take effect if two conditions are met: If the CPU used by encp has hardware affinity with the slot holding the network card, and if the same CPU performs interrupt service for the network card. 
</li></ul> 
<p />
For example, a file may contain two interface lines as follows: 
<p />
<pre>
   interface&#61;eg2 weight&#61;30 cpu&#61;2 gw&#61;131.225.32.32 ip&#61;131.225.32.31
   interface&#61;eg3 weight&#61;10 cpu&#61;3 gw&#61;131.225.32.36 ip&#61;131.225.32.35
</pre></div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Sandbox<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Main/TWikiUsers" class="twikiLink">TWikiUsers</a> &gt; <a href="/bin/view/Main/ForrestChristian" class="twikiLink">ForrestChristian</a> &gt; <a href="/bin/view/Sandbox/ForrestChristianSandbox" class="twikiLink">ForrestChristianSandbox</a> &gt; <a href="/bin/view/Sandbox/EnstoreIntro" class="twikiLink">EnstoreIntro</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>EnstoreAppaNetworkControls</span> <br />    
Topic revision: r1 - 26 Sep 2006 - 23:21:50 - <span class="twikiNewLink">ForrestChristian<a href="/bin/edit/Sandbox/ForrestChristian?topicparent=Sandbox.EnstoreAppaNetworkControls" rel="nofollow" title="ForrestChristian (this topic does not yet exist; you can create it)">?</a></span>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />