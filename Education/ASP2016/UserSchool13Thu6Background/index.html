<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> UserSchool13Thu6Background &lt; Education/ASP2016 &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Education/ASP2016/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Education/ASP2016/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Education/ASP2016/UserSchool13Thu6Background?_T=16 Feb 2017" type="application/x-wiki" title="edit UserSchool13Thu6Background" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Education/ASP2016/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Education/ASP2016/UserSchool13Thu6Background"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#D0D0D0;
	}
	.patternBookView {
		border-color:#D0D0D0;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">

@import url('/pub/Documentation/Tools/exercises.css ');

</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <style type="text/css">
pre em { font-style: normal; background-color: yellow; }
pre strong { font-style: normal; font-weight: bold; color: #008; }
</style>
<p />
<h1><a name="Thursday_Exercise_6_Background_I"></a> Thursday Exercise 6: Background Information: Joe's Computing Work </h1>
Joe Biologist studies the influence of genetic differences (genotypes) on the growth characteristics (phenotypes) of a common crop. Joe has come to you with some computing work he’d like to make into a workflow on your computing grid. He has used HTCondor to submit separate jobs, but has only run in a smaller, dedicated cluster where he doesn’t have to request CPU, disk, or RAM, and he’s not familiar with DAGman.
<p />
<h3><a name="After_asking_Joe_many_questions"></a> After asking Joe many questions, you realize the following things: </h3>
<p />
<strong>1) Joe starts with a file called <code>input.csv</code> that was made on his desktop.</strong> When you open this file in excel, Joe shows you that each row corresponds to an individual plant. For each individual, the first three columns are phenotype measurements for each of three different growth traits (T240, T300, T360), and the remaining columns contain the genotype (A or B) of that individual across multiple genes.
<p />
<strong>2) Joe performs two steps <em>for each trait</em>: a "Permutation preparation" step and a “QTL mapping” step that each need only 1 CPU core.</strong> <ul>
<li> For each trait, the phenotype and genotype information for all individuals is first used for permutation testing carried out by an R program, <code>run_perm.R</code>, which generates a set number of permutations according to an argument that is passed to the program. Joe needs to run 25,000 total permutations per trait.
</li> <li> A g-zipped tarball of all the permutation output for a trait is then created to be used in the second step.
</li> <li> In the QTL mapping step, <code>qtl.R</code>, takes in the data from <code>input.csv</code>, data from a tarball of the trait-specific permutation output, and an argument indicating the input.csv column number for the trait. 
</li> <li> The QTL step produces multiple output files that Joe then needs to tar and compress so he can copy the final data back to his own computer.
</li></ul> 
<p />
<strong>3) Joe uses a special wrapper script to execute his two steps with HTCondor.</strong> This perl script, <code>runR.pl</code>, installs R from a squid proxy and sets up the R environment. For both of Joe’s R programs, the <code>runR.pl</code> wrapper script is run as the HTCondor executable with the name of either R program passed as an argument to the wrapper (along with arguments for the R programs themselves).
<p />
<strong>4) Joe has brought all of his inputs/outputs and submit files for you to modify.</strong> (You’ll see these in the exercises.)
<p />
<strong>5) When Joe runs all 25,000 permutations as one condor job, it will run for hours (too long for <em>your</em> cluster, which only runs jobs for up to 1 hour).</strong> He has cut the permutations up into multiple HTCondor jobs before, but doesn’t remember the details.
<p />
<p />
<h3><a name="Joe_s_Job_Summaries"></a> Joe’s Job Summaries </h3>
<p />
Based upon Joe’s description and submit files you determine the following details for each step:
<p />
<h4><a name="Permutation_Step_example_if_perm"></a> <strong>Permutation Step</strong> (example if permutation1.submit) </h4>
<p />
execution: 	 <ul>
<li> <code>./runR.pl 1_$(Process) run_perm.R 1 $(Process) 25000</code>
</li></ul> 
<p />
arg descriptions:	 <ul>
<li> <code>1_$(Process)</code>, used by <code>runR.pl</code> to name its log file
</li> <li> <code>1</code>, trait column in <code>input.csv</code> (i.e. this is 3 for permutation3.submit)
</li> <li> <code>$(Process)</code>,	used by <code>run_perm.R</code> for naming the permutation output
</li> <li> <code>25000</code>,	indicates that 25,000 permutations should be done for this job process
</li></ul> 
<p />
input: 		 <ul>
<li> <code>run_perm.R</code>, <code>input.csv</code>, <code>RLIBS.tar.gz</code>
</li></ul> 
<p />
 output: 	 <ul>
<li> <code>runR.1_0.out</code>, log file for <code>runR.pl</code>, where "1_0" is from arg
</li> <li> <code>perm_part.1_0.Rdat</code>, output from <code>run_perm.R</code>, "1" and "0" are from args
</li></ul> 
<p />
<strong>Note:</strong> <code>tarit.sh</code> is run after each trait's Permutation step (with the column number as an argument) to compresses <code>perm_part.1_0.Rdat</code> for the QTL step. Execution: <code>tarit.sh 1</code>
<p />
<h4><a name="QTL_Mapping_Step_example_if_qtl1"></a> <strong>QTL Mapping Step</strong> (example if <code>qtl1.submit</code>) </h4>
<p />
execution:	 <ul>
<li> <code>./runR.pl qtl_1 qtl.R 1</code>
</li></ul> 
<p />
arg descriptions:	 <ul>
<li> <code>qtl_1</code>, used by <code>runR.pl</code> to name its log file
</li> <li> <code>1</code>, trait column in <code>input.csv</code>
</li></ul> 
<p />
input:		
        <code>qtl.R, input.csv</code>, <code>RLIBS.tar.gz</code>, <code>perm_combined.tar.gz</code> (created by <code>tarit.sh</code>)
<p />
output:	 <ul>
<li> <code>runR.qtl_1.out</code>, log file for <code>runR.pl</code>, where "qtl_1" is from arg
</li> <li> <code>perm_combined_1.Rdat</code>,	"1" is from <code>qtl.R</code> arg
</li> <li> <code>perm_summary_1.txt</code>, “”
</li> <li> <code>sim_geno_results_1.Rdat</code>, “”
</li> <li> <code>qtl_1.Rdat</code>, “”
</li> <li> <code>refined_qtl_summary_1.txt</code>, “”
</li> <li> <code>refined qtl_1.Rdat</code>, “”
</li> <li> <code>fit_qtl_results_1.Rdat</code>, "”
</li></ul> 
<p />
<strong>Note:</strong> <code>results_1.tar.gz</code> is made by running <code>taritall.sh</code> (with the column number as an argument) after the QTL step for each trait finishes, where "1" reflects the trait column number in the output above. Execution: <code>tarit.sh 1</code>
<p />
<p />
<p />
<p />
<p />
-- <a href="/bin/view/Main/LaurenMichael" class="twikiLink">LaurenMichael</a> - 26 Jun 2013</div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Education/ASP2016<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Education/ASP2016/UserSchool13Materials" class="twikiLink">UserSchool13Materials</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>UserSchool13Thu6Background</span> <br />    
Topic revision: r3 - 27 Jun 2013 - 16:21:09 - <a href="/bin/view/Main/LaurenMichael" class="twikiLink">LaurenMichael</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />