---+ 2013 OSG User School - Using OSG Security Tools

Time to spend on this: 10 minutes

The exercises should be carried out on [[OSGSS2013TueGlideinSetup][the glidein submit node]],
although [[UserSchool13Mon11LogIn][osg-ss-submit]] should work just as well. 

Assumption: You should have [[UserSchool13Certificate][obtained your certificate]] by now.

Please copy your .p12 file into the $HOME/.globus directory (and create the directory first, if needed), if you have not done it yet.&lt;br&gt;
Make sure it is not readable by anyone else but you
&lt;pre class=&quot;screen&quot;&gt;
sfiligoi@osg ~$ ls -l .globus/
-rw------- 1 sfiligoi osgeduadm 5098 May  2  2013 cert.p12
&lt;/pre&gt;

---+++ Looking into your certificate

You will likely never need to look at the details of the certificate itself; you will usually always deal with proxies instead.

Nevertheless, it may come handy to know what it is inside the certificate. &lt;b&gt;openssl&lt;/b&gt; provides a (relatively) easy way to do this. Try all these:
&lt;pre class=&quot;screen&quot;&gt;
openssl pkcs12 -in ~/.globus/cert.p12 -nokeys -clcerts |openssl x509 -noout -subject
openssl pkcs12 -in ~/.globus/cert.p12 -nokeys -clcerts |openssl x509 -noout -enddate
openssl pkcs12 -in ~/.globus/cert.p12 -nokeys -clcerts |openssl x509 -noout -text
&lt;/pre&gt;

---++ Proxy handling

As mentioned in the security lecture, you will often need a proxy.

To create a basic proxy, use can use &lt;b&gt;grid-proxy-ini&lt;/b&gt;
&lt;pre class=&quot;screen&quot;&gt;
voms-proxy-init -cert ~/.globus/cert.p12 -key ~/.globus/cert.p12 -out ~/.globus/proxy.pem -valid 12:0
&lt;/pre&gt;

Unlike the certificate, which is in the p12 format, the proxy will be in the PEM format.
Using &lt;b&gt;openssl&lt;/b&gt; to look at it is thus slightly easier
&lt;pre class=&quot;screen&quot;&gt;
openssl x509 -in ~/.globus/proxy.pem -noout -subject
openssl x509 -in ~/.globus/proxy.pem -noout -enddate
openssl x509 -in ~/.globus/proxy.pem -noout -text
&lt;/pre&gt;

However, you can also use &lt;b&gt;voms-proxy-info&lt;/b&gt; for this purpose. You will likely find it more useful:
&lt;pre class=&quot;screen&quot;&gt;
voms-proxy-info -file ~/.globus/proxy.pem -all
&lt;/pre&gt;

BTW: You probably want to set
&lt;pre class=&quot;screen&quot;&gt;
export X509_USER_PROXY=~/.globus/proxy.pem
&lt;/pre&gt;

so you don&#39;t need to keep pointing the Grid tools to it. Not his will do the trick
&lt;pre class=&quot;screen&quot;&gt;
voms-proxy-info -all
&lt;/pre&gt;

Now, as also mentioned in the security lesson, you will need a VOMS attribute for authentication at sites. &lt;b&gt;voms-proxy-init&lt;/b&gt; can do that, if you specify the right option&lt;br&gt;
(here I assume you defined X509_USER_PROXY)
&lt;pre class=&quot;screen&quot;&gt;
voms-proxy-init -cert ~/.globus/cert.p12 -key ~/.globus/cert.p12 -voms osgedu -valid 12:0 -hours 12
&lt;/pre&gt;

Look at the content of the proxy now.

-- Main.IgorSfiligoi
