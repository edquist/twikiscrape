---+ Using the Globus Tools

We&#39;ll spend just a bit of time on the Globus command-line tools so you are aware that they exist.  

---+ Submitting jobs with =globus-job-run=

The =globus-job-run= command line utility allows one to submit jobs directly to a Globus gatekeeper.  To use this, you need to know three things:
   * Remote gatekeeper hostname
   * Port
   * Jobmanager (the name of the service on the gatekeeper you will be using).

Let&#39;s start running on =osg-edu.cs.wisc.edu= with the default port and the default jobmanager.  Log into =vdt-itb.cs.wisc.edu= and create your proxy if you haven&#39;t yet.

&lt;pre class=&quot;screen&quot;&gt;
[bbockelm@vdt-itb ~]$ %BLUE%globus-job-run osg-edu.cs.wisc.edu:/jobmanager /usr/bin/whoami%ENDCOLOR%
osgedu
[bbockelm@vdt-itb ~]$ %BLUE%globus-job-run osg-edu.cs.wisc.edu:/jobmanager /bin/hostname%ENDCOLOR%
osg-edu.cs.wisc.edu
&lt;/pre&gt;

The output of the command line is the output of the executable running on the remote host.  As you can see, we were executing as the =osgedu= user and on the =osg-edu.cs.wisc.edu= host.

---++ jobmanager, jobmanager-fork, or jobmanager-condor?

One key concept in Globus is the fact that a single gatekeeper can provide several different &quot;jobmanagers&quot;, each providing a different access to a different kind of resource.  Typically, there are three different jobmanagers at each site:
   * =jobmanager-fork=: This is installed at every site; the jobmanager simply forks off a new process on the CE.  This allows you to run a process on the headnode itself; some tools will use this for monitoring, and some VOs will use this as a mechanism to install software on the system.  *NEVER* use this for a computational job.
   * =jobmanager-condor= (or =jobmanager-pbs=, =jobmanager-lsf=, or =jobmanager-sge=): This is the batch-system jobmanager; its name is different depending on the batch system installed on the resource.  OSG batch systems include condor, pbs, lsf, and sge.  You can use any of these without having to make changes to anything except the jobmanager name.  Using this jobmanager, you get access to the worker nodes of the cluster.  This is where all of the compute-intensive jobs are sent.
   * =jobmanager=: This is the -default- jobmanager.  For the most part, on the OSG, this points to =jobmanager-fork=.  On other grids, this differs.  *NEVER* use the default jobmanager, as you&#39;re never quite sure where jobs will land.  If you inadvertently send a large number of compute jobs to the headnode using =jobmanager=, you run the risk of crashing the site - and getting banned!

For now, let&#39;s try using each of these on the OSG-EDU resource and compare the outputs.

---+++ Jobmanager and Jobmanager-fork

First, confirm that =jobmanager= and =jobmanager-fork= point at the same place:
&lt;pre class=&quot;screen&quot;&gt;
[bbockelm@vdt-itb ~]$ %BLUE%globus-job-run osg-edu.cs.wisc.edu:/jobmanager /bin/hostname%ENDCOLOR%
osg-edu.cs.wisc.edu
&lt;/pre&gt;

&lt;pre class=&quot;screen&quot;&gt;
[bbockelm@vdt-itb ~]$ %BLUE%globus-job-run osg-edu.cs.wisc.edu:/jobmanager-fork /bin/hostname%ENDCOLOR%
osg-edu.cs.wisc.edu
&lt;/pre&gt;

Next, look at the environment found in =jobmanager-fork=:
&lt;pre class=&quot;screen&quot;&gt;
%BLUE%globus-job-run osg-edu.cs.wisc.edu:/jobmanager-fork /bin/env%ENDCOLOR%
%TWISTY%
_CONDOR_ANCESTOR_8931=8932:1279493050:660096640
_CONDOR_ANCESTOR_19806=19809:1279044849:46118618
_CONDOR_ANCESTOR_19809=8931:1279493050:4142585901
GRID3_BASE_DIR=/opt/osg-1.2
PATH=/opt/osg-1.2/osg/bin:/opt/osg-1.2/bwctl/bin:/opt/osg-1.2/owamp/bin:/opt/osg-1.2/npad/bin:/opt/osg-1.2/ndt/bin:/opt/osg-1.2/subversion/bin:/opt/osg-1.2/apache/bin:/opt/osg-1.2/dccp/bin:/opt/osg-1.2/condor-cron/wrappers:/opt/osg-1.2/srm-client-lbnl/bin:/opt/osg-1.2/srm-client-fermi/sbin:/opt/osg-1.2/srm-client-fermi/bin:/opt/osg-1.2/gums/scripts:/opt/osg-1.2/cert-scripts/bin:/opt/osg-1.2/edg/sbin:/opt/osg-1.2/gip/bin:/opt/osg-1.2/prima/bin:/opt/osg-1.2/curl/bin:/opt/osg-1.2/glite/sbin:/opt/osg-1.2/glite/bin:/opt/osg-1.2/mysql5/bin:/opt/osg-1.2/osg/bin:/opt/osg-1.2/ant/bin:/opt/osg-1.2/jdk1.6/bin:/usr/sbin:/usr/bin:/opt/osg-1.2/wget/bin:/opt/osg-1.2/logrotate/sbin:/opt/osg-1.2/gpt/sbin:/opt/osg-1.2/globus/bin:/opt/osg-1.2/globus/sbin:/opt/pacman/bin:/opt/osg-1.2/vdt/sbin:/opt/osg-1.2/vdt/bin:/opt/osg-1.2/osg/bin:/opt/osg-1.2/bwctl/bin:/opt/osg-1.2/owamp/bin:/opt/osg-1.2/npad/bin:/opt/osg-1.2/ndt/bin:/opt/osg-1.2/subversion/bin:/opt/osg-1.2/apache/bin:/opt/osg-1.2/dccp/bin:/opt/osg-1.2/condor-cron/wrappers:/opt/osg-1.2/srm-client-lbnl/bin:/opt/osg-1.2/srm-client-fermi/sbin:/opt/osg-1.2/srm-client-fermi/bin:/opt/osg-1.2/gums/scripts:/opt/osg-1.2/cert-scripts/bin:/opt/osg-1.2/edg/sbin:/opt/osg-1.2/gip/bin:/opt/osg-1.2/prima/bin:/opt/osg-1.2/curl/bin:/opt/osg-1.2/glite/sbin:/opt/osg-1.2/glite/bin:/opt/osg-1.2/mysql5/bin:/opt/osg-1.2/osg/bin:/opt/osg-1.2/ant/bin:/opt/osg-1.2/jdk1.6/bin:/usr/sbin:/usr/bin:/opt/osg-1.2/wget/bin:/opt/osg-1.2/logrotate/sbin:/opt/osg-1.2/gpt/sbin:/opt/pacman/bin:/opt/osg-1.2/vdt/sbin:/opt/osg-1.2/vdt/bin:/sbin:/usr/sbin:/bin:/usr/bin:/usr/X11R6/bin
LD_LIBRARY_PATH=/opt/osg-1.2/subversion/lib:/opt/osg-1.2/apache/lib:/opt/osg-1.2/MonaLisa/Service/VDTFarm/pgsql/lib:/opt/osg-1.2/prima/lib:/opt/osg-1.2/curl/lib:/opt/osg-1.2/glite/lib64:/opt/osg-1.2/glite/lib:/opt/osg-1.2/mysql5/lib/mysql:/opt/osg-1.2/jdk1.6/jre/lib/i386:/opt/osg-1.2/jdk1.6/jre/lib/i386/server:/opt/osg-1.2/jdk1.6/jre/lib/i386/client:/opt/osg-1.2/berkeley-db/lib:/opt/osg-1.2/expat/lib:/opt/osg-1.2/globus/lib:/opt/osg-1.2/subversion/lib:/opt/osg-1.2/apache/lib:/opt/osg-1.2/MonaLisa/Service/VDTFarm/pgsql/lib:/opt/osg-1.2/prima/lib:/opt/osg-1.2/curl/lib:/opt/osg-1.2/glite/lib64:/opt/osg-1.2/glite/lib:/opt/osg-1.2/mysql5/lib/mysql:/opt/osg-1.2/jdk1.6/jre/lib/i386:/opt/osg-1.2/jdk1.6/jre/lib/i386/server:/opt/osg-1.2/jdk1.6/jre/lib/i386/client:/opt/osg-1.2/berkeley-db/lib:/opt/osg-1.2/expat/lib::/opt/osg-1.2/subversion/lib:/opt/osg-1.2/apache/lib:/opt/osg-1.2/MonaLisa/Service/VDTFarm/pgsql/lib:/opt/osg-1.2/prima/lib:/opt/osg-1.2/curl/lib:/opt/osg-1.2/glite/lib64:/opt/osg-1.2/glite/lib:/opt/osg-1.2/mysql5/lib/mysql:/opt/osg-1.2/jdk1.6/jre/lib/i386:/opt/osg-1.2/jdk1.6/jre/lib/i386/server:/opt/osg-1.2/jdk1.6/jre/lib/i386/client:/opt/osg-1.2/berkeley-db/lib:/opt/osg-1.2/expat/lib:/opt/osg-1.2/globus/lib:/opt/osg-1.2/subversion/lib:/opt/osg-1.2/apache/lib:/opt/osg-1.2/MonaLisa/Service/VDTFarm/pgsql/lib:/opt/osg-1.2/prima/lib:/opt/osg-1.2/curl/lib:/opt/osg-1.2/glite/lib64:/opt/osg-1.2/glite/lib:/opt/osg-1.2/mysql5/lib/mysql:/opt/osg-1.2/jdk1.6/jre/lib/i386:/opt/osg-1.2/jdk1.6/jre/lib/i386/server:/opt/osg-1.2/jdk1.6/jre/lib/i386/client:/opt/osg-1.2/berkeley-db/lib:/opt/osg-1.2/expat/lib:/opt/osg-1.2/subversion/lib:/opt/osg-1.2/apache/lib:/opt/osg-1.2/MonaLisa/Service/VDTFarm/pgsql/lib:/opt/osg-1.2/prima/lib:/opt/osg-1.2/curl/lib:/opt/osg-1.2/glite/lib64:/opt/osg-1.2/glite/lib:/opt/osg-1.2/mysql5/lib/mysql:/opt/osg-1.2/jdk1.6/jre/lib/i386:/opt/osg-1.2/jdk1.6/jre/lib/i386/server:/opt/osg-1.2/jdk1.6/jre/lib/i386/client:/opt/osg-1.2/berkeley-db/lib:/opt/osg-1.2/expat/lib:/opt/osg-1.2/globus/lib
OSG_JOB_CONTACT=osg-edu.cs.wisc.edu/jobmanager-condor
OSG_LOCATION=/opt/osg-1.2
_CONDOR_SLOT=1
OSG_SQUID_LOCATION=UNAVAILABLE
GRID3_SITE_NAME=WISC-OSG-EDU
OSG_DEFAULT_SE=osg-edu.cs.wisc.edu
OSG_GRID=/nfs/wn-client
TMPDIR=/var/lib/condor/spool/local_univ_execute/dir_8931
GLOBUS_LOCATION=/opt/osg-1.2/globus
GRID3_APP_DIR=/nfs/osg-app
_CONDOR_SCRATCH_DIR=/var/lib/condor/spool/local_univ_execute/dir_8931
TEMP=/var/lib/condor/spool/local_univ_execute/dir_8931
OSG_HOSTNAME=osg-edu.cs.wisc.edu
OSG_STORAGE_ELEMENT=True
PERL5LIB=/opt/osg-1.2/perl/lib/5.8.0:/opt/osg-1.2/perl/lib/5.8.0/i686-linux-thread-multi:/opt/osg-1.2/perl/lib/site_perl/5.8.0:/opt/osg-1.2/perl/lib/site_perl/5.8.0/i686-linux-thread-multi:/opt/osg-1.2/vdt/lib:/opt/osg-1.2/perl/lib/5.8.0:/opt/osg-1.2/perl/lib/5.8.0/i686-linux-thread-multi:/opt/osg-1.2/perl/lib/site_perl/5.8.0:/opt/osg-1.2/perl/lib/site_perl/5.8.0/i686-linux-thread-multi:/opt/osg-1.2/vdt/lib:/opt/osg-1.2/perl/lib/5.8.0:/opt/osg-1.2/perl/lib/5.8.0/i686-linux-thread-multi:/opt/osg-1.2/perl/lib/site_perl/5.8.0:/opt/osg-1.2/perl/lib/site_perl/5.8.0/i686-linux-thread-multi:/opt/osg-1.2/vdt/lib:
GLOBUS_GRAM_MYJOB_CONTACT=URLx-nexus://osg-edu.cs.wisc.edu:38048/
GLOBUS_GRAM_JOB_CONTACT=https://osg-edu.cs.wisc.edu:38047/8833/1279493049/
OSG_SITE_NAME=WISC-OSG-EDU
OSG_APP=/nfs/osg-app
GRID3_TMP_WN_DIR=/tmp
OSG_WN_TMP=/tmp
GRID3_DATA_DIR=/nfs/osg-data
X509_USER_PROXY=/nfs/osgedu/.globus/job/osg-edu.cs.wisc.edu/8833.1279493049/x509_up
GRID3_TMP_DIR=/nfs/osg-data
TMP=/var/lib/condor/spool/local_univ_execute/dir_8931
_CONDOR_JOB_AD=/var/lib/condor/spool/local_univ_execute/dir_8931/.job.ad
OSG_SITE_WRITE=srm://osg-edu.cs.wisc.edu:10443/srm/v2/server
OSG_GLEXEC_LOCATION=UNAVAILABLE
OSG_DATA=/nfs/osg-data
HOME=/nfs/osgedu
_CONDOR_MACHINE_AD=/var/lib/condor/spool/local_univ_execute/dir_8931/.machine.ad
LOGNAME=osgedu
OSG_SITE_READ=srm://osg-edu.cs.wisc.edu:10443/srm/v2/server
%ENDTWISTY%
&lt;/pre&gt;

What potentially useful (or OSG-related) environment variables do you see?

---+++ Batch System Jobmanager

The batch system jobmanager gives you access to the compute nodes.  On the OSG-EDU resource, we use =jobmanager-condor=.  Let&#39;s take a look:
&lt;pre class=&quot;screen&quot;&gt;
[bbockelm@vdt-itb ~]$ %BLUE%globus-job-run osg-edu.cs.wisc.edu:/jobmanager-condor /bin/hostname%ENDCOLOR%
miniosg-c02
[bbockelm@vdt-itb ~]$ %BLUE%globus-job-run osg-edu.cs.wisc.edu:/jobmanager-condor /usr/bin/env%ENDCOLOR%
%TWISTY%
_CONDOR_ANCESTOR_13126=13127:1279493545:4006455552
_CONDOR_ANCESTOR_3462=13126:1279493545:3344853832
_CONDOR_ANCESTOR_3459=3462:1277400272:2753619200
GRID3_BASE_DIR=/opt/osg-1.2
LD_LIBRARY_PATH=/opt/osg-1.2/subversion/lib:/opt/osg-1.2/apache/lib:/opt/osg-1.2/MonaLisa/Service/VDTFarm/pgsql/lib:/opt/osg-1.2/prima/lib:/opt/osg-1.2/curl/lib:/opt/osg-1.2/glite/lib64:/opt/osg-1.2/glite/lib:/opt/osg-1.2/mysql5/lib/mysql:/opt/osg-1.2/jdk1.6/jre/lib/i386:/opt/osg-1.2/jdk1.6/jre/lib/i386/server:/opt/osg-1.2/jdk1.6/jre/lib/i386/client:/opt/osg-1.2/berkeley-db/lib:/opt/osg-1.2/expat/lib:/opt/osg-1.2/globus/lib:/opt/osg-1.2/subversion/lib:/opt/osg-1.2/apache/lib:/opt/osg-1.2/MonaLisa/Service/VDTFarm/pgsql/lib:/opt/osg-1.2/prima/lib:/opt/osg-1.2/curl/lib:/opt/osg-1.2/glite/lib64:/opt/osg-1.2/glite/lib:/opt/osg-1.2/mysql5/lib/mysql:/opt/osg-1.2/jdk1.6/jre/lib/i386:/opt/osg-1.2/jdk1.6/jre/lib/i386/server:/opt/osg-1.2/jdk1.6/jre/lib/i386/client:/opt/osg-1.2/berkeley-db/lib:/opt/osg-1.2/expat/lib:
OSG_JOB_CONTACT=osg-edu.cs.wisc.edu/jobmanager-condor
OSG_LOCATION=/opt/osg-1.2
_CONDOR_SLOT=1
OSG_SQUID_LOCATION=UNAVAILABLE
GRID3_SITE_NAME=WISC-OSG-EDU
OSG_DEFAULT_SE=osg-edu.cs.wisc.edu
OSG_GRID=/nfs/wn-client
TMPDIR=/var/lib/condor/execute/dir_13126
GLOBUS_LOCATION=/nfs/wn-client/globus
GRID3_APP_DIR=/nfs/osg-app
_CONDOR_SCRATCH_DIR=/var/lib/condor/execute/dir_13126
TEMP=/var/lib/condor/execute/dir_13126
OSG_HOSTNAME=osg-edu.cs.wisc.edu
OSG_STORAGE_ELEMENT=True
GLOBUS_GRAM_MYJOB_CONTACT=URLx-nexus://osg-edu.cs.wisc.edu:38288/
GLOBUS_GRAM_JOB_CONTACT=https://osg-edu.cs.wisc.edu:38287/12073/1279493600/
OSG_SITE_NAME=WISC-OSG-EDU
OSG_APP=/nfs/osg-app
GRID3_TMP_WN_DIR=/tmp
OSG_WN_TMP=/tmp
X509_USER_PROXY=/nfs/osgedu/.globus/job/osg-edu.cs.wisc.edu/12073.1279493600/x509_up
GRID3_DATA_DIR=/nfs/osg-data
GRID3_TMP_DIR=/nfs/osg-data
TMP=/var/lib/condor/execute/dir_13126
_CONDOR_JOB_AD=/var/lib/condor/execute/dir_13126/.job.ad
OSG_SITE_WRITE=srm://osg-edu.cs.wisc.edu:10443/srm/v2/server
OSG_GLEXEC_LOCATION=UNAVAILABLE
OSG_DATA=/nfs/osg-data
HOME=/nfs/osgedu
_CONDOR_MACHINE_AD=/var/lib/condor/execute/dir_13126/.machine.ad
LOGNAME=osgedu
OSG_SITE_READ=srm://osg-edu.cs.wisc.edu:10443/srm/v2/server
%ENDTWISTY%
&lt;/pre&gt;

Compare the output from the Condor cluster OSG-EDU to the PBS cluster at Firefly:
&lt;pre class=&quot;screen&quot;&gt;
[bbockelm@vdt-itb ~]$ %BLUE%globus-job-run ff-grid.unl.edu:/jobmanager-pbs /bin/hostname%ENDCOLOR%
c3315.local
[bbockelm@vdt-itb ~]$ %BLUE%globus-job-run ff-grid.unl.edu:/jobmanager-pbs /usr/bin/env%ENDCOLOR%
%TWISTY%
MODULE_VERSION_STACK=3.2.7
GRID3_DATA_DIR=/panfs/panasas/CMS/data
HOSTNAME=c3315.local
GRID3_TMP_WN_DIR=/state/partition1/tmp
PBS_VERSION=TORQUE-2.4.8
OSG_GLEXEC_LOCATION=UNAVAILABLE
SHELL=/bin/sh
HISTSIZE=1000
PBS_JOBNAME=STDIN
GLOBUS_LOCATION=/opt/osgwn1.2.4/globus
PBS_ENVIRONMENT=PBS_BATCH
JBOSS_HOME=/opt/jboss
OSG_WN_TMP=/state/partition1/tmp
PBS_O_WORKDIR=/panfs/panasas/CMS/grid_users/uscmsPool018
ANT_HOME=/opt/rocks
OSG_JOB_CONTACT=ff-grid.unl.edu/jobmanager-pbs
OSG_SQUID_LOCATION=UNAVAILABLE
PBS_TASKNUM=1
USER=uscmsPool018
OSG_SITE_WRITE=UNAVAILABLE
LS_COLORS=
LD_LIBRARY_PATH=/opt/osg/osg-1.2/subversion/lib:/opt/osg/osg-1.2/apache/lib:/opt/osg/osg-1.2/MonaLisa/Service/VDTFarm/pgsql/lib:/opt/osg/osg-1.2/glite/lib64:/opt/osg/osg-1.2/glite/lib:/opt/osg/osg-1.2/prima/lib:/opt/osg/osg-1.2/mysql5/lib/mysql:/opt/osg/osg-1.2/berkeley-db/lib:/opt/osg/osg-1.2/expat/lib:/opt/osg/osg-1.2/globus/lib::
PBS_O_HOME=/grid_home/uscmsPool018
ROCKS_ROOT=/opt/rocks
OSG_LOCATION=/opt/osg/osg-1.2
PBS_MOMPORT=15003
OSG_SITE_READ=UNAVAILABLE
PBS_O_QUEUE=default
GLOBUS_GRAM_MYJOB_CONTACT=URLx-nexus://ff-grid.unl.edu:34328/
MODULE_VERSION=3.2.7
MAIL=/var/spool/mail/uscmsPool018
PBS_O_LOGNAME=uscmsPool018
PATH=/usr/kerberos/bin:/usr/java/latest/bin:/bin:/usr/bin:/opt/ganglia/bin:/opt/ganglia/sbin:/opt/moab/bin:/opt/torque/bin:/opt/torque/sbin:/opt/rocks/bin:/opt/rocks/sbin
PBS_O_LANG=en_US
PBS_JOBCOOKIE=D741BA77BE0F4B8AA8AC64F23E128686
OSG_DATA=/panfs/panasas/CMS/data
INPUTRC=/etc/inputrc
PWD=/grid_home/uscmsPool018
OSG_APP=/panfs/panasas/CMS/app
JAVA_HOME=/usr/java/latest
PBS_NODENUM=0
LANG=en_US.iso885915
MODULEPATH=/panfs/panasas/opt/Modules/modulefiles
GRID3_TMP_DIR=/panfs/panasas/CMS/data
LOADEDMODULES=
PBS_O_SHELL=/bin/bash
OSG_GRID=/opt/osgwn1.2.4
PBS_SERVER=ff-grid.unl.edu
PBS_JOBID=2922034.ff-head.unl.edu
SSH_ASKPASS=/usr/libexec/openssh/gnome-ssh-askpass
ENVIRONMENT=BATCH
OSG_HOSTNAME=ff-grid.unl.edu
GRID3_SITE_NAME=Firefly
GRID3_APP_DIR=/panfs/panasas/CMS/app
SHLVL=3
HOME=/grid_home/uscmsPool018
OSG_STORAGE_ELEMENT=True
X509_USER_PROXY=/grid_home/uscmsPool018/.globus/job/ff-grid.unl.edu/12334.1279493508/x509_up
PBS_O_HOST=ff-grid.unl.edu
JBOSS_USER=jboss
PBS_VNODENUM=0
OSG_DEFAULT_SE=ff-se.unl.edu
LOGNAME=uscmsPool018
PBS_QUEUE=default
OSG_SITE_NAME=Firefly
MODULESHOME=/panfs/panasas/opt/Modules/3.2.7
LESSOPEN=|/usr/bin/lesspipe.sh %s
GRID3_BASE_DIR=/opt/osg/osg-1.2
GLOBUS_GRAM_JOB_CONTACT=https://ff-grid.unl.edu:54721/12334/1279493508/
G_BROKEN_FILENAMES=1
PBS_NODEFILE=/opt/torque/aux//2922034.ff-head.unl.edu
PBS_O_PATH=/opt/osg/osg-1.2/osg/bin:/opt/osg/osg-1.2/bwctl/bin:/opt/osg/osg-1.2/owamp/bin:/opt/osg/osg-1.2/npad/bin:/opt/osg/osg-1.2/ndt/bin:/opt/osg/osg-1.2/subversion/bin:/opt/osg/osg-1.2/apache/bin:/opt/osg/osg-1.2/dccp/bin:/opt/osg/osg-1.2/condor-cron/wrappers:/opt/osg/osg-1.2/srm-client-lbnl/bin:/opt/osg/osg-1.2/srm-client-fermi/sbin:/opt/osg/osg-1.2/srm-client-fermi/bin:/opt/osg/osg-1.2/gums/scripts:/opt/osg/osg-1.2/cert-scripts/bin:/opt/osg/osg-1.2/glite/sbin:/opt/osg/osg-1.2/glite/bin:/opt/osg/osg-1.2/edg/sbin:/opt/osg/osg-1.2/gip/bin:/opt/osg/osg-1.2/prima/bin:/opt/osg/osg-1.2/mysql5/bin:/opt/osg/osg-1.2/osg/bin:/opt/osg/osg-1.2/ant/bin:/opt/osg/osg-1.2/jdk1.5/bin:/opt/condor/sbin:/opt/condor/bin:/opt/osg/osg-1.2/wget/bin:/opt/osg/osg-1.2/logrotate/sbin:/opt/osg/osg-1.2/gpt/sbin:/opt/osg/osg-1.2/globus/bin:/opt/osg/osg-1.2/globus/sbin:/opt/pacman/pacman-3.28/bin:/opt/osg/osg-1.2/vdt/sbin:/opt/osg/osg-1.2/vdt/bin:/usr/kerberos/bin:/usr/local/bin:/bin:/usr/bin:/opt/osg/osg-1.2/osg/bin:/opt/osg/osg-1.2/bwctl/bin:/opt/osg/osg-1.2/owamp/bin:/opt/osg/osg-1.2/npad/bin:/opt/osg/osg-1.2/ndt/bin:/opt/osg/osg-1.2/subversion/bin:/opt/osg/osg-1.2/apache/bin:/opt/osg/osg-1.2/dccp/bin:/opt/osg/osg-1.2/condor-cron/wrappers:/opt/osg/osg-1.2/srm-client-lbnl/bin:/opt/osg/osg-1.2/srm-client-fermi/sbin:/opt/osg/osg-1.2/srm-client-fermi/bin:/opt/osg/osg-1.2/gums/scripts:/opt/osg/osg-1.2/cert-scripts/bin:/opt/osg/osg-1.2/glite/sbin:/opt/osg/osg-1.2/glite/bin:/opt/osg/osg-1.2/edg/sbin:/opt/osg/osg-1.2/gip/bin:/opt/osg/osg-1.2/prima/bin:/opt/osg/osg-1.2/mysql5/bin:/opt/osg/osg-1.2/osg/bin:/opt/osg/osg-1.2/ant/bin:/opt/osg/osg-1.2/jdk1.5/bin:/opt/condor/sbin:/opt/condor/bin:/opt/osg/osg-1.2/wget/bin:/opt/osg/osg-1.2/logrotate/sbin:/opt/osg/osg-1.2/gpt/sbin:/opt/osg/osg-1.2/globus/bin:/opt/osg/osg-1.2/globus/sbin:/opt/pacman/pacman-3.28/bin:/opt/osg/osg-1.2/vdt/sbin:/opt/osg/osg-1.2/vdt/bin:/usr/kerberos/bin:/usr/local/bin:/bin:/usr/bin:/sbin:/usr/sbin:/bin:/usr/bin
module=() {  eval `/panfs/panasas/opt/Modules/$MODULE_VERSION/bin/modulecmd bash $*`
}
_=/bin/env
%ENDTWISTY%
&lt;/pre&gt;

%NOTE% While OSG-EDU is a dedicated teaching cluster, Firefly is a production cluster.  It&#39;s quite possible you will spend some time in queue at Firefly and not OSG-EDU.  This is because you are an opportunistic user at Firefly, while the summer school &quot;owns&quot; OSG-EDU.  Queue time is often the price you pay for opportunistic access.

What kind of environment variables are available in the PBS site and Condor site?  What are the common ones?  In OSG jobs, you want to make sure you only utilize common environment variables.

---++ Staging a script
In the previous section, I showed a little trick for specifying multiple bash commands in a single invocation of =globus-job-run=.  This is a bit easier than running =globus-job-run= several times, but still would be annoying for a very large script.

Save the following script to a file named =mytest.sh= in your home directory:

&lt;pre class=&quot;file&quot;&gt;
#!/bin/bash
which voms-proxy-info
source $OSG_GRID/setup.sh
which voms-proxy-info
voms-proxy-info -all
hostname
env
$PWD
&lt;/pre&gt;

Mark it executable:
&lt;pre class=&quot;screen&quot;&gt;
%BLUE%chmod +x mytest.sh%ENDCOLOR%
&lt;/pre&gt;

Run it locally and see what happens.  If we want to run this script on the remote worker node, we can use the =-s= option to =globus-job-run= and transfer the script to the remote site:
&lt;pre class=&quot;screen&quot;&gt;
%BLUE%globus-job-run osg-edu.cs.wisc.edu:/jobmanager-condor -s mytest.sh%ENDCOLOR%
%TWISTY%
which: no voms-proxy-info in ((null))
/osg_nfs/wn-client/glite/bin/voms-proxy-info
subject   : /DC=org/DC=doegrids/OU=People/CN=Brian Bockelman 504307/CN=proxy/CN=limited proxy
issuer    : /DC=org/DC=doegrids/OU=People/CN=Brian Bockelman 504307/CN=proxy
identity  : /DC=org/DC=doegrids/OU=People/CN=Brian Bockelman 504307/CN=proxy
type      : limited proxy
strength  : 1024 bits
path      : /nfs/osgedu/.globus/job/osg-edu.cs.wisc.edu/13661.1279493833/x509_up
timeleft  : 11:47:43
=== VO osgedu extension information ===
VO        : osgedu
subject   : /DC=org/DC=doegrids/OU=People/CN=Brian Bockelman 504307
issuer    : /DC=org/DC=doegrids/OU=Services/CN=http/voms.grid.iu.edu
attribute : /osgedu/Role=NULL/Capability=NULL
timeleft  : 11:47:43
uri       : voms.grid.iu.edu:15003
miniosg-c02
MANPATH=/osg_nfs/wn-client/globus/man::/osg_nfs/wn-client/vdt/man:/osg_nfs/wn-client/perl/man:/osg_nfs/wn-client/expat/man:/osg_nfs/wn-client/logrotate/man:/osg_nfs/wn-client/wget/man:/osg_nfs/wn-client/jdk1.6/man:/osg_nfs/wn-client/curl/share/man:/osg_nfs/wn-client/glite/share/man:/osg_nfs/wn-client/lcg/man
GRID3_DATA_DIR=/nfs/osg-data
GRID3_TMP_WN_DIR=/tmp
PAC_ANCHOR=/osg_nfs/wn-client
OSG_GLEXEC_LOCATION=UNAVAILABLE
VOMS_USERCONF=/osg_nfs/wn-client/glite/etc/vomses
GLOBUS_PATH=/osg_nfs/wn-client/globus
GLOBUS_LOCATION=/osg_nfs/wn-client/globus
TMPDIR=/var/lib/condor/execute/dir_13166
PERL5LIB=/osg_nfs/wn-client/perl/lib/5.8.0:/osg_nfs/wn-client/perl/lib/5.8.0/i686-linux-thread-multi:/osg_nfs/wn-client/perl/lib/site_perl/5.8.0:/osg_nfs/wn-client/perl/lib/site_perl/5.8.0/i686-linux-thread-multi:/osg_nfs/wn-client/vdt/lib:
VDTSETUP_AGREE_TO_LICENSES=y
_CONDOR_SCRATCH_DIR=/var/lib/condor/execute/dir_13166
X509_CERT_DIR=/osg_nfs/wn-client/globus/TRUSTED_CA
OSG_WN_TMP=/tmp
ANT_HOME=/osg_nfs/wn-client/ant
VDTSETUP_GOOD_PLATFORM=1
GLITE_LOCATION_LOG=/osg_nfs/wn-client/glite/log
OSG_SQUID_LOCATION=UNAVAILABLE
OSG_JOB_CONTACT=osg-edu.cs.wisc.edu/jobmanager-condor
SRM_CONFIG=/osg_nfs/wn-client/srm-client-fermi/etc/config-2.xml
WARNING: Unable to verify signature! Server certificate possibly not installed.
Error: Cannot verify AC signature!
/nfs/osgedu/.globus/.gass_cache/local/md5/03/7bcdd94d772ef05bf300426d54c25a/md5/1c/45ad7ec4706fef4f181d2c1a86fe15/data: line 8: /nfs/osgedu: is a directory
OSG_SITE_WRITE=srm://osg-edu.cs.wisc.edu:10443/srm/v2/server
GLOBUS_ERROR_VERBOSE=true
TEMP=/var/lib/condor/execute/dir_13166
LD_LIBRARY_PATH=/osg_nfs/wn-client/lcg/lib64:/osg_nfs/wn-client/lcg/lib:/osg_nfs/wn-client/openldap/lib:/osg_nfs/wn-client/glite/lib64:/osg_nfs/wn-client/glite/lib:/osg_nfs/wn-client/curl/lib:/osg_nfs/wn-client/jdk1.6/jre/lib/i386:/osg_nfs/wn-client/jdk1.6/jre/lib/i386/server:/osg_nfs/wn-client/jdk1.6/jre/lib/i386/client:/osg_nfs/wn-client/globus/lib:/osg_nfs/wn-client/berkeley-db/lib:/osg_nfs/wn-client/expat/lib:/opt/osg-1.2/subversion/lib:/opt/osg-1.2/apache/lib:/opt/osg-1.2/MonaLisa/Service/VDTFarm/pgsql/lib:/opt/osg-1.2/prima/lib:/opt/osg-1.2/curl/lib:/opt/osg-1.2/glite/lib64:/opt/osg-1.2/glite/lib:/opt/osg-1.2/mysql5/lib/mysql:/opt/osg-1.2/jdk1.6/jre/lib/i386:/opt/osg-1.2/jdk1.6/jre/lib/i386/server:/opt/osg-1.2/jdk1.6/jre/lib/i386/client:/opt/osg-1.2/berkeley-db/lib:/opt/osg-1.2/expat/lib:/opt/osg-1.2/globus/lib:/opt/osg-1.2/subversion/lib:/opt/osg-1.2/apache/lib:/opt/osg-1.2/MonaLisa/Service/VDTFarm/pgsql/lib:/opt/osg-1.2/prima/lib:/opt/osg-1.2/curl/lib:/opt/osg-1.2/glite/lib64:/opt/osg-1.2/glite/lib:/opt/osg-1.2/mysql5/lib/mysql:/opt/osg-1.2/jdk1.6/jre/lib/i386:/opt/osg-1.2/jdk1.6/jre/lib/i386/server:/opt/osg-1.2/jdk1.6/jre/lib/i386/client:/opt/osg-1.2/berkeley-db/lib:/opt/osg-1.2/expat/lib:
GPT_LOCATION=/osg_nfs/wn-client/gpt
GLITE_LOCATION_TMP=/osg_nfs/wn-client/glite/tmp
OSG_LOCATION=/opt/osg-1.2
LIBPATH=/osg_nfs/wn-client/globus/lib:/usr/lib:/lib
OSG_SITE_READ=srm://osg-edu.cs.wisc.edu:10443/srm/v2/server
_CONDOR_ANCESTOR_3459=3462:1277400272:2753619200
GLOBUS_OPTIONS=-Xms256M -Xmx1024M
_CONDOR_ANCESTOR_3462=13166:1279493777:3344853834
GLOBUS_GRAM_MYJOB_CONTACT=URLx-nexus://osg-edu.cs.wisc.edu:38359/
X509_CADIR=/osg_nfs/wn-client/globus/TRUSTED_CA
PATH=/osg_nfs/wn-client/osg/bin:/osg_nfs/wn-client/lcg/bin:/osg_nfs/wn-client/glite/sbin:/osg_nfs/wn-client/glite/bin:/osg_nfs/wn-client/dccp/bin:/osg_nfs/wn-client/srm-client-lbnl/bin:/osg_nfs/wn-client/srm-client-fermi/sbin:/osg_nfs/wn-client/srm-client-fermi/bin:/osg_nfs/wn-client/curl/bin:/osg_nfs/wn-client/ant/bin:/osg_nfs/wn-client/jdk1.6/bin:/osg_nfs/wn-client/gpt/sbin:/osg_nfs/wn-client/globus/bin:/osg_nfs/wn-client/globus/sbin:/osg_nfs/wn-client/wget/bin:/osg_nfs/wn-client/logrotate/sbin:/opt/pacman/bin:/osg_nfs/wn-client/vdt/sbin:/osg_nfs/wn-client/vdt/bin:/usr/local/bin:/bin:/usr/bin
VDT_LOCATION=/osg_nfs/wn-client
OSG_DATA=/nfs/osg-data
PWD=/nfs/osgedu
OSG_APP=/nfs/osg-app
JAVA_HOME=/osg_nfs/wn-client/jdk1.6
_CONDOR_ANCESTOR_13166=13167:1279493777:2021418240
VOMS_LOCATION=/osg_nfs/wn-client/glite
SASL_PATH=/osg_nfs/wn-client/globus/lib/sasl
GRID3_TMP_DIR=/nfs/osg-data
_CONDOR_SLOT=1
CATALINA_OPTS=-Dorg.globus.wsrf.container.persistence.dir=/osg_nfs/wn-client/vdt-app-data/globus/persisted
OSG_GRID=/nfs/wn-client
OSG_HOSTNAME=osg-edu.cs.wisc.edu
GRID3_APP_DIR=/nfs/osg-app
GRID3_SITE_NAME=WISC-OSG-EDU
GLITE_LOCATION_VAR=/osg_nfs/wn-client/glite/var
SHLVL=1
HOME=/nfs/osgedu
_CONDOR_MACHINE_AD=/var/lib/condor/execute/dir_13166/.machine.ad
OSG_STORAGE_ELEMENT=True
X509_USER_PROXY=/nfs/osgedu/.globus/job/osg-edu.cs.wisc.edu/13661.1279493833/x509_up
DYLD_LIBRARY_PATH=/osg_nfs/wn-client/globus/lib
VDT_INSTALL_LOG=vdt-install.log
OSG_DEFAULT_SE=osg-edu.cs.wisc.edu
PYTHONPATH=/osg_nfs/wn-client/lcg/lib/python:
LOGNAME=osgedu
TMP=/var/lib/condor/execute/dir_13166
OSG_SITE_NAME=WISC-OSG-EDU
SHLIB_PATH=/osg_nfs/wn-client/globus/lib
_CONDOR_JOB_AD=/var/lib/condor/execute/dir_13166/.job.ad
VDT_POSTINSTALL_README=/osg_nfs/wn-client/post-install/README
GLITE_LOCATION=/osg_nfs/wn-client/glite
GLOBUS_GRAM_JOB_CONTACT=https://osg-edu.cs.wisc.edu:38358/13661/1279493833/
GRID3_BASE_DIR=/opt/osg-1.2
PEGASUS_HOME=/osg_nfs/wn-client/pegasus
PACMAN_LOCATION=/opt/pacman
_=/bin/env
%ENDTWISTY%
&lt;/pre&gt;

What do you think the effect of the line =source $OSG_GRID/setup.sh= was?

---+ Parting Words

We have examined some aspects of the synchronous tool, =globus-job-run=, to run simple jobs.  =globus-job-run= is a decent tool for debugging, but it has glaring drawbacks if you want run a high-throughput workflow of 1000 jobs.

Globus provides a few asynchronous tools, =globus-job-submit=, =globus-job-status=, =globus-job-cancel=, etc, which could be used for a larger-scale system.  However, they too suffer from drawbacks: the implementation is unscalable (you are limited to ~100 jobs per CE), and they are still too low-level for most end-users (one must write a software ecosystem around these basic blocks).

So, our conclusion is: never use =globus-*= tools for submitting anything except for debugging jobs.
