<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> UserSchool16Fri13ExecFlow &lt; Education &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Education/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Education/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Education/UserSchool16Fri13ExecFlow?_T=16 Feb 2017" type="application/x-wiki" title="edit UserSchool16Fri13ExecFlow" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Education/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Education/UserSchool16Fri13ExecFlow"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#D0D0D0;
	}
	.patternBookView {
		border-color:#D0D0D0;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">

@import url('/pub/Documentation/Tools/exercises.css ');

</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <style type="text/css">
pre em { font-style: normal; background-color: yellow; }
pre strong { font-style: normal; font-weight: bold; color: #008; }
</style>
<p />
<h1><a name="Friday_Exercise_1_3_Execute_a_Pr"></a> Friday Exercise 1.3: Execute a Production Workflow </h1>
<p />
In this exercise, you will: <ul>
<li> finish testing workflow steps, 
</li> <li> write the DAG for the workflow you planned, and 
</li> <li> submit this workflow on <code>learn.chtc.wisc.edu</code>
</li></ul> 
<p />
There are bonus tasks in <a href="https://www.opensciencegrid.org/bin/view/Education/UserSchool15Fri14BonusFlow" target="_top">Exercise 1.4</a>, if you get through this part quickly, including running the workflow on the Open Science Grid.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Steps_to_Take"></a> Steps to Take </span></h2>
<p />
Note: While one person in your group works on step 1, someone else can work on step 2.
<p />
<h3><a name="1_Finish_optimizing_job_componen"></a> 1. Finish optimizing job components </h3>
<p />
In the <a href="/bin/view/Education/UserSchool16Fri12PlanFlow" class="twikiLink">previous exercise</a> we ran some tests to find the optimal values for the <em>permutation</em> and <em>qtl</em> job steps.  Now we want to implement these values and confirm that they work.  The steps to take are as follows: 
<p /> <ol>
<li> Based on your previous tests, modify the <em>permutation</em> submit file for each trait according to:  <ul>
<li> the optimal number of <em>job processes</em> (how many jobs to <code>queue</code>)
</li> <li> number of permutations-per-process (one of the <code>arguments</code> to the <code>run_perm.R</code> script)
</li> <li> requests for memory and disk
</li></ul> 
</li> <li> Submit one of these newly modified <em>permutation</em> submit files in preparation for an optimized QTL test. If your estimate of the necessary permutations per process (for a ~30-minute run time) was not close enough, modify and test the <em>permutation</em> jobs again.
</li> <li> Once the <em>permutation</em> jobs complete successfully, finish preparing for an optimized QTL step by using <code>tarit.sh</code> to package the output from the test <em>permutation</em> step just above. Then run the <em>QTL</em> job. As above, you will only need to submit one of the QTL submit files to confirm the approximate memory and disk needed. Make sure all of the desired output files for the QTL step are created to confirm success.
</li> <li> Don't forget to test <code>taritall.sh</code> after a successful QTL job, to make sure it works as expected. <strong>After the optimized <em>permutation</em> and <em>QTL</em> tests, copy all output, error, and log files to a new directory to prepare for the production workflow.</strong>
</li></ol> 
<p />
<h3><a name="2_Create_a_DAG"></a> 2. Create a DAG </h3>
<p />
Write a single DAG file for the workflow, including: <ul>
<li> <code>JOB</code> lines for each submit file
</li> <li> <code>PARENT x CHILD y</code> lines as necessary
</li> <li> <code>SCRIPT PRE</code> and/or <code>SCRIPT POST</code> lines for the tar steps
</li></ul> 
<strong>Note:</strong> You may need to think about how each <code>tar</code> step works for deciding on "PRE" or "POST" scripts for each.
<p />
If you need a refresher on what a DAG looks like, see <a href="/bin/view/Education/UserSchool16Mon34CondorComplexDAG" class="twikiLink">this exercise from Monday</a> or the <a href="http://research.cs.wisc.edu/htcondor/manual/v8.5/2_10DAGMan_Applications.html" target="_top">HTCondor manual</a>
<p />
To <strong>quickly</strong> check that you've got the details of the DAG correct, modify your <em>permutation</em> submit files to run only a few processes, and with each process performing a much smaller number of permutations (say, ~10?).
<p />
<h3><a name="3_Run_a_production_workflow"></a> 3. Run a production workflow </h3>
<p />
Once you have run a quick test of the DAG and you know all the steps are working together, you can submit a full-scale run of the DAG!  To do so, <strong>modify the <em>permutation</em> submit files back to the values you chose when optimizing the <em>permutation</em> step</strong> (remember, this should be about 100,000 total permutations for each trait) and then submit the DAG. If you have any issues, consult the log and out files for the DAG and jobs, and modify your approach at any of the previous steps. While the full-scale DAG is running, you may wish to further detail your drawn workflow, including information regarding resource usage. Share all submit and DAG files with one another so everyone has a copy.
<p />
If you have time (even while step 3 is running smoothly), move on to the Bonus Tasks in <a href="/bin/view/Education/UserSchool16Fri14BonusFlow" class="twikiLink">Exercise 1.4</a></div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Education<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Education/OSGUserSchool2016" class="twikiLink">OSGUserSchool2016</a> &gt; <a href="/bin/view/Education/UserSchool16Materials" class="twikiLink">UserSchool16Materials</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>UserSchool16Fri13ExecFlow</span> <br />    
Topic revision: r4 - 29 Jul 2016 - 16:00:05 - <span class="twikiNewLink">IanRoss<a href="/bin/edit/Main/IanRoss?topicparent=Education.UserSchool16Fri13ExecFlow" rel="nofollow" title="IanRoss (this topic does not yet exist; you can create it)">?</a></span>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />