---+ Site Monitoring And WLCG
%TOC%

---++ Overview
Tier One and Tier Two sites are obliged to achieve a certain level of availability of their resources. To insure this pledge is satisfied
sites regularly report the status of their resources. The site operates a set of RSV probes that determine the state of various components
of their resources and use these states to determine the status of the resources. These probes report to a locally running &quot;consumer&quot; which
forwards the status results to a &quot;collector&quot; at the GOC. The GOC collector, in turn, forwards the results to WLCG where they are processed
into Availability and Reliability values. Reliability differs from Availability in that periods of registered downtime are not included in the calculation
of Reliability.
---++ Site responsibilities:
   * [[https://twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallRSV][Configure]] the critical RSV probes as appropriate for their site and resources. 
      * Compute element critical probes:
         * CACert expiry
         * GRAM authentication
         * OSG directory permissions
         * OSG version
         * Ping
      * Storage element critical probes:
         * SRMping
         * SRMCP Read / Write
   * Run the appropriate critical RSV probes and consumers against pledged resources.
   * Insure consumers are receiving metric data and forwarding it to the GOC
   * Register any scheduled [[https://oim.grid.iu.edu/oim/resourcedowntime][downtime]]
   * Verify their results are being calculated correctly by WLCG.

---++ GOC responsibilities:
   * Operate the RSV collector consistent with the [[https://twiki.grid.iu.edu/bin/view/Operations/RSVServiceLevelAgreement][SLA]].
   * Forward data received from sites to WLCG.
   * Operate the ticketing system consistent with the [[https://twiki.grid.iu.edu/bin/view/Operations/GOCTicketServiceLevelAgreement][SLA]].
   * Generate the [[http://rsv.grid.iu.edu/daily-reports/current/][WLCG/RSV comparison report]] daily, consistent with the [[https://twiki.grid.iu.edu/bin/view/Operations/RSVReportsServiceLevelAgreement][SLA]].
   * Operate OIM consistent with the [[https://twiki.grid.iu.edu/bin/view/Operations/OIMServiceLevelAgreement][SLA]]. (To allow downtime registration)

---++ WLCG responsibilities:
   * Receive metric data forwarded by the GOC
   * Calculate the site Availability/Reliability and publish the results on [[http://grid-monitoring.cern.ch/mywlcg/][MyWLCG]]
   * Prepare any reports required by !MoU.

---++ What if something goes wrong?
Typically, a problem is noticed when the WLCG and/or RSV status is not what the site administrator expects it to be.
The [[http://rsv.grid.iu.edu/daily-reports/current/][daily report]] gives an indication as to the location of the problem. 
It is strongly recommended that site administrators examine the report daily.

If the RSV data is incorrect or missing WLCG results are meaningless and the problem lies in one of two places:
The site is not reporting its status or is reporting it incorrectly and/or the GOC is not receiving or processing it correctly.
It is highly unlikely that the problem lies with the GOC, the collector operates at +99% Availability (last available calendar year).
The site administrator should examine his probes to determine all appropriate probes and consumers are running.
If it appears everything is working correctly at the site a [[https://ticket.grid.iu.edu/goc/submit][trouble ticket]] should be
created and GOC will assist in diagnosis of the problem. 

If the RSV
data is correct but the WLCG results are not the problem again lies in one of two areas: The data was not transported from the GOC
to WLCG or WLCG did not correctly process the data. GOC can assist in determining which of these cases has ocurred.
Create a [[https://ticket.grid.iu.edu/goc/submit][trouble ticket]] and the GOC will either fix the problem or forward the ticket to the 
appropriate parties. It is also possible that the site is incorrectly configured in OIM compared to the expectations of the WLCG.
This will be diagnosed by WLCG staff and GOC can assist in correcting the configuration.

---++ Questions / Issues
[[Interoperability.SiteMonitoringInteropQuestionsAndIssues][Site Monitoring Interop Questions And Issues]]

-- Main.ScottTeige - 29 May 2013
