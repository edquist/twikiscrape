<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> UserSchool16Thu42ouput &lt; Education &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Education/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Education/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Education/UserSchool16Thu42ouput?_T=16 Feb 2017" type="application/x-wiki" title="edit UserSchool16Thu42ouput" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Education/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Education/UserSchool16Thu42ouput"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#D0D0D0;
	}
	.patternBookView {
		border-color:#D0D0D0;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">

@import url('/pub/Documentation/Tools/exercises.css ');

</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <h1><a name="Thursday_Exercise_4_2_Large_Outp"></a> Thursday Exercise 4.2: Large Output Data </h1>
<p />
In this exercise, we will run a job that produces a very large output file, based on a few parameters. This exercise should take 15-20 minutes.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Background"></a> Background </span></h2>
<p />
This exercise will be the reverse of the previous exercise!  Instead of large input/small output, we will be using a program that has no input except for a few arguments on the command line, but produces a file that is several GB in size.  As before, we will need to write a shell script that runs the program and handles the data.  
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="The_Program"></a> The Program </span></h2>
<p />
If you haven't already, log in to <code>learn.chtc.wisc.edu</code>.  Download the software package and untar it.  
<pre class="screen">
$> <strong>wget http://proxy.chtc.wisc.edu/SQUID/osgschool16/motif-flanks.tar.gz</strong>
$> <strong>tar -xzf motif-flanks.tar.gz</strong>
</pre>
<p />
Use the <code>cd</code> command to enter the unpacked <code>motif-flanks</code> directory.  Take a look at the README file and then do the following:  <ol>
<li> Compile the code.
</li> <li> Run the program without any arguments. 
</li> <li> Based on the README, what is the largest amount of data we might expect?  
</li></ol> 
<p />
This program generates all permutations of nucleotide sequences surrounding a given DNA motif.  We can choose the length of permutation we want both before and after a motif of our choice.  To use this program on the command line and save the output to a FASTA file, we can use the command: 
<pre class="screen">
$> <strong>./motif-flanks 2 AGTTCATGCCT 2 > sequences.fa</strong>
</pre>
<p />
According to the usage information and README, the two numerical arguments can add up to 13, at most, and the middle sequence can be any DNA sequence up to 20 characters.  The largest output we can expect is around 4 GB.  
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Test_Job"></a> Test Job </span></h2>
<p />
Having output of up to 4 GB means two things: we will want to run a smaller test before we run the program at its peak, and the output data will need to go into a shared location like Gluster, instead of returning to the submit server.   
<p />
First, we'll create a shell script to serve as the job's executable.  
<p /> <ol>
<li> What commands do you need to put in the script? What do you need to do with the <code>sequences.fa</code> file before the job exits?  
</li> <li> Our script needs to run the <code>motif-flanks</code> command as shown above, redirecting the output to a file called <code>sequences.fa</code>.  Then, after that command completes, the <code>sequences.fa</code> file should be moved to your Gluster directory, as it is too large to return to the submit server as usual. 
</li> <li> Write the script and then check it against the script below. Yours might look slightly different.   <pre class="file">
#!/bin/sh

./motif-flanks 4 GATTTTCGATC 4 > sequences.fa
mv sequences.fa /mnt/gluster/<font color="#ff0000">username</font>/
</pre>
</li> <li> Note that the two arguments in the script (4 and 4) are much smaller than the total possible for the software (two values that add up to 13).  This is because we want to run a smaller test before submitting a job with the largest possible combination of arguments.  
</li></ol> 
<p />
Next, create a submit file for this job, based on other submit files from the school.  Some important considerations:  <ol>
<li> We're writing our file to the job's working directory, so make sure to request several GB of disk space.
</li> <li> Add a line to the file that ensures your job will land on computers that have access to Gluster (see the file from the <a href="/bin/view/Education/UserSchool16Thu41input" class="twikiLink">last exercise</a>).
</li> <li> The <code>executable</code> will be the script you wrote above.  
</li></ol> 
<p />
Once you have a submit file that does all these things, submit the test job. 
<p />
Once the job has completed, do the following:  <ol>
<li> Check the directory where you submitted the job.  Has the <code>sequences.fa</code> file returned there, accidentally?
</li> <li> Check your Gluster directory.  Did the <code>sequences.fa</code> file get copied there successfully?  
</li> <li> Check file size.  How big is the <code>sequences.fa</code> file?  You can use the <code>ls -lh</code> command with the filename to find out.  
</li></ol> 
<p />
If your job successfully copied the <code>sequences.fa</code> file to Gluster and did <strong>not</strong> return it to your submission directory on the submit server, congratulations!  Everything is working as it should and you can now submit a full job.  
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Final_Job"></a> Final Job </span></h2>
<p />
Having done a test, it should be straightforward to run a "full scale" job.  Edit your <code>run_motif.sh</code> executable so that the <code>motif-flanks</code> command uses larger numerical arguments: 
<pre class="file">
./motif-flanks 6 GATTTTCGATC 7 > sequences.fa
</pre>
<p />
Then submit your job.  When it completes, check the size of the output file in Gluster.  </div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Education<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Education/OSGUserSchool2016" class="twikiLink">OSGUserSchool2016</a> &gt; <a href="/bin/view/Education/UserSchool16Materials" class="twikiLink">UserSchool16Materials</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>UserSchool16Thu42ouput</span> <br />    
Topic revision: r5 - 26 Jul 2016 - 20:14:50 - <a href="/bin/view/Main/ChristinaKoch" class="twikiLink">ChristinaKoch</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />