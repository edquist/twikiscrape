<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> OSGSS2011CondorBLAST &lt; Education &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Education/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Education/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Education/OSGSS2011CondorBLAST?_T=16 Feb 2017" type="application/x-wiki" title="edit OSGSS2011CondorBLAST" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Education/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Education/OSGSS2011CondorBLAST"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#D0D0D0;
	}
	.patternBookView {
		border-color:#D0D0D0;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">

@import url('/pub/Documentation/Tools/exercises.css ');

</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--TWISTYPLUGIN_TWISTY--><style type="text/css" media="all">
@import url("https://twiki.opensciencegrid.org/twiki/pub/TWiki/TwistyContrib/twist.css");
</style>
<script type='text/javascript' src='https://twiki.opensciencegrid.org/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js'></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikiPref.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TwistyContrib/twist.compressed.js"></script>
<script type="text/javascript">
// <![CDATA[
var styleText = '<style type="text/css" media="all">.twikiMakeVisible{display:inline;}.twikiMakeVisibleInline{display:inline;}.twikiMakeVisibleBlock{display:block;}.twikiMakeHidden{display:none;}</style>';
document.write(styleText);
// ]]>
</script>

<!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <h1><a name="Running_a_real_science_example_B"></a> Running a real science example: BLAST </h1>
<p />
<div style="margin-left: 1em; margin-right: 1em; border: 1px solid black; padding: 0.5em;">
<h3><a name="Objective_of_this_exercise"></a> Objective of this exercise </h3>
The objective of this exercise is to switch from our toy examples to running a real scientific application (BLAST).
</div>
<p />
For our final example, we're going to run a real scientific application, BLAST. 
<p />
<a href="http://blast.ncbi.nlm.nih.gov/Blast.cgi" target="_top">BLAST homepage</a><br>
<a href="http://en.wikipedia.org/wiki/BLAST" target="_top">BLAST Wikipedia entry</a>
<p />
I'll be honest with you. This tutorial is being written by a computer scientist (Alain Roy), not a biologist, so my understanding of BLAST is weak. Yet I think it's both illustrative and entertaining to run real science code instead of just toy examples. So let's work through it together. 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="What_is_BLAST"></a> What is BLAST? </span></h2>
<p />
The BLAST web site says:
<p />
<div style="margin-left: 1em; margin-right: 1em; background-color: #ffff66; border: 1px solid black; padding: 0.5em;">
The Basic Local Alignment Search Tool (BLAST) finds regions of local similarity between sequences. The program compares nucleotide or protein sequences to sequence databases and calculates the statistical significance of matches. BLAST can be used to infer functional and evolutionary relationships between sequences as well as help identify members of gene families. 
</div>
<p />
I'll try to interpret that for you. BLAST is a pretty cool tool, particularly now that scientists have found lots of DNA and protein sequences. Let's imagine that you're a biologist, and you're curious about some gene. You've located this gene in a yeast, and you want to know if it's also in a fly. Good question. Well, biologists have nifty ways of writing down gene and protein sequences--you've probably seen the 4-letters used to represent nucleotides in DNA: GCTA. You can also have similar equences of amino acids that make up proteins. If you have a transcription for a gene in yeast and you have the entire genome for the fly, you could just search. It's like searching for a string in a text file. Of course, it's more complicated than that. For one thing, biologists wonder if there is a <em>similar</em> sequence in the fly, not just an identical sequence. After all, things evolve. So BLAST is a tool for doing these searches.
<p />
Beyond this basic explanation, I can't tell you a whole lot more about it, because it gets a lot more complex than that and I'm not a biologist. If you're curious, check out the links above. Here's a short quote from the above Wikipedia page:
<p />
<div style="margin-left: 1em; margin-right: 1em; background-color: #ffff66; border: 1px solid black; padding: 0.5em;">
In bioinformatics, Basic Local Alignment Search Tool, or BLAST, is an algorithm  for comparing primary biological sequence information, such as the amino-acid  sequences of different proteins or the nucleotides  of DNA sequences. A BLAST search enables a researcher to compare a query sequence with a library or database  of sequences, and identify library sequences that resemble the query sequence above a certain threshold. For example, following the discovery of a previously unknown gene in the mouse, a scientist will typically perform a BLAST search of the human genome to see if humans carry a similar gene; BLAST will identify sequences in the human genome that resemble the mouse gene based on similarity of sequence. 
</div>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Deployment_and_execution_of_BLAS"></a> Deployment and execution of BLAST </span></h2>
<p />
Recall the discussion about deploying applications and data when we <a href="/bin/view/Education/OSGSS2011CondorR" class="twikiLink">introduced R</a>. The question was: should we deploy the application and data ourselves, or should we let a sysadmin do it? For R, we chose to deploy it ourselves, which was reasonable. For BLAST, we decided to pre-deploy it for you. We could have had you deploy it, but BLAST is a bit larger (the application is more than 300MB, and the databases are several gigabytes), and rather complex. So to run BLAST, you just need to be able to submit a simple script to Condor that will run BLAST, which is already pre-deployed.
<p />
Note that BLAST is pre-deployed in our cluster, but <font color="#ff0000">it's not accessible from =vdt-itb=</font>. It's only available from the worker nodes. We're not trying to make things hard for you, there were just some technical complications. <em>You should not log into the worker nodes, but instead you'll be using Condor jobs to run BLAST.</em>
<p />
To run BLAST, if you're comfortable with writing shell scripts, I'd like you try to write a shell script to invoke it yourself. If you're not comfortable, you can look at mine below. 
<p />
BLAST itself is located in <code>/nfs/osg-app/osgedu/blast/</code> <br>
We have a few BLAST databases, located in <code>/nfs/osg-data/osgedu/blast_dbs</code>
<p />
To run BLAST, you need to do two things from your script:
<p /> <ol>
<li> Run blast (executable name is <code>/nfs/osg-app/osgedu/blast/bin/blastp</code>) with two parameters <ol>
<li> -db /full/path/to/database (where "database" is <code>yeast.aa</code> or <code>drosoph.aa</code> or <code>nr</code>)
</li> <li> -query /full/path/to/some/query/file (I'll give you some queries, don't worry)
</li></ol> 
</li> <li> Redirect standard output into a file, so you conveniently name the output of your program. 
</li></ol> 
<p />
So an example invocation of blast (step 2) might be:
<pre style="margin-left:4em" class="screen">
/nfs/osg-app/osgedu/blast/bin/blastp -db /nfs/osg-data/osgedu/blast_dbs/yeast.aa -query query1
</pre>
<p />
Again, this is what your script will do--you won't be able to directly invoke it. 
<p />
Here is my script, if you need to see it: <div class="twistyPlugin twikiMakeVisibleInline">  <span id="twistyIdEducationOSGSS2011CondorBLAST1show" class="twistyTrigger twikiUnvisited twistyHidden twistyInited"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleopen-small.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Click here to just take Alain's run-blast script...</span></a> </span> <span id="twistyIdEducationOSGSS2011CondorBLAST1hide" class="twistyTrigger twikiUnvisited twistyHidden twistyInited"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleclose-small.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Hide Alain's run-blast script...</span></a> </span>  </div><!--/twistyPlugin twikiMakeVisibleInline--> <div class="twistyPlugin"><div id="twistyIdEducationOSGSS2011CondorBLAST1toggle" class="twistyContent twikiMakeHidden twistyInited">
<p />
<pre style="margin-left:4em" class="screen">
#!/bin/sh

if [ $# -ne 3 ]; then
    echo "Usage: run-blast &lt;db> &lt;query> &lt;output>"
    exit 1
fi

appdir=/nfs/osg-app/osgedu/blast/bin
dbdir=/nfs/osg-data/osgedu/blast_dbs

# Run the query
$appdir/blastp -db $dbdir/$1 -query $2  > $3
</pre>
</div></div> <!--/twistyPlugin-->
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="First_job_run_a_sample_query"></a> First job: run a sample query </span></h2>
<p />
A query looks like the following, which you can put into a file named <code>query1</code>
<p />
<pre style="margin-left:4em" class="screen">
>Simple yeast query
MPVSDSGFDNSSKTMKDDTIPTEDYEEITKESEMGDATKITSKIDANVIEKKDTDSENNITIAQDDEKVSWLQRVVEFFE
</pre>
<p />
There are two things there: the name of the query, and the stuff to search for. This particular query is looking for a sequences of amino acids in proteins. (That's why there are more than four letters, like the familiar nucleotides in DNA.) If you're curious what the letters mean, you can <a href="http://en.wikipedia.org/wiki/FASTA_format#Sequence_representation" target="_top">read about it in Wikipedia</a>.
<p />
OK, your first task is to run a Condor job to execute that query against the <code>yeast.aa</code> database. The job itself should execute quickly (about a second, once the job starts running). 
<p />
The output will look something like this, but longer. (I chopped it short.)
<p />
<pre style="margin-left:4em" class="screen">
BLASTP 2.2.23+

Reference: Stephen F. Altschul, Thomas L. Madden, Alejandro A.
Schaffer, Jinghui Zhang, Zheng Zhang, Webb Miller, and David J.
Lipman (1997), "Gapped BLAST and PSI-BLAST: a new generation of
protein database search programs", Nucleic Acids Res. 25:3389-3402.

Reference for composition-based statistics: Alejandro A. Schaffer,
L. Aravind, Thomas L. Madden, Sergei Shavirin, John L. Spouge, Yuri
I. Wolf, Eugene V. Koonin, and Stephen F. Altschul (2001),
"Improving the accuracy of PSI-BLAST protein database searches with
composition-based statistics and other refinements", Nucleic Acids
Res. 29:2994-3005.

Database: yeast.aa
           6,298 sequences; 2,974,038 total letters

Query=  Simple yeast query
Length=80
                                                                      Score     E
Sequences producing significant alignments:                          (Bits)  Value

ref|NP_009511.1|  uridine permease; Fui1p                              170    4e-44
ref|NP_012677.1|  dolichyl phosphate-D-mannose:protein O-D-mannos...  23.9    4.6  
ref|NP_015305.1|  Smt3-processing enzyme; Ulp1p                       23.9    4.8  
ref|NP_011691.1|  Squalene monooxygenase; Erg1p                       23.9    5.1  
ref|NP_009545.1|  putative repressor protein homologous to yeast ...  23.1    7.3  

>ref|NP_009511.1| uridine permease; Fui1p
Length=639

 Score =  170 bits (430),  Expect = 4e-44, Method: Composition-based stats.
<font color="#ff0000"> Identities = 80/80 (100%), Positives = 80/80 (100%), Gaps = 0/80 (0%)</font>
</pre>
<p />
See that 100% positives? You got a perfect match. No surprise--I copied that sequence right out of the database. 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="On_your_own"></a> On your own </span></h2>
<p />
<h3><a name="A_small_change"></a> A small change </h3>
Change the query by swapping the last two letters. (It will end in EF instead of FE). How does it change the results?
<p />
<h3><a name="A_different_database"></a> A different database </h3>
Run the same query, but against the <code>nr</code> database. You should notice that instead of being a very fast query (less than a second), it should take a few minutes. The nr database is a collection of protein sequence databases and it's quite large. A larger database means a longer run time. You should have similar results  to the earlier query because the yeast protein sequences are also in the nr database. 
<p />
<h3><a name="A_larger_set_of_queries"></a> A larger set of queries </h3>
<p />
We have ten query files for you. You should run them all against the nr database. 
<p />
Let's make it a bit more interesting though: the BLAST output is rather verbose. I've written a script to summarize the BLAST output. It's probably not scientifically interesting, but it trims the output quite a bit and stills gives you an interesting part of it. 
<p />
You should run these ten queries as a DAG. There are ten queries that run first, then the last summarization step runs after all the other DAG nodes complete. 
<p />
Query files: <a href="https://twiki.opensciencegrid.org/twiki/pub/Education/OSGSS2011CondorBLAST/query1" target="_top">query1</a>, <a href="https://twiki.opensciencegrid.org/twiki/pub/Education/OSGSS2011CondorBLAST/query2" target="_top">query2</a>, <a href="https://twiki.opensciencegrid.org/twiki/pub/Education/OSGSS2011CondorBLAST/query3" target="_top">query3</a>, <a href="https://twiki.opensciencegrid.org/twiki/pub/Education/OSGSS2011CondorBLAST/query4" target="_top">query4</a>, <a href="https://twiki.opensciencegrid.org/twiki/pub/Education/OSGSS2011CondorBLAST/query5" target="_top">query5</a>, <a href="https://twiki.opensciencegrid.org/twiki/pub/Education/OSGSS2011CondorBLAST/query6" target="_top">query6</a>, <a href="https://twiki.opensciencegrid.org/twiki/pub/Education/OSGSS2011CondorBLAST/query7" target="_top">query7</a>, <a href="https://twiki.opensciencegrid.org/twiki/pub/Education/OSGSS2011CondorBLAST/query8" target="_top">query8</a>, <a href="https://twiki.opensciencegrid.org/twiki/pub/Education/OSGSS2011CondorBLAST/query9" target="_top">query9</a>, <a href="https://twiki.opensciencegrid.org/twiki/pub/Education/OSGSS2011CondorBLAST/query10" target="_top">query10</a>
<p />
Summarization script: <a href="https://twiki.opensciencegrid.org/twiki/pub/Education/OSGSS2011CondorBLAST/blast-summarize" target="_top">blast-summarize</a>
<p />
You can also find these files in <code>/opt/blast-dag</code>, which is probably easier for you. (They're on this web site to save for the future.)</div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Education<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Education/GridWorkshops" class="twikiLink">GridWorkshops</a> &gt; <a href="/bin/view/Education/OSGSummerSchool2011" class="twikiLink">OSGSummerSchool2011</a> &gt; <a href="/bin/view/Education/OSGSS2011Materials" class="twikiLink">OSGSS2011Materials</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>OSGSS2011CondorBLAST</span> <br />    
Topic revision: r2 - 27 Jun 2011 - 14:44:27 - <span class="twikiNewLink">ScotKronenfeld<a href="/bin/edit/Education/ScotKronenfeld?topicparent=Education.OSGSS2011CondorBLAST" rel="nofollow" title="ScotKronenfeld (this topic does not yet exist; you can create it)">?</a></span>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />