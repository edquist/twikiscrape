<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> UserSchool15Thu40Chirp &lt; Education &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Education/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Education/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Education/UserSchool15Thu40Chirp?_T=16 Feb 2017" type="application/x-wiki" title="edit UserSchool15Thu40Chirp" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Education/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Education/UserSchool15Thu40Chirp"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#D0D0D0;
	}
	.patternBookView {
		border-color:#D0D0D0;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">

@import url('/pub/Documentation/Tools/exercises.css ');

</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <style type="text/css">
pre em { font-style: normal; background-color: yellow; }
pre strong { font-style: normal; font-weight: bold; color: #008; }
</style>
<p />
<h1><a name="Using_Chirp_to_transfer_output_f"></a> Using Chirp to transfer output from running jobs </h1>
<p />
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#Using_Chirp_to_transfer_output_f">  Using Chirp to transfer output from running jobs</a> <ul>
<li> <a href="?cover=print#Goals"> Goals</a>
</li> <li> <a href="?cover=print#Transferring_output_while_your_j"> Transferring output while your job is running</a>
</li> <li> <a href="?cover=print#Further_information"> Further information</a>
</li></ul> 
</li></ul> 
</div>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Goals"></a> Goals </span></h2>
<p /> <ul>
<li> This tutorial will show you how to get output from your application as it is running using Remote I/O tools. 
</li></ul> 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Transferring_output_while_your_j"></a> Transferring output while your job is running </span></h2>
The HTCondor file transfer mechanism transfers only transfer files when a job is completed or while it is being evicted.  Sometimes, it's useful to get files from a running job while it's still running (e.g. checkpoint files).  This part of the tutorial will show how to transfer files while your job is still running.
<p />
HTCondor integrates with a set of tools called <a href="http://www.cse.nd.edu/~ccl/software/parrot/" target="_top">Parrot and Chirp</a> that allows your job to transfer files back to the the submit node while the job is still running.  In order to do this, your submit files need to change slightly and you'll need to do a few more things in your job.  
<p /> <ol>
<li> First, you'll need to add the following to your submit file: <pre class="file">
+WantIOProxy = True
</pre>
</li> <li> Second, you'll need to transfer the <code>parrot_run</code>  binary with your file, you can do this by using a transfer_input_files command <pre class="file">
transfer_input_files = /usr/bin/parrot_run
</pre>
</li> <li> Finally, you'll need to make sure that you save your file at <code>/chirp/CONDOR/</code> followed by the path on the submit node where the file should go.  E.g., if you want the ouput file to go to <code>/stash/user/username/job1/test</code>, the path should be <code>/chirp/CONDOR/stash/user/username/job1/test</code>. 
</li></ol> 
<p />
<p />
Let's try creating a few files in a job and transfer them while the job is running:
<p /> <ol>
<li> First log in to the OSG Connect submit node (login.osgconnect.net)
</li> <li> Create a directory for this tutorial : <pre class="screen">
$> mkdir chirp_tutorial
$> cd chirp_tutorial
</pre>
</li> <li> Create a file named <code>job.sh</code> with the following: <pre class="file">
#!/bin/bash
echo "test1" > checkpoint_file
./parrot_run cp checkpoint_file $1/checkpoint_file1
sleep 30
echo "test2" > checkpoint_file
./parrot_run cp checkpoint_file $1/checkpoint_file2
sleep 30
echo "test3" > checkpoint_file
./parrot_run cp checkpoint_file $1/checkpoint_file3
rm checkpoint_file
</pre>    4. Make the file executable: <pre class="screen">
$> chmod 755 job.sh
</pre>
</li> <li> Create a submit file (<code>chirp.submit</code>) with the following: <pre class="file">
output        = job.out.$(Process)
error         = job.error.$(Process)
log           = job.log.$(Process)

universe = vanilla
executable = job.sh
transfer_input_files = /usr/bin/parrot_run
+WantIOProxy = True
arguments = /chirp/CONDOR/$ENV(PWD)
queue 1
</pre>
</li> <li> Submit the job: <pre class="screen">
$> condor_submit chirp.submit
</pre>
</li> <li> While your job is running, you should see files named <code>checkpoint_file1</code>, <code>checkpoint_file2</code>, and <code>checkpoint_file3</code> appear in your submit directory.
</li> <li> You can also run <code>cat</code> or view the files to verify that they contain the string <code>test1</code>, <code>test2</code>, or <code>test3</code> 
</li></ol> 
<p />
As an exercise, try modifying the submit file and script so that the checkpoint files are saved in <code>/stash/user/<font color="#ff0000">username</font>/checkpoints</code> where <font color="#ff0000">username</font> is replaced by your OSG Connect username.
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Further_information"></a> Further information </span></h2> <ul>
<li> <a href="https://htcondor-wiki.cs.wisc.edu/index.cgi/wiki?p=HowToChirpRemoteIo" target="_top">Using Condor with Parrot/Chirp</a>
</li> <li> <a href="http://research.cs.wisc.edu/htcondor/manual/v8.2/condor_chirp.html#65779" target="_top">Manual for condor_chirp</a>
</li></ul> </div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Education<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Education/OSGUserSchool2015" class="twikiLink">OSGUserSchool2015</a> &gt; <a href="/bin/view/Education/UserSchool15Materials" class="twikiLink">UserSchool15Materials</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>UserSchool15Thu40Chirp</span> <br />    
Topic revision: r5 - 30 Jul 2015 - 19:08:20 - <a href="/bin/view/Main/TimCartwright" class="twikiLink">TimCartwright</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />