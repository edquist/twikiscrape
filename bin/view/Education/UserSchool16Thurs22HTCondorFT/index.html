<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> UserSchool16Thurs22HTCondorFT &lt; Education &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Education/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Education/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Education/UserSchool16Thurs22HTCondorFT?_T=16 Feb 2017" type="application/x-wiki" title="edit UserSchool16Thurs22HTCondorFT" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Education/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Education/UserSchool16Thurs22HTCondorFT"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#D0D0D0;
	}
	.patternBookView {
		border-color:#D0D0D0;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">

@import url('/pub/Documentation/Tools/exercises.css ');

</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--TWISTYPLUGIN_TWISTY--><style type="text/css" media="all">
@import url("https://twiki.opensciencegrid.org/twiki/pub/TWiki/TwistyContrib/twist.css");
</style>
<script type='text/javascript' src='https://twiki.opensciencegrid.org/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js'></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikiPref.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TwistyContrib/twist.compressed.js"></script>
<script type="text/javascript">
// <![CDATA[
var styleText = '<style type="text/css" media="all">.twikiMakeVisible{display:inline;}.twikiMakeVisibleInline{display:inline;}.twikiMakeVisibleBlock{display:block;}.twikiMakeHidden{display:none;}</style>';
document.write(styleText);
// ]]>
</script>

<!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

<!--TABLEPLUGIN_twikiAttachmentsTable--><style type="text/css" media="all">
.tableSortIcon img {padding-left:.3em; vertical-align:text-bottom;}
.twikiTable#twikiAttachmentsTable td {border-style:solid none;}
.twikiTable#twikiAttachmentsTable th {border-style:solid none;}
.twikiTable#twikiAttachmentsTable td {vertical-align:middle;}
.twikiTable#twikiAttachmentsTable th {vertical-align:middle;}
.twikiTable#twikiAttachmentsTable td {vertical-align:top;}
.twikiTable#twikiAttachmentsTable th {background-color:#eceef2;}
.twikiTable#twikiAttachmentsTable th.twikiSortedCol {background-color:#e0e3e9;}
.twikiTable#twikiAttachmentsTable tr.twikiTableRowdataBg0 td {background-color:#ffffff;}
.twikiTable#twikiAttachmentsTable tr.twikiTableRowdataBg0 td.twikiSortedCol {background-color:#f2f3f6;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol0 {text-align:center;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol1 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol2 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol3 {text-align:right;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol4 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol5 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol6 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol7 {text-align:center;}
</style></head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <style type="text/css">
pre em { font-style: normal; background-color: yellow; }
pre strong { font-style: normal; font-weight: bold; color: #008; }
</style>
<p />
<h1><a name="File_Compression_and_Testing_Res"></a> File Compression and Testing Resource Requirements </h1>
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#File_Compression_and_Testing_Res"> File Compression and Testing Resource Requirements</a> <ul>
<li> <a href="?cover=print#Setup"> Setup</a> <ul>
<li> <a href="?cover=print#Review_HTCondor_File_Transfer"> Review: HTCondor File Transfer</a>
</li></ul> 
</li> <li> <a href="?cover=print#Start_with_a_test_submit_file"> Start with a test submit file</a> <ul>
<li> <a href="?cover=print#Implement_file_compression"> Implement file compression</a>
</li> <li> <a href="?cover=print#List_the_executable_and_input_fi"> List the executable and input files</a>
</li> <li> <a href="?cover=print#Predict_memory_and_disk_requests"> Predict memory and disk requests from your data</a>
</li></ul> 
</li> <li> <a href="?cover=print#Run_the_test_job"> Run the test job</a>
</li></ul> 
</li></ul> 
</div>
<p />
The objective of this exercise is to refresh yourself on HTCondor file transfer, to implement file compression, and to begin examining the memory and disk space used by your jobs in order to plan larger batches, which we'll tackle in later exercises today.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Setup"></a> Setup </span></h2>
<p /> <ul>
<li> Make sure you are still logged into <code>osg-learn.chtc.wisc.edu</code>
</li> <li> Make a directory for today's blast exercises named <code>thur-blast-data</code>, and change into it.
</li></ul> 
<p />
The executable we'll use in this exercise and later today is the same  <code><b>blastx</b></code> executable from yesterday's exercise 1.2.  Because we're going to end up using it many times, let's first copy the <code>ncbi-blast-2.4.0+</code> directory to your /home/user directory, so that it will always be accessible from the same location (rather than keeping multiple copies in your various exercise directories). In the location containing the <code>ncbi-blast-2.4.0+</code> directory from yesterday, run the following command:
<p />
<pre class="screen">
$> <strong>cp -r ncbi-blast-2.4.0+ ~</strong>
</pre>
<p />
You should now see the <code>ncbi-blast-2.4.0+</code> directory in your <code>/home/user</code> location (which was indicated with the "~" shortcut in the command above), and this directory will still contain the <code>=blastx</code> executable within the <code>bin</code> directory.
<p />
Also copy the data from yesterday into the <code>thur-blast-data</code> directory. You'll need the <code>mouse.fa</code> file and the <code>pdbaa</code> directory from yesterday's exercise, but you'll end up making a new submit file.
<p />
<h3><a name="Review_HTCondor_File_Transfer"></a> Review: HTCondor File Transfer </h3>
<p />
<center>
<img src="/twiki/pub/Education/UserSchool16Thurs22HTCondorFT/data_tranfer_1.jpg " alt="data_tranfer_1.jpg " width='400' height='150'/>
</center>
<p />
Recall that OSG does not have a shared filesystem! Instead, HTCondor <em>transfers</em> your executable and input files (listed with <code>transfer_input_files</code>) to a working directory on the execute node, regardless of how these files were arranged on the submit node.  In this exercise we'll use the same <code>blastx</code> example job that we used previously, but modify the submit file and test how much memory and disk space it uses on the execute node.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Start_with_a_test_submit_file"></a> Start with a test submit file </span></h2>
<p />
We've started a submit file for you, below, which you'll add to in the remaining steps. 
<p />
<pre class="file">
executable = 
transfer_input_files = 
output = test.out
error = test.error
log = test.log
request_memory = 
request_disk = 
request_cpus = 1
requirements = (OpSys == "LINUX")
queue
</pre>
<p />
<h3><a name="Implement_file_compression"></a> Implement file compression </h3>
<p />
In our first blast job from yesterday, the database files in the <code>pdbaa</code> directory were all transferred, as is, but we could instead transfer them as a single, compressed file using <code>tar</code>. For a second test job, let's compress our blast database files to send them to the submit node as a single <code>tar.gz</code> file, by following the below steps
<p />
1. Change into the <code>pdbaa</code> directory and compress the database files into a single file called <code>pdbaa_files.tar.gz</code> using the <code>tar</code> command. (NOTE: This file will be different from the <code>pdbaa.tar.gz</code> files you downloaded yesterday, because it will only contain the <code>pdbaa</code> files, and not the <code>pdbaa</code> directory, itself.)
<p />
A typical command for creating a tar file is:
<pre class="screen">
$> <strong>tar -cvzf [compressed filename] [list of files]</strong>
</pre> 
<p />
Move this file to the <code>thur-blast-data</code> directory.
<p />
2. Create a wrapper script that will first decompress the <code>pdbaa_files.tar.gz</code> file, and then run blast. 
<p />
Because this file will now be our submit file <code>executable</code>, we'll also end up transferring the <code>blastx</code> executable with <code>transfer_input_files</code> (without the <code>ncbi-blast-2.4.0+</code> directory that it is located in on the submit node). In the <code>thur-blast-data</code> directory, create a new file, called <code>blast_wrapper.sh</code>, with the following contents:
<pre class="file">
#!/bin/bash

tar xvzf pdbaa_files.tar.gz

./blastx -db pdbaa -query mouse.fa -out mouse.fa.result

rm pdbaa.*
</pre>
<p />
IMPORTANT: The last line removes the resulting database files that came from <code>pdbaa_files.tar.gz</code>, as these files would otherwise be copied back to the submit server as perceived output (because they're new files that HTCondor didn't transfer over as input).
<p />
<h3><a name="List_the_executable_and_input_fi"></a> List the executable and input files </h3>
Make sure to update the submit file with the following: <ul>
<li> Add the new <code>executable</code> (the wrapper script you created above)
</li> <li> List the <code>blastx</code> binary, the <code>pdbaa_files.tar.gz</code> file, and the input query file in <code>transfer_input_files</code>
</li></ul> 
<p />
HINT: Remember that <code>transfer_input_files</code> accepts a comma separated list of files, and that you need to list the full location of the <code>blastx</code> executable (<code>/home/user/ncbi-blast-2.4.0+/bin/blastx</code>). There will be no arguments, since the arguments to the <code>blastx</code> command are now captured in the wrapper script.
<p />
<h3><a name="Predict_memory_and_disk_requests"></a> Predict memory and disk requests from your data </h3>
Also, think about how much memory and disk to request for this job. It's good to start with values that are a little higher than you think a test job will need, but think about: <ul>
<li> how much memory <code>blastx</code> would use if it loaded all of the database files <em>and</em> the query input file into memory.
</li> <li> how much disk space will be necessary on the execute server for the executable, all input files, and all output files (hint: the log file only exists on the submit node).
</li> <li> whether you'd like to request some extra memory or disk space, just in case
</li></ul> 
<p />
Look at the <code>log</code> file for your <code>blastx</code> job from yesterday, and compare the memory and disk "Usage" to what you predicted from the files. Make sure to update the submit file with more accurate memory and disk requests (you may still want to request slightly more than the job actually used).
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Run_the_test_job"></a> Run the test job </span></h2>
<p />
Once you have finished editing the submit file, go ahead and submit the job. It should a few minutes to complete, and then you can check to make sure that no unwanted files (especially the <code>pdbaa</code> database files) were copied back at the end of the job.
<p />
Run a <code><b>du -sh</b></code> on the directory with this job's input. How does it compare to the directory from yesterday, and why?
<p />
When you've completed the above, continue with the next exercise.
<p />
<p />
-- <a href="/bin/view/Main/LaurenMichael" class="twikiLink">LaurenMichael</a> - 21 Jul 2016</div><!-- /patternTopic-->
<p />
<p />
<div class="twikinetRounded twikinetRoundedAttachments"><div class="rCRounded"><div class="rCTR"><div class="rCTL"></div><!--/rCTL--><div class="twikiAttachments">
<div class="twistyPlugin twikiMakeVisibleInline">  <span id="topicattachmentslistshow" class="twistyRememberSetting twistyTrigger twikiUnvisited twistyHidden twistyInited"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleopen.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Attachments</span></a> </span> <span id="topicattachmentslisthide" class="twistyRememberSetting twistyTrigger twikiUnvisited twistyHidden twistyInited"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleclose.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Attachments</span></a> </span>  </div><!--/twistyPlugin twikiMakeVisibleInline--> <div class="twistyPlugin"><div id="topicattachmentslisttoggle" class="twistyRememberSetting twistyContent twikiMakeHidden twistyInited">
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table summary="Topic attachments" cellspacing="0" id="twikiAttachmentsTable" cellpadding="0" class="twikiTable" rules="rows" border="1"><caption>Topic attachments</caption>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Education/UserSchool16Thurs22HTCondorFT?cover=print;sortcol=0;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">I</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol1"> <a rel="nofollow" href="/bin/view/Education/UserSchool16Thurs22HTCondorFT?cover=print;sortcol=1;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Attachment</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol2"> <a rel="nofollow" href="/bin/view/Education/UserSchool16Thurs22HTCondorFT?cover=print;sortcol=2;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Action</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol3"> <a rel="nofollow" href="/bin/view/Education/UserSchool16Thurs22HTCondorFT?cover=print;sortcol=3;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Size</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol4"> <a rel="nofollow" href="/bin/view/Education/UserSchool16Thurs22HTCondorFT?cover=print;sortcol=4;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Date</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol5"> <a rel="nofollow" href="/bin/view/Education/UserSchool16Thurs22HTCondorFT?cover=print;sortcol=5;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Who</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol6 twikiLastCol"> <a rel="nofollow" href="/bin/view/Education/UserSchool16Thurs22HTCondorFT?cover=print;sortcol=6;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Comment</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" align="center" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> <img width="16" alt="jpg" align="top" src="/twiki/pub/TWiki/TWikiDocGraphics/jpg.gif" height="16" border="0" /><span class="twikiHidden">jpg</span> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol1 twikiLast"> <a href="/twiki/pub/Education/UserSchool16Thurs22HTCondorFT/data_tranfer_1.jpg">data_tranfer_1.jpg</a> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol2 twikiLast"> <a href="/bin/attach/Education/UserSchool16Thurs22HTCondorFT?filename=data_tranfer_1.jpg;revInfo=1" title="change, update, previous revisions, move, delete..." rel="nofollow">manage</a> </td>
			<td bgcolor="#ffffff" align="right" valign="top" class="twikiTableCol3 twikiLast"> 23.7&nbsp;K </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol4 twikiLast"> <span class="twikiNoBreak">06 Jul 2016 - 15:50</span> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol5 twikiLast"> <a href="/bin/view/Main/DerekWeitzel" class="twikiLink">DerekWeitzel</a> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol6 twikiLastCol twikiLast"> &nbsp; </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
</div></div> <!--/twistyPlugin--></div><!--//twikiAttachments--></div><!--/rCTR--><div class="rCBR"><div class="rCBL"></div><!--/rCBL--></div><!--/rCBR--></div><!--/rCRounded--></div><!--/twikinetRounded--></div><!-- /patternContent-->
<hr />
This topic: Education<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Education/OSGUserSchool2016" class="twikiLink">OSGUserSchool2016</a> &gt; <a href="/bin/view/Education/UserSchool16Materials" class="twikiLink">UserSchool16Materials</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>UserSchool16Thurs22HTCondorFT</span> <br />    
Topic revision: r10 - 28 Jul 2016 - 19:01:13 - <a href="/bin/view/Main/LaurenMichael" class="twikiLink">LaurenMichael</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />