<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> GlideinWMSVOFrontendInstall &lt; Documentation &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Documentation/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Documentation/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Documentation/GlideinWMSVOFrontendInstall?_T=16 Feb 2017" type="application/x-wiki" title="edit GlideinWMSVOFrontendInstall" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Documentation/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Documentation/GlideinWMSVOFrontendInstall"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#FFFF99;
	}
	.patternBookView {
		border-color:#FFFF99;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <link rel="stylesheet" type="text/css" href="https://twiki.opensciencegrid.org/twiki/pub/Documentation/Tools/exercises.css">
<p />
<!-- This is the default OSG documentation template. Please modify it in -->
<!-- the sections indicated to create your topic.                        --> 
<p />
<!-- By default the title is the <span class="twikiNewLink">WikiWord<a href="/bin/edit/Documentation/WikiWord?topicparent=Documentation.GlideinWMSVOFrontendInstall" rel="nofollow" title="WikiWord (this topic does not yet exist; you can create it)">?</a></span> used to create this topic. If  -->
<!-- you want to modify it to something more meaningful, just replace    -->
<!-- <a href="/bin/view/Documentation/GlideinWMSVOFrontendInstall" class="twikiCurrentTopicLink twikiLink">GlideinWMSVOFrontendInstall</a> below with i.e "My Topic".                                  -->
<p />
<h1><a name="This_document_is_OBSOLETE_Please"></a>  This document is OBSOLETE! Please use/edit <a href="/bin/view/Documentation/Release3/InstallGlideinWMSFrontend" class="twikiLink">InstallGlideinWMSFrontend in Release3</a> </h1>
<p />
<h1><a name="GlideinWMS_VO_Frontend_Installat"></a> GlideinWMS VO Frontend Installation </h1>
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#About_This_Document"> About This Document</a>
</li> <li> <a href="?cover=print#Requirements"> Requirements</a>
</li> <li> <a href="?cover=print#Installation_Procedure"> Installation Procedure</a> <ul>
<li> <a href="?cover=print#Download_and_install_the_VO_Fron"> Download and install the VO Frontend RPM</a>
</li> <li> <a href="?cover=print#Configuring_the_Frontend"> Configuring the Frontend</a>
</li> <li> <a href="?cover=print#Configuring_Condor"> Configuring Condor</a>
</li> <li> <a href="?cover=print#Create_a_Condor_grid_map_file"> Create a Condor grid map file.</a>
</li> <li> <a href="?cover=print#Proxy_Configuration"> Proxy Configuration</a>
</li> <li> <a href="?cover=print#Reconfigure_and_verify_installat"> Reconfigure and verify installation</a>
</li></ul> 
</li> <li> <a href="?cover=print#Important_file_locations"> Important file locations</a>
</li></ul> 
</div>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="About_This_Document"></a> About This Document </span></h2>
<p />
This document describes how to install the Glidein Workflow Managment System (GlideinWMS) VO Frontend.  The VO Frontend is the minimum required software for a Virtual Organization to submit grid jobs using the GlideinWMS system.  This installation guide describes installation using the RPM prepared by the OSG.  
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Requirements"></a> Requirements </span></h2>
Non-Firewalled ports from 9618 to 9660 for both TCP connections and UDP packets.
<p />
<p />
Required software: <ul>
<li> <a href="https://twiki.grid.iu.edu/bin/view/ReleaseDocumentation/ClientInstallationGuide" target="_top">OSG Client</a> (Do no install condor with the client)
</li> <li> <a href="http://www.cs.wisc.edu/condor/downloads-v2/download.pl" target="_top">Condor RPM (Development series)</a>
</li> <li> <a href="http://sourceforge.net/projects/javascriptrrd/files/" target="_top">JavascriptRRD/Flot</a>.  RPM available <a href="http://t2.unl.edu/store/rpms/SL5/x86_64/javascriptrrd-0.5.0-2.noarch.rpm" target="_top">Here</a>
</li> <li> Available from add-on repos (Such as <a href="http://fedoraproject.org/wiki/EPEL" target="_top">EPEL</a>.  Repo <a href="http://fedoraproject.org/wiki/EPEL/FAQ#howtouse" target="_top">Install</a>): <ul>
<li> Apache httpd.  Install and enable:        <pre class="screen">
yum install httpd
chkconfig --add httpd
chkconfig httpd on</pre>
</li> <li> rrdtool-python.  Install:      <pre class="screen">
yum install rrdtool-python</pre>
</li></ul> 
</li></ul> 
<p />
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Installation_Procedure"></a> Installation Procedure </span></h2> <ol>
<li> Download and install the pre-requisite software
</li> <li> Download and install the VO Frontend RPM
</li> <li> Edit Frontend configuration options
</li> <li> Edit Condor configuration options
</li> <li> Create a Condor grid map file
</li> <li> Reconfigure and Start frontend
</li></ol> 
<p />
<p />
<h3><a name="Download_and_install_the_VO_Fron"></a> Download and install the VO Frontend RPM </h3>
<p />
The RPM is currently available from <a href="http://koji.hep.caltech.edu/public/packages/GlideinWMSFrontend/2.5.1/9/noarch/GlideinWMSFrontend-2.5.1-9.noarch.rpm" target="_top">the glideinWMS project</a>.  The source RPM is available at <a href="http://koji.hep.caltech.edu/public/packages/GlideinWMSFrontend/2.5.1/6/src/GlideinWMSFrontend-2.5.1-9.src.rpm" target="_top">the glideinWMS project</a> also.
<p /> <ol>
<li> Download/Install the RPM   <pre class="screen">
$ rpm -Uvh http://koji.hep.caltech.edu/public/packages/GlideinWMSFrontend/2.5.1/9/noarch/GlideinWMSFrontend-2.5.1-9.noarch.rpm</pre>
</li></ol> 
<p />
   If the install succeeded, then there will be no output from the command.
<p />
<p />
<p />
<h3><a name="Configuring_the_Frontend"></a> Configuring the Frontend </h3>
<p />
The configuration file is <code>/etc/gwms-frontend/frontend.xml</code>.  The next steps will describe each line that you will need to edit.  The portions to edit are highlighted in red font.
<p /> <ol>
<li> The VO you are affiliated with.   <pre class="file">
&lt;factory query_expr='((stringListMember("<font color="#ff0000">VO</font>", GLIDEIN_Supported_VOs)))'></pre>
</li> <li> The username that you are assigned from the factory (email <a href="mailto&#58;osg&#45;gfactory&#45;support&#64;physics&#46;ucsd&#46;edu">osg-gfactory-support&#64;physics.ucsd.edu</a>) (scroll right).   <pre class="file">
&lt;collector DN="/DC=org/DC=doegrids/OU=Services/CN=glidein-1.t2.ucsd.edu" comment="Define factory collector globally for simplicity" factory_identity="gfactory@glidein-1.t2.ucsd.edu" my_identity="<font color="#ff0000">username</font>@glidein-1.t2.ucsd.edu" node="glidein-1.t2.ucsd.edu"/>
   </pre>
</li> <li> The Schedd information.  The Cert DN is the DN specified in the GSI_DAEMON_PROXY or GSI_DAEMON_CERT when condor is configured.  A secondary schedd is optional.  You will need to delete the secondary schedd line if you are not using it.   <pre class="file">
&lt;schedds>
   &lt;schedd DN="<font color="#ff0000">Cert DN used by the schedd at fullname:</font>" fullname="<font color="#ff0000">Hostname of the schedd</font>"/>
   &lt;schedd DN="<font color="#ff0000">Cert DN used by the second Schedd at fullname:</font>" fullname="<font color="#ff0000">schedd name</font>@<font color="#ff0000">Hostname of second schedd</font>"/>
&lt;/schedds></pre>
</li> <li> The DN of the cert that the frontend will use to communicate with the factory and use to submit to the factory.   <pre class="file">
&lt;security classad_proxy="/tmp/x509up_u99" proxy_DN="<font color="#ff0000">DN of proxy owned by user nobody</font>" proxy_selection_plugin="ProxyAll" security_name="<font color="#ff0000">The security name, this is used by factory</font>" sym_key="aes_256_cbc"> </pre>
</li> <li> The hostname of the frontend.   <pre class="file">
&lt;stage base_dir="/usr/share/gwms-frontend/www/stage" use_symlink="True" web_base_url="http://<font color="#ff0000">hostname of frontend</font>/vofrontend/stage"/> </pre>
</li> <li> The hostname of the collectors.   <pre class="file">
&lt;collector DN="DN of main collector" node="<font color="#ff0000">hostname of collector</font>" secondary="False"/>
&lt;collector DN="DN of secondary collectors (usually same as DN in line above)" node="<font color="#ff0000">hostname of secondary collectors (usually same as hostname in line above)</font>:9620-9660" secondary="True"/>
</pre>
</li></ol> 
<p />
<h3><a name="Configuring_Condor"></a> Configuring Condor </h3>
In versions of Condor 7.4.4 and above, the condor configuration for the frontend is placed in <code>/etc/condor/config.d/00_frontend.config</code>.  If you have a version less than 7.4.4, a local condor configuration file is located at <code>/etc/condor/condor_config.local</code>.  Adding the following to the bottom of <code>condor_config.local</code> will pick up the GlideinWMS condor configuration.
<pre class="file">
LOCAL_CONFIG_DIR = /etc/condor/config.d</pre>
<p />
After configuring condor, be sure to restart condor:
<pre class="screen">
service condor restart</pre>
<p />
The lines you have to edit: <ol>
<li> Credentials of the machine.  You can either run using a proxy, or a service certificate.  It is recommended to use a service certificate, which uses the variables GSI_DAEMON_CERT and GSI_DAEMON_KEY.  The proxy and certificate files should be owned by user <code>condor</code>.   <pre class="file">
############################
# Credentials
############################
#GSI_DAEMON_PROXY = /tmp/x509up_u1349

# EDIT THESE VALUES
# If you ever decide to use a Certificate, see below
GSI_DAEMON_CERT = /etc/grid-security/glideincert.pem
GSI_DAEMON_KEY  = /etc/grid-security/glideinkey.pem </pre>
</li> <li> Location of the condor grid map (description in the next section)   <pre class="file">
#################################
# Where to find ID->uid mappings EDIT THIS
#################################
CERTIFICATE_MAPFILE=/opt/glidecondor/certs/condor_mapfile </pre>
</li> <li> Add the DN's for the certificates that your daemons will use.  Examples are placed below.   <pre class="file">
#####################################
# Add whitelist of condor daemon DNs EDIT THIS
#####################################
GSI_DAEMON_NAME=/DC=org/DC=doegrids/OU=People/CN=Derek Weitzel 285345,/DC=org/DC=doegrids/OU=People/CN=Derek Weitzel 285345/CN=993078166,/DC=org/DC=doegrids/OU=Services/CN=host/glidein.unl.edu,/DC=org/DC=doegrids/OU=Services/CN=glidein-1.t2.ucsd.edu </pre>
</li></ol> 
<p />
<p />
<h3><a name="Create_a_Condor_grid_map_file"></a> Create a Condor grid map file. </h3>
The condor grid map file is used for authentication between the glidein running on a remote worker node, and the local collector.  Condor uses the mapfile to map certificates to users on the local machine.  It is important that you map the DN's of: <ul>
<li> Each schedd that the frontend talks to
</li> <li> The DN that the frontend uses
</li></ul> 
<p />
Below is an example mapfile:
   <pre class="file">
GSI "^\/DC\=org\/DC\=doegrids\/OU\=People\/CN\=Derek\ Weitzel\ 285345$" frontend
GSI "^\/DC\=org\/DC\=doegrids\/OU\=Services\/CN\=host\/hcc\-grid\.unl\.edu$" dweitzel
GSI "^\/DC\=org\/DC\=doegrids\/OU\=Services\/CN\=host\/cpass\.unl\.edu$" dweitzel
GSI (.*) anonymous
FS (.*) \1 </pre>
<p />
<p />
<h3><a name="Proxy_Configuration"></a> Proxy Configuration </h3>
By default, the frontend will run as user <code>nobody</code>.  In order for the frontend to use the certificate for user <code>nobody</code>, it has to exist and be owned by the user <code>nobody</code>. <ol>
<li> Create the proxy   <pre class="screen">
user> $ voms-proxy-init -valid &lt;hours_valid> -voms &lt;vo> </pre>
</li> <li> Copy the proxy to the correct name   <pre class="screen">
user> $ cp /tmp/x509up_u`id -u` /tmp/x509up_u`id -u nobody` </pre>
</li> <li> Change ownership of the proxy   <pre class="screen">
root> $ chown nobody: /tmp/x509up_u`id -u nobody` </pre>
</li></ol> 
<p />
<p />
<h3><a name="Reconfigure_and_verify_installat"></a> Reconfigure and verify installation </h3>
In order to use the frontend, first you must reconfigure it.
<p />
<pre class="screen">
/etc/init.d/frontend_startup reconfig </pre>
<p />
After reconfiguring, you can start the frontend:
<pre class="screen">
/etc/init.d/frontend_startup start </pre>
<p />
<p />
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Important_file_locations"></a> Important file locations </span></h2>
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table1" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" align="center" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/GlideinWMSVOFrontendInstall?cover=print;sortcol=0;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">File Description</font></a> </th>
			<th bgcolor="#d8dde4" align="center" valign="top" class="twikiTableCol1 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/GlideinWMSVOFrontendInstall?cover=print;sortcol=1;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">File Location</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> Configuration file </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> /etc/gwms-frontend/frontend.xml </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> Logs </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> /var/log/gwms-frontend/ </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> Startup script </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> /etc/init.d/frontend_startup </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> Web Directory </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> /usr/share/gwms-frontend/www </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> Working Directory </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol twikiLast"> /usr/share/gwms-frontend/frontend-temp/ </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
<p />
<p />
-- <a href="/bin/view/Main/DerekWeitzel" class="twikiLink">DerekWeitzel</a> - 25 Jun 2010</div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Documentation<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Documentation/UsingTheGrid" class="twikiLink">UsingTheGrid</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>GlideinWMSVOFrontendInstall</span> <br />    
Topic revision: r30 - 19 Oct 2011 - 21:51:44 - <a href="/bin/view/Main/MarcoMambelli" class="twikiLink">MarcoMambelli</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />