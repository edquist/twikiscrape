<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> GlideinWMSGroups &lt; Documentation &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Documentation/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Documentation/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Documentation/GlideinWMSGroups?_T=16 Feb 2017" type="application/x-wiki" title="edit GlideinWMSGroups" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Documentation/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Documentation/GlideinWMSGroups"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#FFFF99;
	}
	.patternBookView {
		border-color:#FFFF99;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <link rel="stylesheet" type="text/css" href="https://twiki.opensciencegrid.org/twiki/pub/Documentation/Tools/exercises.css">
<p />
<!-- This is the default OSG documentation template. Please modify it in -->
<!-- the sections indicated to create your topic.                        --> 
<p />
<!-- By default the title is the <span class="twikiNewLink">WikiWord<a href="/bin/edit/Documentation/WikiWord?topicparent=Documentation.GlideinWMSGroups" rel="nofollow" title="WikiWord (this topic does not yet exist; you can create it)">?</a></span> used to create this topic. If  -->
<!-- you want to modify it to something more meaningful, just replace    -->
<!-- <a href="/bin/view/Documentation/GlideinWMSGroups" class="twikiCurrentTopicLink twikiLink">GlideinWMSGroups</a> below with i.e "My Topic".                                  -->
<p />
<h1><a name="GlideinWMS_VO_Frontend_Groups"></a> GlideinWMS VO Frontend Groups </h1>
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#Breakdown_of_VO_Frontend_Group"> Breakdown of VO Frontend Group</a>
</li> <li> <a href="?cover=print#Example_HTPC_Group"> Example HTPC Group</a>
</li></ul> 
</div>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Breakdown_of_VO_Frontend_Group"></a> Breakdown of VO Frontend Group </span></h2>
A group in the VO Frontend is a logical way to separate jobs in the frontend.  A group can choose a subset of jobs and subset of entry points in order to match jobs with special requirements to entry points that provide them.
<p />
<hr />
<pre class="file">
&#60;group name&#61;&#34;htpc&#34; enabled&#61;&#34;True&#34;&#62;
</pre>
Name of the group.
<p />
<hr />
<p />
<pre class="file">
   &#60;config&#62;
      &#60;idle&#95;glideins&#95;per&#95;entry max&#61;&#34;30&#34; reserve&#61;&#34;5&#34;/&#62;
      &#60;idle&#95;vms&#95;per&#95;entry curb&#61;&#34;5&#34; max&#61;&#34;100&#34;/&#62;
      &#60;running&#95;glideins&#95;per&#95;entry max&#61;&#34;10000&#34; relative&#95;to&#95;queue&#61;&#34;1.15&#34;/&#62;
   &#60;/config&#62;
</pre>
Configuration options for this frontend.  In this specific example <ul>
<li> The frontend will ask the factory to keep 30 glideins idle in the remote queue.
</li> <li> No idea about curb?
</li> <li> The frontend will ask the factory for a limit of 10000 running jobs at the resource, or idle queue * 1.15, which ever is smaller.
</li></ul> 
<p />
<hr />
<p />
<pre class="file">
      &#60;factory query&#95;expr&#61;&#39;((stringListMember(&#34;HCCHTPC&#34;, GLIDEIN&#95;Supported&#95;VOs)))&#39;&#62;
</pre>
Use this query expression when asking for entry points from the factory.
<p />
<hr />
<p />
<pre class="file">
         &#60;collectors&#62;
            &#60;collector DN&#61;&#34;/DC&#61;org/DC&#61;doegrids/OU&#61;Services/CN&#61;glidein-1.t2.ucsd.edu&#34; comment&#61;&#34;Define factory collector globally for simplicity&#34; factory&#95;identity&#61;&#34;gfactory&#64;glidein-1.t2.ucsd.edu&#34; my&#95;identity&#61;&#34;unlfe&#64;glidein-1.t2.ucsd.edu&#34; node&#61;&#34;glidein-1.t2.ucsd.edu&#34;/&#62;
         &#60;/collectors&#62;
</pre>
The glidein factory to talk to.  Normally this can be declared globally (as it is in the RPM), and therefore does not need to be here if already defined.
<p />
<hr />
<p />
<pre class="file">
      &#60;job query&#95;expr&#61;&#34;(RequiresWholeMachine&#61;?&#61;True)&#38;amp;&#38;amp;(JobUniverse&#61;&#61;5)&#38;amp;&#38;amp;(GLIDEIN&#95;Is&#95;Monitor &#61;!&#61; TRUE)&#38;amp;&#38;amp;(JOB&#95;Is&#95;Monitor &#61;!&#61; TRUE)&#34;&#62;
</pre>
This is the query expression send to the schedd to filter jobs.  imagine <code>condor_q -const &lt;query_expr&gt;</code>.  Notice we filter on a special attribute, <code>RequiresWholeMachine</code>.  This attribute needs to be in every HTPC job in order for the frontend to detect it is a HTPC job.  This can be added to the Condor job with the syntax:
<pre class="file">
universe = vanilla
...
<font color="#ff0000">+RequiresWholeMachine = True</font>
Requirements = CAN_RUN_WHOLE_MACHINE == TRUE
...
queue
</pre>
<p />
<hr />
<p />
<pre class="file">
         &#60;schedds&#62;
            &#60;schedd DN&#61;&#34;/DC&#61;org/DC&#61;doegrids/OU&#61;Services/CN&#61;host/glidein.unl.edu&#34; fullname&#61;&#34;glidein.unl.edu&#34;/&#62;
         &#60;/schedds&#62;
</pre>
This is a list (or in this case, only one) of schedds that will be queried to find HTPC jobs.
<p />
<hr />
<p />
<pre class="file">
   &#60;attrs&#62;
     &#60;attr name&#61;&#34;CAN&#95;RUN&#95;WHOLE&#95;MACHINE&#34; glidein&#95;publish&#61;&#34;True&#34; job&#95;publish&#61;&#34;False&#34; parameter&#61;&#34;True&#34; type&#61;&#34;expr&#34; value&#61;&#34;True&#34;/&#62;
     &#60;attr name&#61;&#34;GLIDECLIENT&#95;Group&#95;Start&#34; glidein&#95;publish&#61;&#34;True&#34; job&#95;publish&#61;&#34;False&#34; parameter&#61;&#34;True&#34; type&#61;&#34;string&#34; value&#61;&#34;TARGET.RequiresWholeMachine&#34;/&#62;
   &#60;/attrs&#62;
</pre>
This is a list of additionally attributes that will be published by the Glidein's Startd.  <code>GLIDECLIENT_Group_Start</code> is a special attribute in the GlideinWMS configuration, it will be appended to the START expression of the glidein.  In this case we make sure that only jobs that have the special attribute, <code>RequiresWholeMachine</code>, will run on this glidein.  Further, the startds will advertise <code>CAN_RUN_WHOLE_MACHINE</code> in their classads, enabling jobs require htpc slots:
<pre class="file">
universe = vanilla
...
+RequiresWholeMachine = True
Requirements = <font color="#ff0000">CAN_RUN_WHOLE_MACHINE == TRUE</font>
...
queue
</pre>
<p />
<hr />
<pre class="file">
   &#60;files&#62;
      &#60;file absfname&#61;&#34;/usr/share/gwms-frontend/glidein&#95;scripts/startd.sh&#34; after&#95;entry&#61;&#34;True&#34; const&#61;&#34;True&#34; executable&#61;&#34;True&#34; untar&#61;&#34;False&#34; wrapper&#61;&#34;False&#34;&#62;
         &#60;untar&#95;options cond&#95;attr&#61;&#34;TRUE&#34;/&#62;
      &#60;/file&#62;
   &#60;/files&#62;
</pre>
A list (or in this case, only one) of files that will be brought down at the start of the glidein.  It can be considered a verification script.  This file will be executed before the glidein reports to the frontend to run jobs.  If the script fails (exit status is not 0), the glidein will quickly exit.  Documentation on these scripts, including an API to add custom attributes to the startd, is on the <a href="http://www.uscms.org/SoftwareComputing/Grid/WMS/glideinWMS/doc.prd/factory/custom_scripts.html" target="_top">GlideinWMS website</a>.
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Example_HTPC_Group"></a> Example HTPC Group </span></h2>
Example group for HTPC at HCC.
<p />
<pre class="file">
&#60;group name&#61;&#34;htpc&#34; enabled&#61;&#34;True&#34;&#62;
   &#60;config&#62;
      &#60;idle&#95;glideins&#95;per&#95;entry max&#61;&#34;30&#34; reserve&#61;&#34;5&#34;/&#62;
      &#60;idle&#95;vms&#95;per&#95;entry curb&#61;&#34;5&#34; max&#61;&#34;100&#34;/&#62;
      &#60;running&#95;glideins&#95;per&#95;entry max&#61;&#34;10000&#34; relative&#95;to&#95;queue&#61;&#34;1.15&#34;/&#62;
   &#60;/config&#62;
   &#60;downtimes/&#62;
   &#60;match match&#95;expr&#61;&#34;True&#34;&#62;
      &#60;factory query&#95;expr&#61;&#39;((stringListMember(&#34;HCCHTPC&#34;, GLIDEIN&#95;Supported&#95;VOs)))&#39;&#62;
         &#60;match&#95;attrs&#62;
         &#60;/match&#95;attrs&#62;
         &#60;collectors&#62;
            &#60;collector DN&#61;&#34;/DC&#61;org/DC&#61;doegrids/OU&#61;Services/CN&#61;glidein-1.t2.ucsd.edu&#34; comment&#61;&#34;Define factory collector globally for simplicity&#34; factory&#95;identity&#61;&#34;gfactory&#64;glidein-1.t2.ucsd.edu&#34; my&#95;identity&#61;&#34;unlfe&#64;glidein-1.t2.ucsd.edu&#34; node&#61;&#34;glidein-1.t2.ucsd.edu&#34;/&#62;
         &#60;/collectors&#62;
      &#60;/factory&#62;
      &#60;job query&#95;expr&#61;&#34;(RequiresWholeMachine&#61;?&#61;True)&#38;amp;&#38;amp;(JobUniverse&#61;&#61;5)&#38;amp;&#38;amp;(GLIDEIN&#95;Is&#95;Monitor &#61;!&#61; TRUE)&#38;amp;&#38;amp;(JOB&#95;Is&#95;Monitor &#61;!&#61; TRUE)&#34;&#62;
         &#60;match&#95;attrs&#62;
         &#60;/match&#95;attrs&#62;
         &#60;schedds&#62;
            &#60;schedd DN&#61;&#34;/DC&#61;org/DC&#61;doegrids/OU&#61;Services/CN&#61;host/glidein.unl.edu&#34; fullname&#61;&#34;glidein.unl.edu&#34;/&#62;
         &#60;/schedds&#62;
      &#60;/job&#62;
   &#60;/match&#62;
   &#60;security&#62;
      &#60;proxies&#62;
      &#60;/proxies&#62;
   &#60;/security&#62;
   &#60;attrs&#62;
     &#60;attr name&#61;&#34;CAN&#95;RUN&#95;WHOLE&#95;MACHINE&#34; glidein&#95;publish&#61;&#34;True&#34; job&#95;publish&#61;&#34;False&#34; parameter&#61;&#34;True&#34; type&#61;&#34;expr&#34; value&#61;&#34;True&#34;/&#62;
     &#60;attr name&#61;&#34;GLIDECLIENT&#95;Group&#95;Start&#34; glidein&#95;publish&#61;&#34;True&#34; job&#95;publish&#61;&#34;False&#34; parameter&#61;&#34;True&#34; type&#61;&#34;string&#34; value&#61;&#34;TARGET.RequiresWholeMachine&#34;/&#62;
   &#60;/attrs&#62;
   &#60;files&#62;
      &#60;file absfname&#61;&#34;/usr/share/gwms-frontend/glidein&#95;scripts/startd.sh&#34; after&#95;entry&#61;&#34;True&#34; const&#61;&#34;True&#34; executable&#61;&#34;True&#34; untar&#61;&#34;False&#34; wrapper&#61;&#34;False&#34;&#62;
         &#60;untar&#95;options cond&#95;attr&#61;&#34;TRUE&#34;/&#62;
      &#60;/file&#62;
   &#60;/files&#62;
&#60;/group&#62;
</pre>
<p />
<p />
<p />
-- <a href="/bin/view/Main/DerekWeitzel" class="twikiLink">DerekWeitzel</a> - 24 Mar 2011</div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Documentation<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Documentation/UsingTheGrid" class="twikiLink">UsingTheGrid</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>GlideinWMSGroups</span> <br />    
Topic revision: r2 - 26 May 2011 - 15:20:46 - <a href="/bin/view/Main/DerekWeitzel" class="twikiLink">DerekWeitzel</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />