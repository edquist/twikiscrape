<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> InstallProbe &lt; Documentation/Release3 &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Documentation/Release3/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Documentation/Release3/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Documentation/Release3/InstallProbe?_T=16 Feb 2017" type="application/x-wiki" title="edit InstallProbe" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Documentation/Release3/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Documentation/Release3/InstallProbe"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#FFFFFF;
	}
	.patternBookView {
		border-color:#FFFFFF;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <h1><a name="Installing_and_testing_RSV_probe"></a>  Installing and testing RSV probes </h1>
<p />
This page contains information for how RSV probe developers can install their new probes into the RSV framework.
<p />
This page assumes you've already written an RSV probe.  See <a href="/bin/view/Documentation/Release3/WriteProbe" class="twikiLink">the guidelines for writing an RSV probe</a> or see <a href="/bin/view/Documentation/Release3/WriteYourOwnRSVProbe" class="twikiLink">the overall process info</a>.
<p />
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#How_to_install_probes"> How to install probes</a>
</li> <li> <a href="?cover=print#Make_metric_symlinks"> Make metric symlinks</a>
</li> <li> <a href="?cover=print#Meta_files"> Meta files</a> <ul>
<li> <a href="?cover=print#Settings_section"> Settings section</a>
</li> <li> <a href="?cover=print#Environment_section"> Environment section</a>
</li></ul> 
</li> <li> <a href="?cover=print#Conf_files"> Conf files</a>
</li></ul> 
</div>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="How_to_install_probes"></a> How to install probes </span></h2> <ol>
<li> Put probe in <code>/usr/libexec/rsv/probes</code> directory.  Remember that the probe filename must end with <code>-probe</code>
</li> <li> Put any helper scripts in the <code>/usr/libexec/rsv/probes/worker-scripts</code> directory
</li> <li> <a href="/bin/view/Documentation/Release3/InstallProbe#MetricSymlinks" class="twikiCurrentTopicLink twikiAnchorLink">Make metric symlinks</a>
</li> <li> <a href="/bin/view/Documentation/Release3/InstallProbe#ConfFiles" class="twikiCurrentTopicLink twikiAnchorLink">Create a .conf file</a>
</li> <li> <a href="/bin/view/Documentation/Release3/InstallProbe#MetaFiles" class="twikiCurrentTopicLink twikiAnchorLink">Create a .meta file</a>
</li></ol> 
<p />
<a name="MetricSymlinks"></a>
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Make_metric_symlinks"></a> Make metric symlinks </span></h2>
Make a symlink for each metric that the probe implements in <code>/usr/libexec/rsv/metrics</code> directory pointing at probe:
<pre class="rootscreen">
cd /usr/libexec/rsv/metrics
ln -s ../probes/my-probe-name org.osg.my.metric1
ln -s ../probes/my-probe-name org.osg.my.metric2
</pre>
<p />
To make sure that rsv-control can find your probe run <code>rsv-control --list --all</code> and you should see your metrics listed now.
<p />
<p />
<a name="MetaFiles"></a>
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Meta_files"></a> Meta files </span></h2>
<p />
Meta files are the default probe configuration.  The .meta file is not meant to be edited by end users (they will edit the .conf file, see below).  Meta files consist of two parts - a settings section and an environment section.  You should create a .meta file at <code>/etc/rsv/meta/metrics/org.osg.your.metric.meta</code>
<p />
Here's an example meta file, we'll break down the sections after the example.
<p />
<pre class="file">
[org.osg.general.osg-version]
default-cron-interval = 47 18 * * *

execute = grid
transfer-files = /usr/libexec/rsv/probes/RSVMetric.pm
service-type = OSG-CE
output-format = brief
enable-by-default = true
description = Report the version of the remote CE.

[org.osg.general.osg-version env]
# No environment definitions needed for this metric
</pre>
<p />
<h3><a name="Settings_section"></a> Settings section </h3>
Th settings section begins with the header <code>[org.osg.your.metric]</code>.  The information in this section replaces the information that used to be declared at the top of the RSV probes.  Here are the essential settings:
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table1" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallProbe?cover=print;sortcol=0;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Setting</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol1"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallProbe?cover=print;sortcol=1;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Example value</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol2 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallProbe?cover=print;sortcol=2;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Description</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> default-cron-interval </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> 27 * * * * </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> A cron time formatted string that represents when the metric will run.  We do not currently have a well defined method to determine when probes should run - talk to the VDT for help in determining this value </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> execute </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> local or grid </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol"> Set <code>local</code> if the metric should execute on the local machine and <code>grid</code> if the metric should execute on the remote CE. </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> service-type </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> OSG-CE </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> This categorizes the metric.  <code>OSG-CE</code> for CE metrics and <code>OSG-SRM</code> for storage metrics are the most common. </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> output-format </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> brief or wlcg </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol"> Set this based on the output you generate.  See <a href="/bin/view/Documentation/Release3/WriteProbe" class="twikiLink">here</a> for more info. </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> enable-by-default </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> true or false </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> All new probes should default to false until they have been tested. </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> need-proxy </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLast"> true or false </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol twikiLast"> If your probe requires a proxy set this to true, otherwise false.  Note that all execute=remote probes should set this to true </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
| description | <text> | A human-readable description of what this metric does.
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table2" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> transfer-files </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLast"> <List of files> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol twikiLast"> The set of accompanying files that should be transferred to the remote computer in addition to the probe.  This option is only needed for remote probes </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
<h3><a name="Environment_section"></a> Environment section </h3>
Most metrics will not need to define anything in this section.  However, if your metric relies on any specific environment variables being set to function, you can provide them here.  An example is for SRM probes, which might need SRM_HOME.
<p />
The environment section starts with the header <code>[org.osg.your.metric env]</code>.  This contains any specific environment settings your probe will need to run.  There are four actions you can take:
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table3" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallProbe?cover=print;sortcol=0;table=3;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Action Name</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol1 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/InstallProbe?cover=print;sortcol=1;table=3;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Action Action</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> SET </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> Set a variable in the environment </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> UNSET </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> Remove a variable from the environment </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> PREPEND </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> Prepend a path to an environment variable </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> APPEND </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol twikiLast"> Append a path to an environment variable </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
<a name="ConfFiles"></a>
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Conf_files"></a> Conf files </span></h2>
<p />
Configuration files are meant to be edited by a site admin.  You'll just be making a skeleton conf file for the admin to add to later.  More information on .conf files is available <a href="/bin/view/Documentation/Release3/ConfigureRsv#MetricConfig" class="twikiAnchorLink">here</a>.  
<p />
For each <strong>metric</strong> you implement add a file named <code>/etc/rsv/metrics/org.osg.your.metric.conf</code>.
<p />
For example, to implement the <code>org.osg.example.metric</code> metric, make a file named <code>org.osg.example.metric.conf</code> and make the first line of the file:
<pre class="file">
[org.osg.example.metric args]
</pre>
<p />
You probably don't need to put anything else in here, but if you have interesting options to your probe, you can put in commented out entries as a template for users to fill in.  Here's an example:
<pre class="file">
[org.osg.certificates.cacert-expiry args]
#cacerts-dir = 
#warning-hours = 
#error-hours = 
#type = 
#worker-script-file = 
#local-ce = 
</pre></div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Documentation/Release3<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Documentation/Release3/RsvOverview" class="twikiLink">RsvOverview</a> &gt; <a href="/bin/view/Documentation/Release3/WriteYourOwnRSVProbe" class="twikiLink">WriteYourOwnRSVProbe</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>InstallProbe</span> <br />    
Topic revision: r5 - 12 Feb 2013 - 22:21:08 - <a href="/bin/view/Main/MarcoMambelli" class="twikiLink">MarcoMambelli</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />