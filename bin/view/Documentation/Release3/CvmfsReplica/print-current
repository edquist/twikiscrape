<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> CvmfsReplica &lt; Documentation/Release3 &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Documentation/Release3/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Documentation/Release3/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Documentation/Release3/CvmfsReplica?_T=16 Feb 2017" type="application/x-wiki" title="edit CvmfsReplica" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Documentation/Release3/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Documentation/Release3/CvmfsReplica"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#FFFFFF;
	}
	.patternBookView {
		border-color:#FFFFFF;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--TWISTYPLUGIN_TWISTY--><style type="text/css" media="all">
@import url("https://twiki.opensciencegrid.org/twiki/pub/TWiki/TwistyContrib/twist.css");
</style>
<script type='text/javascript' src='https://twiki.opensciencegrid.org/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js'></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikiPref.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TwistyContrib/twist.compressed.js"></script>
<script type="text/javascript">
// <![CDATA[
var styleText = '<style type="text/css" media="all">.twikiMakeVisible{display:inline;}.twikiMakeVisibleInline{display:inline;}.twikiMakeVisibleBlock{display:block;}.twikiMakeHidden{display:none;}</style>';
document.write(styleText);
// ]]>
</script>

<!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

<!--TABLEPLUGIN_twikiAttachmentsTable--><style type="text/css" media="all">
.tableSortIcon img {padding-left:.3em; vertical-align:text-bottom;}
.twikiTable#twikiAttachmentsTable td {border-style:solid none;}
.twikiTable#twikiAttachmentsTable th {border-style:solid none;}
.twikiTable#twikiAttachmentsTable td {vertical-align:middle;}
.twikiTable#twikiAttachmentsTable th {vertical-align:middle;}
.twikiTable#twikiAttachmentsTable td {vertical-align:top;}
.twikiTable#twikiAttachmentsTable th {background-color:#eceef2;}
.twikiTable#twikiAttachmentsTable th.twikiSortedCol {background-color:#e0e3e9;}
.twikiTable#twikiAttachmentsTable tr.twikiTableRowdataBg0 td {background-color:#ffffff;}
.twikiTable#twikiAttachmentsTable tr.twikiTableRowdataBg0 td.twikiSortedCol {background-color:#f2f3f6;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol0 {text-align:center;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol1 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol2 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol3 {text-align:right;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol4 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol5 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol6 {text-align:left;}
.twikiTable#twikiAttachmentsTable td.twikiTableCol7 {text-align:center;}
</style></head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <strong>WARNING: THIS DOCUMENTATION IS WORK IN PROGRESS!!!</strong>
<p />
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;width:100%}
.tg td{font-family:Arial, sans-serif;font-size:12px;padding:5px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
.tg th{font-family:Arial, sans-serif;font-size:12px;font-weight:normal;padding:5px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
.tg .tg-raw31{font-weight:bold;color:#0055ff;text-align:left;width:20%}
.tg .tg-raw32{text-align:left;width:80%}
.tg .tg-header{font-weight:bold;background-color:#c0c0c0;text-align:center}
.tg .tg-splitheader{font-weight:bold;background-color:#e0e0e0;text-align:center}
</style>
<p />
<!-- some useful definitions  (need 3 white spaces before * to enable it) <ul>
<li> Set UCL_PROMPT_ROOT = [root@replica ~]$
</li> <li> Set VERSION = 0.9.4
</li></ul> 
IMPORTANT NOTE=  The version is actually set in the "Applicable versions" section. It is hardcoded there so it can be copied by other pages.
-->
<p />
<h1><a name="CvmfsReplica"></a> CvmfsReplica </h1>
<!--
<p />
-->
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#1_About_this_Document">1  About this Document</a>
</li> <li> <a href="?cover=print#2_Applicable_version">2  Applicable version</a>
</li> <li> <a href="?cover=print#3_Description">3  Description</a>
</li> <li> <a href="?cover=print#4_Source_code">4  Source code</a>
</li> <li> <a href="?cover=print#5_Download">5  Download</a>
</li> <li> <a href="?cover=print#6_Setup_and_configuration">6  Setup and configuration</a>
</li> <li> <a href="?cover=print#7_Run_the_service">7  Run the service</a> <ul>
<li> <a href="?cover=print#7_1_RHEL_6">7.1 RHEL 6</a>
</li> <li> <a href="?cover=print#7_2_RHEL_7">7.2 RHEL 7</a>
</li></ul> 
</li> <li> <a href="?cover=print#8_UML">8 UML</a>
</li></ul> 
</div>
<p />
<p />
<h1><a name="1_About_this_Document"></a> 1  About this Document </h1>
<p />
This document describes the cvmfsreplica daemon for CVMFS Stratum-1s.
<p />
on    
on    
<p />
<p />
<p />
<h1><a name="2_Applicable_version"></a> 2  Applicable version </h1>
<p />
This documentation applies to the latest version of cvmfsreplica: 0.9.4
<p />
<p />
<h1><a name="3_Description"></a> 3  Description </h1>
<p />
cvmfsreplica is a tool to handle the process to running snapshots on a CVMFS Stratum-1 host. 
It is meant to be more flexible and complete than a simple cron job. 
The behavior of cvmfsreplica is driven by its configuration files. Therefore, it is recommended to read carefully the <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/CvmfsReplicaReferenceManual" target="_top">reference manual</a> before starting the service. 
Each CVMFS repository is set separately in the configuration files. For each one of them, an internal thread will be created that loops uninterruptedly, triggering snapshot commands periodically. 
Besides triggering periodically a snapshot command, the service behavior can be modulated making use of the available plugins. 
<p />
<table class="tg">
  <tr>
    <th class="tg-header">plugin type</th>
    <th class="tg-header">description</th>
  </tr>
<p />
<tr>
    <td class="tg-raw31">Acceptance plugins</td>
    <td class="tg-raw32">
Acceptance plugins are used to decide, on every cycle, if the snapshot command should or not be attempted. 
None, one, or more than one acceptance plugins can be used. 
When they are used, the snapshot step is performed only if all of them passes successfully. 
Some acceptance plugin may also, when they don't pass, call a report plugin to notify the failure. 
Also, some acceptance plugin may stop that particular thread, so no more attempts will be performed for that particular repository. 
</td>
  </tr>
<tr>
    <td class="tg-raw31">Report plugins</td>
    <td class="tg-raw32">
The Report plugins are meant to notify the relevant events during the replication process, mostly when something does not work as expected. 
 </td>
 </tr>
<tr>
    <td class="tg-raw31">Post plugins</td>
    <td class="tg-raw32">
The Post plugins perform actions after the snapshot have been attempted, either successfully or not. 
</td>
 </tr>
</table>
<p />
Detailed description of the plugins and their configuration can be found in the <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/CvmfsReplicaReferenceManual" target="_top">reference manual</a>
<p />
<p />
<h1><a name="4_Source_code"></a> 4  Source code </h1>
cvmfsreplica it is written in python.
Code can be found <a href="http://github.com/jose-caballero/cvmfsreplica" target="_top">here</a>
<p />
<h1><a name="5_Download"></a> 5  Download </h1>
<p />
<strong>WARNING: this is temporary until the RPMs are distributed from CERN</strong>
<p />
<pre class="rootscreen">
[root@replica ~]$ rpm -Uhv  http://repo.grid.iu.edu/osg/3.3/el6/development/x86_64/cvmfsreplica-0.9.4-1.noarch.rpm
</pre>
<p />
<h1><a name="6_Setup_and_configuration"></a> 6  Setup and configuration </h1>
<p />
The cvmfsreplica daemon works on top of an existing, properly configured, CVMFS Stratum-1. 
Documentation on how to setup and run a CVMFS Stratum-1, or replica server, can be found <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/InstallCvmfsStratum1" target="_top">here</a>, 
and also in the <a href="https://cvmfs.readthedocs.io/en/latest/cpt-replica.html" target="_top">official CVMFS documentation</a>
<p />
The details on how to setup and configure the cvmfsreplica are explained in the <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/CvmfsReplicaReferenceManual" target="_top">reference manual</a>
<p />
<h1><a name="7_Run_the_service"></a> 7  Run the service </h1>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="7_1_RHEL_6"></a> 7.1  RHEL 6 </span></h2>
<p />
To start the service:
<pre class="rootscreen">
[root@replica ~]$ service start cvmfsreplica
</pre>
<p />
<p />
To restart the service:
<pre class="rootscreen">
[root@replica ~]$ service restart cvmfsreplica
</pre>
<p />
To stop the service:
<pre class="rootscreen">
[root@replica ~]$ service stop cvmfsreplica
</pre>
<p />
To check the status of the service:
<pre class="rootscreen">
[root@replica ~]$ service status cvmfsreplica
</pre>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="7_2_RHEL_7"></a> 7.2  RHEL 7 </span></h2>
<p />
<p />
To start the service:
<pre class="rootscreen">
[root@replica ~]$ systemctl start cvmfsreplica.service
</pre>
<p />
<p />
To stop the service:
<pre class="rootscreen">
[root@replica ~]$ systemctl stop cvmfsreplica.service
</pre>
<p />
<h1><a name="8_UML"></a> 8  UML </h1>
<p />
<img src="https://twiki.grid.iu.edu/twiki/pub/Documentation/Release3/CvmfsReplica/cvmfsreplicaflow.png">
<p />
<p />
<p />
<p />
<p />
<p />
-- <span class="twikiNewLink">JoseCaballero<a href="/bin/edit/Main/JoseCaballero?topicparent=Documentation/Release3.CvmfsReplica" rel="nofollow" title="JoseCaballero (this topic does not yet exist; you can create it)">?</a></span> - 24 Jun 2016</div><!-- /patternTopic-->
<p />
<p />
<div class="twikinetRounded twikinetRoundedAttachments"><div class="rCRounded"><div class="rCTR"><div class="rCTL"></div><!--/rCTL--><div class="twikiAttachments">
<div class="twistyPlugin twikiMakeVisibleInline">  <span id="topicattachmentslistshow" class="twistyRememberSetting twistyTrigger twikiUnvisited twistyHidden twistyInited"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleopen.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Attachments</span></a> </span> <span id="topicattachmentslisthide" class="twistyRememberSetting twistyTrigger twikiUnvisited twistyHidden twistyInited"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleclose.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Attachments</span></a> </span>  </div><!--/twistyPlugin twikiMakeVisibleInline--> <div class="twistyPlugin"><div id="topicattachmentslisttoggle" class="twistyRememberSetting twistyContent twikiMakeHidden twistyInited">
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table summary="Topic attachments" cellspacing="0" id="twikiAttachmentsTable" cellpadding="0" class="twikiTable" rules="rows" border="1"><caption>Topic attachments</caption>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/CvmfsReplica?cover=print;sortcol=0;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">I</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol1"> <a rel="nofollow" href="/bin/view/Documentation/Release3/CvmfsReplica?cover=print;sortcol=1;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Attachment</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol2"> <a rel="nofollow" href="/bin/view/Documentation/Release3/CvmfsReplica?cover=print;sortcol=2;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Action</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol3"> <a rel="nofollow" href="/bin/view/Documentation/Release3/CvmfsReplica?cover=print;sortcol=3;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Size</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol4"> <a rel="nofollow" href="/bin/view/Documentation/Release3/CvmfsReplica?cover=print;sortcol=4;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Date</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol5"> <a rel="nofollow" href="/bin/view/Documentation/Release3/CvmfsReplica?cover=print;sortcol=5;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Who</font></a> </th>
			<th bgcolor="#eceef2" valign="middle" class="twikiTableCol6 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/CvmfsReplica?cover=print;sortcol=6;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Comment</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" align="center" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> <img width="16" alt="png" align="top" src="/twiki/pub/TWiki/TWikiDocGraphics/png.gif" height="16" border="0" /><span class="twikiHidden">png</span> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol1 twikiLast"> <a href="/twiki/pub/Documentation/Release3/CvmfsReplica/cvmfsreplicaflow.png">cvmfsreplicaflow.png</a> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol2 twikiLast"> <a href="/bin/attach/Documentation/Release3/CvmfsReplica?filename=cvmfsreplicaflow.png;revInfo=1" title="change, update, previous revisions, move, delete..." rel="nofollow">manage</a> </td>
			<td bgcolor="#ffffff" align="right" valign="top" class="twikiTableCol3 twikiLast"> 26.7&nbsp;K </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol4 twikiLast"> <span class="twikiNoBreak">23 Jan 2017 - 16:34</span> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol5 twikiLast"> <span class="twikiNewLink">JoseCaballero<a href="/bin/edit/Main/JoseCaballero?topicparent=Documentation/Release3.CvmfsReplica" rel="nofollow" title="JoseCaballero (this topic does not yet exist; you can create it)">?</a></span> </td>
			<td bgcolor="#ffffff" align="left" valign="top" class="twikiTableCol6 twikiLastCol twikiLast"> &nbsp; </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
</div></div> <!--/twistyPlugin--></div><!--//twikiAttachments--></div><!--/rCTR--><div class="rCBR"><div class="rCBL"></div><!--/rCBL--></div><!--/rCBR--></div><!--/rCRounded--></div><!--/twikinetRounded--></div><!-- /patternContent-->
<hr />
This topic: Documentation/Release3<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>CvmfsReplica</span> <br />    
Topic revision: r9 - 23 Jan 2017 - 16:35:57 - <span class="twikiNewLink">JoseCaballero<a href="/bin/edit/Main/JoseCaballero?topicparent=Documentation/Release3.CvmfsReplica" rel="nofollow" title="JoseCaballero (this topic does not yet exist; you can create it)">?</a></span>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />