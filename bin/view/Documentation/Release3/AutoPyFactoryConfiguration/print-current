<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> AutoPyFactoryConfiguration &lt; Documentation/Release3 &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Documentation/Release3/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Documentation/Release3/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Documentation/Release3/AutoPyFactoryConfiguration?_T=16 Feb 2017" type="application/x-wiki" title="edit AutoPyFactoryConfiguration" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Documentation/Release3/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Documentation/Release3/AutoPyFactoryConfiguration"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#FFFFFF;
	}
	.patternBookView {
		border-color:#FFFFFF;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <strong>WARNING: THIS DOCUMENTATION IS WORK IN PROGRESS!!</strong>
<p />
<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;width:100%}
.tg td{font-family:Arial, sans-serif;font-size:12px;padding:5px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
.tg th{font-family:Arial, sans-serif;font-size:12px;font-weight:normal;padding:5px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
.tg .tg-raw1{font-weight:bold;color:#0055ff;text-align:left}
.tg .tg-header{font-weight:bold;background-color:#c0c0c0;text-align:center}
.tg .tg-splitheader{font-weight:bold;background-color:#e0e0e0;text-align:center}
</style>
<p />
<p />
<!-- some useful definitions  (need 3 white spaces before * to enable it) <ul>
<li> Set UCL_PROMPT_ROOT = [root@factory ~]$
</li> <li> Set VERSION = 2.4.6
</li></ul> 
-->
<p />
<h1><a name="Configuration_of_AutoPyFactory"></a>  Configuration of AutoPyFactory </h1>
<!--
<p />
-->
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#1_About_this_Document">1  About this Document</a>
</li> <li> <a href="?cover=print#2_Applicable_versions">2  Applicable versions</a>
</li> <li> <a href="?cover=print#3_Format_of_the_configuration_fi">3  Format of the configuration files</a>
</li> <li> <a href="?cover=print#4_Reference_Manual">4  Reference Manual</a>
</li> <li> <a href="?cover=print#5_Configuration_files">5  Configuration files</a> <ul>
<li> <a href="?cover=print#5_1_sysconfig_autopyfactory">5.1  sysconfig/autopyfactory</a>
</li> <li> <a href="?cover=print#5_2_autopyfactory_conf">5.2  autopyfactory.conf</a>
</li> <li> <a href="?cover=print#5_3_queues_conf">5.3  queues.conf</a>
</li> <li> <a href="?cover=print#5_4_proxy_conf">5.4  proxy.conf</a>
</li> <li> <a href="?cover=print#5_5_monitor_conf">5.5  monitor.conf</a>
</li> <li> <a href="?cover=print#5_6_mappings_conf">5.6  mappings.conf</a>
</li></ul> 
</li> <li> <a href="?cover=print#6_Workflows">6  Workflows</a>
</li></ul> 
</div>
<p />
<h1><a name="1_About_this_Document"></a> 1  About this Document </h1>
<p />
This document describes all configuration variables in <a href="/bin/view/Documentation/Release3/AutoPyFactory" class="twikiLink">AutoPyFactory</a>
<p />
on    
on    
<p />
<p />
<h1><a name="2_Applicable_versions"></a> 2  Applicable versions </h1>
<p />
This documentation applies to the latest version of APF: 2.4.9
<p />
<p />
<h1><a name="3_Format_of_the_configuration_fi"></a> 3  Format of the configuration files </h1>
<p />
The format of the configuration files is similar to the Microsoft INI files. The configuration file consists of sections, led by a <code>[section]</code> header and followed by <code>name: value</code> entries, with continuations in the style of <a href="http://tools.ietf.org/html/rfc822.html" target="_top">RFC 822</a> (see section 3.1.1, “LONG HEADER FIELDS”); <code>name=value</code> is also accepted. Note that leading whitespace is removed from values. Additional defaults can be provided on initialization and retrieval. Lines beginning with '#' or ';' are ignored and may be used to provide comments.
<p />
It accepts interpolation. This means values can contain format strings which refer to other values in the same section, or values in a special <code>[DEFAULT]</code> section.
<p />
Configuration files may include comments, prefixed by specific characters (# and ;). Comments may appear on their own in an otherwise empty line, or may be entered in lines holding values or section names. In the latter case, they need to be preceded by a whitespace character to be recognized as a comment. (For backwards compatibility, only ; starts an inline comment, while # does not.)
<p />
As the python package ConfigParser is being used to digest the configuration files, a wider explanation and examples can be found in the <a href="https://docs.python.org/2/library/configparser.html" target="_top">python documentation page</a>. 
<p />
<h1><a name="4_Reference_Manual"></a> 4  Reference Manual </h1>
<p />
A detailed description of all configuration variables used in AutoPyFactory can be found <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/AutoPyFactoryReferenceManual" target="_top">here</a>
<p />
<h1><a name="5_Configuration_files"></a> 5  Configuration files </h1>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="5_1_sysconfig_autopyfactory"></a> 5.1  sysconfig/autopyfactory </span></h2>
<p />
The first set of configuration for the factory is done via the <code>/etc/sysconfig/autopyfactory</code> config file. 
This is the configuration file used by the daemon service to decide how to run the factory. 
It set the following variables: <ul>
<li> log level: <strong>WARNING</strong>, <strong>INFO</strong> or <strong>DEBUG</strong>
</li> <li> time to sleep between internal cycles
</li> <li> the username to switch into to. Note the factory will not run as root, but as a non priviledged account
</li> <li> the log file
</li></ul> 
Also, any other modifications to the environment needed by the factory can be set in this file.
Example
<p />
<pre class="file">
OPTIONS="--debug --sleep=60 --runas=autopyfactory --log=/var/log/autopyfactory/autopyfactory.log"
CONSOLE_LOG=/var/log/autopyfactory/console.log
env | sort >> $CONSOLE_LOG
</pre>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="5_2_autopyfactory_conf"></a> 5.2  autopyfactory.conf </span></h2>
<p />
It is the configuration file where the generic parameters for the whole factory are set. 
Its location and name, <code>/etc/autopyfactory/autopyfactory.conf</code>, is set in the daemon init script, <code>/etc/init.d/autopyfactory</code>, and therefore cannot be changed. 
<p />
A detailed description of this file variables can be found in the <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/AutoPyFactoryReferenceManual#5_autopyfactory_conf" target="_top">Reference Manual</a>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="5_3_queues_conf"></a> 5.3  queues.conf </span></h2>
<p />
It is the file where each APFQueue is defined. 
AutoPyFactory is built around the concept of APFQueues. An APFQueue can be seen as the unique combination of these concepts: <ul>
<li> a wms system queue: where the payload jobs are waiting. The concept of wms queue is an abstraction, and it will depend on what WMS System is being used each case. Whe the WMS System is <code>PanDA</code>, the wms queue is the panda queue. When the WMS System is a condor pool, a wms queue is each different value of the classad <code>+MATCH_APF_QUEUE</code> that jobs in that condor pool carry.
</li> <li> a batch system queue: where the pilots will be submitted. It could be a CE based on globus GT5, or GT2. It could be a CE based on CREAM. A CE based on HTCondor-CE. It could be an Amazon EC2 workflow managed by condor. It can be a remote condor pool. For all possibilities, chech the <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/AutoPyFactoryReferenceManual" target="_top">Reference Manual</a>
</li></ul> 
<p />
That, plus an algorithm to decide how many pilots to submit each cycle.
<p />
Therefore, each APFQueue in AutoPyFactory needs to set, at least, these elements: <ul>
<li> the plugin to query the wms service being used
</li> <li> the name of the queue in that wms service (wmsqueue)
</li> <li> the plugin to query the status of previous pilots in the batch system
</li> <li> the plugin to submit new pilots to the batch system
</li> <li> the plugin(s) to decide how many new pilots to submit each cycle 
</li></ul> 
<p />
The complete list of configuration parameters can be found <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/AutoPyFactoryReferenceManual#6_queues_conf" target="_top">Reference Manual</a>
<p />
For each APFQueue, a section is set in this file. All APFQueues sections become threads running asynchronously. 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="5_4_proxy_conf"></a> 5.4  proxy.conf </span></h2>
<p />
It is the file where the x509 proxy files are set, when needed. 
The complete list of configuration parameters can be found <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/AutoPyFactoryReferenceManual#7_proxy_conf" target="_top">Reference Manual</a>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="5_5_monitor_conf"></a> 5.5  monitor.conf </span></h2>
<p />
It is the file to setup, if needed, where the factory will send information periodically for web monitor. 
The complete list of configuration parameters can be found <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/AutoPyFactoryReferenceManual#8_monitor_conf" target="_top">Reference Manual</a>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="5_6_mappings_conf"></a> 5.6  mappings.conf </span></h2>
<p />
This file is being used internally by the factory to translate external tools information into internal nomenclature. 
It defines completely the behavior of the factory. Unless you are an expert on the factory, <strong>DO NOT TOUCH IT</strong>.
<p />
<h1><a name="6_Workflows"></a> 6  Workflows </h1>
<p /> <ul>
<li> Configuration for WMS being PanDA <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/AutoPyFactoryWorkflowPanda" target="_top">here</a>
</li> <li> glideins based workflows. Some details on how to configure the factory to work in a glidein style are <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/AutoPyFactoryWorkflowGlidein" target="_top">here</a>
</li> <li> Submission to CREAM CE <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/AutoPyFactoryWorkflowCream" target="_top">here</a>
</li> <li> Submission to NorduGrid CE <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/AutoPyFactoryWorkflowNorduGrid" target="_top">here</a>
</li> <li> Submission to EC2 <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/AutoPyFactoryWorkflowEC2" target="_top">here</a>
</li></ul> </div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Documentation/Release3<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>AutoPyFactoryConfiguration</span> <br />    
Topic revision: r9 - 12 Oct 2016 - 15:08:16 - <a href="/bin/view/Main/KyleGross" class="twikiLink">KyleGross</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />