<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> TroubleshootingComputeElement &lt; Documentation/Release3 &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Documentation/Release3/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Documentation/Release3/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Documentation/Release3/TroubleshootingComputeElement?_T=16 Feb 2017" type="application/x-wiki" title="edit TroubleshootingComputeElement" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Documentation/Release3/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Documentation/Release3/TroubleshootingComputeElement"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#FFFFFF;
	}
	.patternBookView {
		border-color:#FFFFFF;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--TWISTYPLUGIN_TWISTY--><style type="text/css" media="all">
@import url("https://twiki.opensciencegrid.org/twiki/pub/TWiki/TwistyContrib/twist.css");
</style>
<script type='text/javascript' src='https://twiki.opensciencegrid.org/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js'></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikiPref.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TwistyContrib/twist.compressed.js"></script>
<script type="text/javascript">
// <![CDATA[
var styleText = '<style type="text/css" media="all">.twikiMakeVisible{display:inline;}.twikiMakeVisibleInline{display:inline;}.twikiMakeVisibleBlock{display:block;}.twikiMakeHidden{display:none;}</style>';
document.write(styleText);
// ]]>
</script>

<!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> 
<p />
<h1><a name="Compute_Element_Troubleshooting"></a>  Compute Element Troubleshooting Guide </h1>
<p />
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#About_this_document"> About this document</a> <ul>
<li> <a href="?cover=print#How_to_get_Help"> How to get Help?</a>
</li></ul> 
</li> <li> <a href="?cover=print#Troubleshooting_Common_Job_Submi"> Troubleshooting Common Job Submission (Globus GRAM) Errors</a> <ul>
<li> <a href="?cover=print#Error_Code_7_Authorization_error"> Error Code 7 (Authorization errors)</a> <ul>
<li> <a href="?cover=print#Grid_mapfile_authorization_faile"> Grid-mapfile authorization failed</a>
</li> <li> <a href="?cover=print#GUMS_authorization_failed"> GUMS authorization failed</a>
</li></ul> 
</li> <li> <a href="?cover=print#GRAM_Error_code_12"> GRAM Error code 12</a> <ul>
<li> <a href="?cover=print#Is_the_gatekeepeer_running"> Is the gatekeepeer running?</a>
</li> <li> <a href="?cover=print#CA_Certificate_problems"> CA Certificate problems?</a>
</li></ul> 
</li> <li> <a href="?cover=print#GRAM_Error_code_22"> GRAM Error code 22</a>
</li> <li> <a href="?cover=print#GRAM_Error_Code_47"> GRAM Error Code 47</a>
</li> <li> <a href="?cover=print#Job_environment_not_set_up_corre"> Job environment not set up correctly</a>
</li></ul> 
</li> <li> <a href="?cover=print#Troubleshooting_edg_mkgridmap"> Troubleshooting edg-mkgridmap</a> <ul>
<li> <a href="?cover=print#Is_edg_mkgridmap_installed"> Is edg-mkgridmap installed?</a>
</li> <li> <a href="?cover=print#Is_edg_mkgridmap_enabled"> Is edg-mkgridmap enabled?</a>
</li> <li> <a href="?cover=print#Are_there_errors_in_the_log_file"> Are there errors in the log file?</a>
</li> <li> <a href="?cover=print#Did_you_map_a_user_or_VO_to_an_a"> Did you map a user or VO to an account that doesn't exist?</a>
</li> <li> <a href="?cover=print#Do_you_want_to_force_the_grid_ma"> Do you want to force the grid-mapfile to update now?</a>
</li> <li> <a href="?cover=print#Are_local_users_missing_from_the"> Are local users missing from the grid-mapfile? </a>
</li></ul> 
</li> <li> <a href="?cover=print#Some_configuration_errors"> Some configuration errors</a> <ul>
<li> <a href="?cover=print#Globus_is_not_finding_PBS_the_qu"> Globus is not finding PBS (the queue manager)</a>
</li></ul> 
</li> <li> <a href="?cover=print#Sample_Troubleshooting_Session_B"> Sample Troubleshooting Session (Based on an actual session)</a> <ul>
<li> <a href="?cover=print#Symptoms"> Symptoms</a>
</li> <li> <a href="?cover=print#Potential_Problems"> Potential Problems</a>
</li> <li> <a href="?cover=print#Solutions"> Solutions</a>
</li></ul> 
</li> <li> <a href="?cover=print#HOWTO_Create_a_core_file_for_glo"> HOWTO: Create a core file for globus-job-manager</a>
</li> <li> <a href="?cover=print#Appendix_Log_files"> Appendix: Log files</a>
</li> <li> <a href="?cover=print#References"> References</a>
</li> <li> <a href="?cover=print#Comments"> Comments</a>
</li></ul> 
</div>
<p />
<h1><a name="About_this_document"></a> About this document </h1>
This document will help you troubleshoot problems with the Compute Element. See also other documents recommended in the Reference section below.
<p />
This document assumes that you have already <a href="/bin/view/Documentation/Release3/InstallComputeElement" class="twikiLink">installed and configured your CE</a>. 
<p />
This document follows the general OSG documentation conventions: <div class="twistyPlugin twikiMakeVisibleInline">  <span id="twistyIdDocumentation/Release3TroubleshootingComputeElement1show" class="twistyRememberSetting twistyStartHide twistyTrigger twikiUnvisited twistyInited0"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleopen-small.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Click to expand document conventions...</span></a> </span> <span id="twistyIdDocumentation/Release3TroubleshootingComputeElement1hide" class="twistyRememberSetting twistyStartHide twistyTrigger twikiUnvisited twistyHidden twistyInited0"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleclose-small.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Hide Full Output</span></a> </span>  </div><!--/twistyPlugin twikiMakeVisibleInline--> <div class="twistyPlugin"><div id="twistyIdDocumentation/Release3TroubleshootingComputeElement1toggle" class="twistyRememberSetting twistyStartHide twistyContent twikiMakeHidden twistyInited0">
on    
on    
</div></div> <!--/twistyPlugin-->
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="How_to_get_Help"></a> How to get Help? </span></h2>
You can find some suggestions in the <a href="/bin/view/Documentation/Release3/InstallComputeElement" class="twikiLink">CE install document</a> or in the <a href="/bin/view/Trash/ReleaseDocumentationValidatingComputeElement" class="twikiLink">validating document</a>.
<p />
To get assistance please use <a href="/bin/view/Documentation/Release3/HelpProcedure" class="twikiLink">Help Procedure</a>. 
<p />
<p />
<h1><a name="Troubleshooting_Common_Job_Submi"></a> Troubleshooting Common Job Submission (Globus GRAM) Errors </h1>
<p />
You can increase the verbosity or the GRAM jobmanager by editing <code>/etc/globus/globus-gram-job-manager.conf</code> and adding a line setting the log level to DEBUG o TRACE (e.g. <code>-log-levels TRACE</code>). The available log levels are FATAL, ERROR, WARN, INFO, DEBUG, and TRACE. Multiple values can be combined with the | character. The default value of logging when enabled is FATAL|ERROR. See the <a href="http://toolkit.globus.org/toolkit/docs/5.0/5.0.0/execution/gram5/user/" target="_top">Globus GRAM documentation</a> for more.
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Error_Code_7_Authorization_error"></a> Error Code 7 (Authorization errors) </span></h2>
<p />
The grid users is not authorized to submit a job:
<p />
<pre class="screen">
% globus-job-run localhost /usr/bin/whoami
GRAM Job submission failed because authentication with the remote server failed (error code 7)
</pre>
<p />
There are a few reasons this error could occur. 
<p />
<h3><a name="Grid_mapfile_authorization_faile"></a> Grid-mapfile authorization failed </h3>
<p />
If you use a grid-mapfile (probably with <code>edg-mkgridmap</code>) is the user in the gridmapfile? If not, you'll see an error message similar to this one in <code>/var/log/globus-gatekeeper.log</code>:
<pre class="screen">
TIME: Fri Dec  2 09:44:47 2011
 PID: 875 -- Failure: globus_gss_assist_gridmap() failed authorization. globus_gss_assist: 
             Gridmap lookup failure: Could not map /DC=org/DC=doegrids/OU=People/CN=Alain Roy 424511
</pre>
<p />
<h3><a name="GUMS_authorization_failed"></a> GUMS authorization failed </h3>
If you use GUMS for authorization, is GUMS running and reachable? Here is an example error message in <code>/var/log/globus-gatekeeper.log</code> that shows the gatekeeper unable to reach the GUMS server.
<p />
<pre class="file">
TIME: Fri Dec  2 10:17:20 2011
 PID: 2160 -- Failure: globus_gss_assist_gridmap() failed authorization. globus_gss_assist: Error invoking callout
globus_callout_module: The callout returned an error
an unknown error occurred
</pre>
<p />
This isn't very illustrative because the software that communicates with GUMS (lcmaps) writes to <code>/var/log/messages</code>. There we can see a better error message:
<p />
<pre class="file">
Dec  2 10:12:42 fermicloud081 l_l_gt4[2051]: 	xacmlqueryscas(): XACML: Interaction failed: <font color="#ff0000">TCP/IP, SSL or SOAP Error with endpoint:</font>
               "https://fermicloud081.fnal.gov:8443/gums/services/GUMSXACMLAuthorizationServicePort" 
Dec  2 10:12:43 fermicloud081 l_l_gt4[2051]: 2011-12-02.10:06:26.0000002051.0000000000 : 	
               lcmaps_plugin_scas_client-plugin_run(): scas client plugin failed 
</pre>
<p />
If GUMS is running and allowing connections from the CE, you need to dig deeper. Temporarily edit <code>/etc/sysconfig/globus-gatekeeper</code> by adding these lines:
<pre class="file">
# level 0: no messages, 1: errors, 2: also warnings, 3: also notices,
#  4: also info, 5: maximum debug
LCMAPS_DEBUG_LEVEL=5
</pre>
This will increase the output in <code>/var/log/messages</code>. <strong>Warning</strong>: This will make the log much bigger! You'll want to remove these lines when you're done debugging.
<p />
A few things to check for:
<p /> <ol>
<li> Check that the URL for GUMS is correct. It should be of the form: <code>https://<font color="#ff0000">HOSTNAME</font>:8443/gums/services/GUMSXACMLAuthorizationServicePort</code>. For example, you might see:<pre class="file">
Jan  9 12:55:35 alachua l_l_gt4[20879]:         xacmlqueryscas(): XACML: Using SCAS service endpoint: https://gums.ihepa.ufl.edu:8443/gums/services/GUMSAuthorizationServicePort
</pre>
</li> <li> Here's an example error that shows that the user wasn't made or had some other problem (such as an LDAP problem if you use LDAP for user account management.) :<pre class="file">
Jan  9 13:31:50 alachua l_l_gt4[5634]: Username_handler: Error: Couldn't find the username 'cms30054' in the password file.
</pre>
</li></ol> 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="GRAM_Error_code_12"></a> GRAM Error code 12 </span></h2>
<p />
Sample problem:
<pre class="screen">
% globus-job-run fermicloud081.fnal.gov /usr/bin/whoami
GRAM Job submission failed because the connection to the server failed (check host and port) (error code 12)
</pre>
<p />
<a name="GatekeeperRunning"></a>
<h3><a name="Is_the_gatekeepeer_running"></a> Is the gatekeepeer running? </h3>
<p />
<pre class="rootscreen">
[root@client ~]$ ps auwx | grep globus-gatekeeper | grep -v grep
</pre>
<p />
Nope, run it:
<pre class="rootscreen">
[root@client ~]$ /sbin/service globus-gatekeeper start
Started globus-gatekeeper                                  [  <font color="#008000">OK</font>  ]
</pre>
<p />
<p /> <dl>
<dt> <img src="/twiki/pub/TWiki/TWikiDocGraphics/help.gif" alt="HELP" title="HELP" width="16" height="16" border="0" />     <strong><font color="#ff0000"> NOTE </font></strong> </dt><dd>  If your gatekeeper doesn't have credentials in <code>/etc/grid-security/hostcert.pem</code>, and <code>/etc/grid-security/hostkey.pem</code> it will appear to start up correctly, but will not actually be running. 
</dd></dl> 
<p />
<p />
<h3><a name="CA_Certificate_problems"></a> CA Certificate problems? </h3>
Are your CA certificates properly installed in <code>/etc/grid-security/certificates</code>? Are they up to date? A sample error message from <code>/var/log/globus-gatekeeper.log</code> that shows that <code>/etc/grid-security/certificates</code> doesn't exist:
<p />
<pre class="screen">
 PID: 1079 -- Notice: 6: Got connection 198.51.254.71 at Fri Dec  2 09:49:58 2011

GSS authentication failure 
GSS Major Status: General failure
GSS Minor Status Error Chain:
globus_gsi_gssapi: Error with gss context
globus_gsi_gssapi: Error with GSI credential
globus_sysconfig: Could not find a valid trusted CA certificates directory: The trusted certificates directory could not be found in any of the following locations: 
1) env. var. X509_CERT_DIR
2) $HOME/.globus/certificates
3) /etc/grid-security/certificates
4) $GLOBUS_LOCATION/share/certificates

Failure: GSS failed Major:000d0000 Minor:0000000c Token:00000000
</pre>
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="GRAM_Error_code_22"></a> GRAM Error code 22 </span></h2>
<p />
The grid user is authorized to submit a job, but cannot write to their directory:
<p />
<pre class="screen">
% globus-job-run localhost /usr/bin/whoami
GRAM Job submission failed because mkdir failed: /home/alainroy/.globus: Permission denied (error code 22)
</pre>
<p />
The error in <code>/var/log/globus/<font color="#ff0000">&lt;user</font>.log</code>:
<pre class="screen">
ts=2011-12-02T15:44:02.093484Z id=644 event=gram.make_job_dir.end level=ERROR gramid=/16218020932513377141/290484376369931657/ status=-22 path=/home/alainroy/.globus/alainroy msg=<font color="#ff0000">"Error creating directory"</font> errno=13 reason=<font color="#ff0000">"Permission denied"</font>
</pre>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="GRAM_Error_Code_47"></a> GRAM Error Code 47 </span></h2>
<p />
The grid user is authorized to submit a job to <a href="/bin/view/Documentation/GlossaryG#DefsGridResourceAllocationAndManagement" class="twikiAnchorLink">GRAM</a>, but the assigned Unix account does not exist on the <a href="/bin/view/Documentation/GlossaryC#DefsComputeElement" class="twikiAnchorLink">Compute Element</a>:
<p />
<pre class="screen">
[user@client ~]$ globus-job-run fermiclou081.fnal.gov /usr/bin/whoami
GRAM Job submission failed because the gatekeeper failed to run the job manager  (<font color="#ff0000">error code 47</font>)
</pre>
<p />
The GRAM log file on the Compute Element <code>/var/log/globus-gatekeeper.log</code> will contain an entry indicating the missing Unix account:
<p />
<pre class="file">
 PID: 32172 -- Notice: 5: Authorized as local user: alainroo
Failure: getpwname() failed to find alainroo
</pre>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Job_environment_not_set_up_corre"></a> Job environment not set up correctly </span></h2>
<p />
When you run a job, it should environment variables specific to the OSG install. For instance:
<p />
<pre class="screen">
[user@client ~]$ globus-job-run fermicloud084 /bin/env | sort | grep ^OSG
OSG_APP=/tmp
OSG_DATA=/tmp
OSG_DEFAULT_SE=None
OSG_GLEXEC_LOCATION=None
OSG_GRID=/etc/osg/wn-client/
OSG_HOSTNAME=fermicloud084.fnal.gov
OSG_JOB_CONTACT=fermicloud084.fnal.gov/jobmanager-condor
OSG_SITE_NAME=ROYTEST
OSG_SITE_READ=None
OSG_SITE_WRITE=None
OSG_SQUID_LOCATION=UNAVAILABLE
OSG_STORAGE_ELEMENT=False
OSG_WN_TMP=/tmp
</pre>
<p />
If you don't see those, there are a couple of possible problems. 
<p /> <ol>
<li> Did <code>osg-configure</code> make the environment file? Those variables are set in <code>/var/lib/osg/osg-job-environment.conf</code>. If it doesn't exist, either <code>osg-configure</code> had a failure or it believes that you do not have a CE. It decides if you have a CE based on the <code>osg-ce</code> package being installed.
</li> <li> Did you install the OSG version of the Globus RPMs? The EPEL repository also contains Globus, but you must use some of the RPMs from other repository. In this case, you must use the <code>globus-gram-job-manager-scripts</code> package from the OSG repository to set up the job environment. You can tell if you have the right RPM because of the <code>osg</code> "dist tag" in the RPM name: <pre class="screen">
[user@client ~]$ rpm -q globus-gram-job-manager-scripts
globus-gram-job-manager-scripts-4.1-3.1.<font color="#ff0000">osg</font>.noarch</pre> If you have the EPEL version, it's possible that you didn't install the yum priorities plugin, or that you don't have plugins enabled in your yum.conf. 
</li></ol> 
<p />
<a name="TroubleshootingEdgMkgridmap"></a>
<h1><a name="Troubleshooting_edg_mkgridmap"></a> Troubleshooting <code>edg-mkgridmap</code> </h1>
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Is_edg_mkgridmap_installed"></a> Is edg-mkgridmap installed? </span></h2>
<p />
<pre class="screen">
[root@client ~]$  rpm -q edg-mkgridmap
edg-mkgridmap-4.0.0-3.osg.noarch
</pre>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Is_edg_mkgridmap_enabled"></a> Is edg-mkgridmap enabled? </span></h2>
<p />
<pre class="screen">
[root@client ~]$  /sbin/service edg-mkgridmap status
Periodic edg-mkgridmap is <font color="#ff0000">disabled</font>.
</pre>
<p />
If it is disabled, enable it:
<p />
<pre class="screen">
[root@client ~]$ /sbin/service edg-mkgridmap start
Enabling periodic edg-mkgridmap:                           [  <font color="#008000">OK</font>  ]
</pre>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Are_there_errors_in_the_log_file"></a> Are there errors in the log file? </span></h2>
<p />
Look in the log file in <code>/var/log/edg-mkgridmap.log</code> for any error messages. Here is a sample error message:
<p />
<pre class="file">
voms search(https://voms.grid.iu.edu:8443/voms/mis/special/services/VOMSCompatibility?method=getGridmapUsers): Not Found
</pre>
<p />
This says that it cannot fetch information from voms.grid.iu.edu for the "mis/special" group. This is due to a misconfiguration. My <code>/etc/edg-mkgridmap.conf</code> file incorrectly has:
<p />
<pre class="file">
group vomss://voms.grid.iu.edu:8443/voms/mis<font color="#ff0000">/special</font> mis
</pre>
<p />
instead of:
<pre class="file">
group vomss://voms.grid.iu.edu:8443/voms/mis mis
</pre>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Did_you_map_a_user_or_VO_to_an_a"></a> Did you map a user or VO to an account that doesn't exist? </span></h2>
<p />
Look in <code>/var/lib/osg/undefined-accounts</code> to see if you mapped a user or VO to an account that doesn't exist.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Do_you_want_to_force_the_grid_ma"></a> Do you want to force the grid-mapfile to update now? </span></h2>
<p />
If you want to force edg-mkgridmap to run right now, you can:
<p />
<pre class="rootscreen">
[root@client ~]$ /usr/sbin/edg-mkgridmap
</pre>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Are_local_users_missing_from_the"></a> Are local users missing from the grid-mapfile? </span></h2>
<p />
Check the configuration file <code>/etc/edg-mkgridmap.conf</code>. It should contain (in part):
<p />
<pre class="file">
#### GMF_LOCAL: gmf_local grid-mapfile-local
gmf_local /etc/grid-security/grid-mapfile-local
</pre>
<p />
Then make sure the file <code>/etc/grid-security/grid-mapfile-local</code> contains the desired <a href="/bin/view/Documentation/GlossaryD#DefsDistinguishedName" class="twikiAnchorLink">Distinguished Name</a> to account mappings.
<p />
<h1><a name="Some_configuration_errors"></a> Some configuration errors </h1>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Globus_is_not_finding_PBS_the_qu"></a> Globus is not finding PBS (the queue manager) </span></h2>
Check that the directory <code>/etc/globus/scheduler-event-generator</code> contains a link <code>pbs-&gt; available/pbs</code>.
The link should be there. If it is not there, then create the link:<pre class="rootscreen">
[root@client ~]$ cd /etc/globus/scheduler-event-generator
[root@client ~]$ ln -s available/pbs pbs
</pre>
<p />
<p />
<h1><a name="Sample_Troubleshooting_Session_B"></a> Sample Troubleshooting Session (Based on an actual session) </h1>
<p />
The site upgraded CE's from version 3.x to version 3.y.  The upgrade seems to have "broken" the CE.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Symptoms"></a> Symptoms </span></h2> <ul>
<li> globus-job-run with jobmanager-fork against CE hangs indefinitely
</li> <li> running the RSV probes by hand hangs indefinitely
</li> <li> the globus-gatekeeper.log appears to show proper authentication
</li> <li> globusrun -a -r <ce fqdn> intermitently works <ul>
<li> A failure looks like:
</li></ul> 
</li></ul> 
<pre class="screen">
[root@client ~]$ /usr/bin/globusrun -a -r <ce fqdn>

GRAM Authentication test failure: the connection to the server failed (check host and port)
</pre>    
<p /> <ul>
<li> globus-url-copy -dbg gsiftp://<ce fqdn>/dev/zero /dev/null displays an unknown user <ul>
<li> Note the "[unknown]" string in the output:
</li></ul> 
</li></ul> 
<pre class="screen">
[root@client ~]$ /usr/bin/globus-url-copy -dbg gsiftp://<ce fqdn>/dev/zero /dev/null

debug: starting to get gsiftp://<ce fqdn>/dev/zero
debug: connecting to gsiftp://<ce fqdn>/dev/zero
debug: response from gsiftp://<ce fqdn>/dev/zero:
220 <ce fqdn> GridFTP Server 6.5 (gcc64, 1323378368-83) [unknown] ready.

debug: authenticating with gsiftp://<ce fqdn>/dev/zero
</pre>    
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Potential_Problems"></a> Potential Problems </span></h2> <ul>
<li> 1) Is gatekeeper running?
</li> <li> 2) Potential gatekeeper config issues?
</li> <li> 3) Potential GUMS issues?
</li> <li> 4) Potential syslog config error?
</li></ul> 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Solutions"></a> Solutions </span></h2> <ul>
<li> (1) See <a href="/bin/view/Documentation/Release3/TroubleshootingComputeElement#GatekeeperRunning" class="twikiCurrentTopicLink twikiAnchorLink">Is the gatekeeper running?</a>  <ul>
<li> Note: During the troubleshooting session it was noticed that there were 1400+ gatekeeper processes running.  Even after stopping the gatekeeper service, the processes persisted.  The had to be killed with the -9 flag.
</li></ul> 
</li> <li> (2) check for /etc/sysconfig/globus-gatekeeper.rpmnew, might have to merge configs <ul>
<li> On this particular CE, the config file for globus-gatekeeper had not been modified by an admin, so the rpm upgrade was able to replace the config file.  The  /etc/sysconfig/globus-gatekeeper.rpmnew file did not exist.
</li></ul> 
</li> <li> (3) check /etc/lcmaps.db and /etc/grid-security/gsi-authz.conf for proper config <ul>
<li> These files were ok on this CE.
</li></ul> 
</li> <li> (4) check /etc/syslog.conf to see if there's a "-" before /var/log/messages? <ul>
<li> The line should look like:         <pre class="file">
*.info;mail.none;authpriv.none;cron.none  -/var/log/messages
         </pre>
</li> <li> Without the dash, syslogd will call fsync after every log message.  The CE takes so long for the log message to go through that the remote clients give up and retry, which just adds to the CE load.
</li> <li> It turns out that this was the culprit.  The load on the CE was high enough that the clients were timing out.
</li></ul> 
</li></ul> 
<p />
<h1><a name="HOWTO_Create_a_core_file_for_glo"></a> HOWTO: Create a core file for globus-job-manager </h1>
When you run against a Globus error which causes the <code>globus-job-manager</code> to segfault (you will see segfault messages in /var/log/messages), you can do the following to enable coredumps:
<p />
<pre class="screen">
[root@client ~]$ echo export DAEMON_COREFILE_LIMIT='unlimited' >> /etc/sysconfig/globus-gatekeeper
[root@client ~]$ echo /tmp/core-%e-%s-%u-%g-%p-%t > /proc/sys/kernel/core_pattern
[root@client ~]$ killall globus-job-manager
[root@client ~]$ service globus-gatekeeper stop
[root@client ~]$ service globus-gatekeeper start
</pre>
<p />
Wait awhile until one of the <code>globus-job-manager</code> processes segfaults (again, you can watch /var/log/messages).  Once that happens, you should be able to attach to the corefile and find out where it crashed:
<p />
<pre class="screen">
[root@client ~]$ gdb /usr/sbin/globus-job-manager /tmp/core-globus-job-mana-11-723-5001-11391-1332353663 
...
gdb> where
AAAA
BBBB
</pre>    
<p />
Likely, crashes are software bugs.  Please report the issue to the osg-software mailing list; we will ask you for the precise RPM version of globus-gram-job-manager (so we can lookup the debug symbols) and to send us the corefile.
<p />
<h1><a name="Appendix_Log_files"></a> Appendix: Log files </h1>
<p />
This document cannot cover all the errors you might experience. If you need to look for more data, you can look at log files for the various services on your CE. 
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table1" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/TroubleshootingComputeElement?cover=print;sortcol=0;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Service or Process</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol1 twikiLastCol"> <a rel="nofollow" href="/bin/view/Documentation/Release3/TroubleshootingComputeElement?cover=print;sortcol=1;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Log and Error Files</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> CEMon </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> <code>/var/log/glite-ce-monitor/glite-ce-monitor.log</code> </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> edg-mkgridmap </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> <code>/var/log/edg-mkgridmap.log</code> <br> <code>/var/lib/osg/osg-user-vo-map</code> <br> <code>/var/lib/osg/supported-vo-list</code> <br> <code>/var/lib/osg/undefined-accounts</code> </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> GIP </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> <code>%/var/log/gip/gip.log</code> <br> <code>/var/log/gip/modules.log</code> </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> Globus <a href="/bin/view/Documentation/GlossaryG#DefsGridResourceAllocationAndManagement" class="twikiAnchorLink">GRAM</a> Gatekeeper </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> <code>/var/log/globus-gatekeeper.log</code>  <br> <code>/var/log/messages</code> </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> Globus <a href="/bin/view/Documentation/GlossaryG#DefsGridResourceAllocationAndManagement" class="twikiAnchorLink">GRAM</a> Job Manager </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> <code>/var/log/globus/gram_<font color="#ff0000">&lt;username&gt;</font>.log</code> (one per local user account) </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> Globus <a href="/bin/view/Documentation/GlossaryG#DefsGridFTP" class="twikiAnchorLink">GridFTP</a> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> <code>/var/log/gridftp.log</code> <br> <code>/var/log/gridftp-auth.log</code> </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> Gratia </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> <code>/var/log/gratia/<font color="#ff0000">&lt;date&gt;</font>.log</code> </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> gums-host-cron </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> <code>/var/log/gums/gums-host-cron.log</code> </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> lcmaps </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> <code>/var/log/messages</code> </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> <a href="/bin/view/Documentation/GlossaryH#DefsHTCondor" class="twikiAnchorLink">HTCondor</a> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> <code>/var/log/condor/*</code> </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> Tomcat (for CEMon) </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> <code>/var/log/tomcat5/catalina.out</code> on EL5 <br> <code>/var/log/tomcat6/catalina.out</code> on EL6 </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> yum </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol twikiLast"> <code>/var/log/yum.log</code> </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
<p />
<h1><a name="References"></a> References </h1> <ul>
<li> <a href="/bin/view/Documentation/Release3/TroubleshootingGuide" class="twikiLink">TroubleshootingGuide</a> (contains a list of Globus and HTCondor errors)
</li> <li> <a href="/bin/view/Documentation/GridUsersGuideTroubleshootingOSG" class="twikiLink">GridUsersGuideTroubleshootingOSG</a>
</li></ul> 
<p />
<h1><a name="Comments"></a> Comments </h1>
<form method="post" action="https://twiki.opensciencegrid.org/bin/save/Documentation/Release3/TroubleshootingComputeElement" enctype="multipart/form-data" name="tableappend0" id="tableappend0">
<p />
<div class="commentPlugin commentPluginPromptBox">
<table><tr valign="middle"><td><textarea  rows="3" cols="70" name="comment" wrap="soft" onfocus="if(this.value=='')this.value=''" onblur="if(this.value=='')this.value=''"></textarea></td><td><input  type="submit" value="Add comment" /></td></tr></table>
</div><!--/commentPlugin-->
<p />
<input type="hidden" name="comment_action" value="save"  />
<input type="hidden" name="comment_type" value="tableappend"  />
<input type="hidden" name="comment_index" value="0"  /></form>
<p />
<p />
<!-- CONTENT MANAGEMENT PROJECT
############################################################################################################
 DEAR DOCUMENT OWNER
 <code><b>===============</b></code>
<p />
 Thank you for claiming ownership for this document! Please fill in your <span class="twikiNewLink">FirstLast<a href="/bin/edit/Documentation/Release3/FirstLast?topicparent=Documentation/Release3.TroubleshootingComputeElement" rel="nofollow" title="FirstLast (this topic does not yet exist; you can create it)">?</a></span> name here: <ul>
<li> Local OWNER = <span class="twikiNewLink">AlainRoy<a href="/bin/edit/Documentation/Release3/AlainRoy?topicparent=Documentation/Release3.TroubleshootingComputeElement" rel="nofollow" title="AlainRoy (this topic does not yet exist; you can create it)">?</a></span>
</li></ul> 
<p />
 Please define the document area, choose one of the defined areas from the next line
 DOC_AREA = (<span class="twikiNewLink">ComputeElement<a href="/bin/edit/Documentation/Release3/ComputeElement?topicparent=Documentation/Release3.TroubleshootingComputeElement" rel="nofollow" title="ComputeElement (this topic does not yet exist; you can create it)">?</a></span>|Storage|VO|Security|User|Monitoring|General|Trash/Trash/Integration|Operations|Tier3) <ul>
<li> Local DOC_AREA       = User
</li></ul> 
<p />
 define the primary role the document serves, choose one of the defined roles from the next line
 DOC_ROLE = (<span class="twikiNewLink">EndUser<a href="/bin/edit/Documentation/Release3/EndUser?topicparent=Documentation/Release3.TroubleshootingComputeElement" rel="nofollow" title="EndUser (this topic does not yet exist; you can create it)">?</a></span>|Student|Developer|SysAdmin|VOManager) <ul>
<li> Local DOC_ROLE       = <span class="twikiNewLink">SysAdmin<a href="/bin/edit/Documentation/Release3/SysAdmin?topicparent=Documentation/Release3.TroubleshootingComputeElement" rel="nofollow" title="SysAdmin (this topic does not yet exist; you can create it)">?</a></span>
</li></ul> 
<p />
 Please define the document type, choose one of the defined types from the next line
 DOC_TYPE = (Troubleshooting|Training|Installation|HowTo|Planning|Navigation|Knowledge) <ul>
<li> Local DOC_TYPE       = Installation  Please define if this document in general needs to be reviewed before release ( 1 | 0 )
</li> <li> Local INCLUDE_REVIEW = 1
</li></ul> 
<p />
 Please define if this document in general needs to be tested before release ( 1 | 0 ) <ul>
<li> Local INCLUDE_TEST   = 1
</li></ul> 
<p />
 change to 1 once the document is ready to be reviewed and back to 0 if that is not the case <ul>
<li> Local REVIEW_READY   = 1
</li></ul> 
<p />
 change to 1 once the document is ready to be tested and back to 0 if that is not the case <ul>
<li> Local TEST_READY     = 1
</li></ul> 
<p />
 change to 1 only if the document has passed the review and the test (if applicable) and is ready for release <ul>
<li> Local RELEASE_READY  = 1
</li></ul> 
<p />
<p />
 DEAR DOCUMENT REVIEWER
 <code><b>==================</b></code>
<p />
 Thank for reviewing this document! Please fill in your <span class="twikiNewLink">FirstLast<a href="/bin/edit/Documentation/Release3/FirstLast?topicparent=Documentation/Release3.TroubleshootingComputeElement" rel="nofollow" title="FirstLast (this topic does not yet exist; you can create it)">?</a></span> name here: <ul>
<li> Local REVIEWER       = <span class="twikiNewLink">MarcoMambelli<a href="/bin/edit/Documentation/Release3/MarcoMambelli?topicparent=Documentation/Release3.TroubleshootingComputeElement" rel="nofollow" title="MarcoMambelli (this topic does not yet exist; you can create it)">?</a></span> 	 Please define the review status for this document to be in progress ( 2 ), failed ( 0 ) or passed ( 1 )
</li> <li> Local REVIEW_PASSED  = 1
</li></ul> 
<p />
<p />
 DEAR DOCUMENT TESTER
 <code><b>================</b></code>
<p />
 Thank for testing this document! Please fill in your <span class="twikiNewLink">FirstLast<a href="/bin/edit/Documentation/Release3/FirstLast?topicparent=Documentation/Release3.TroubleshootingComputeElement" rel="nofollow" title="FirstLast (this topic does not yet exist; you can create it)">?</a></span> name here: <ul>
<li> Local TESTER         = <span class="twikiNewLink">MarcoMambelli<a href="/bin/edit/Documentation/Release3/MarcoMambelli?topicparent=Documentation/Release3.TroubleshootingComputeElement" rel="nofollow" title="MarcoMambelli (this topic does not yet exist; you can create it)">?</a></span> 	 Please define the test status for this document to be in progress ( 2 ), failed ( 0 ) or passed ( 1 )
</li> <li> Local TEST_PASSED    = 1
</li></ul> 
############################################################################################################
--></div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Documentation/Release3<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Documentation/Release3/WebHome" class="twikiCurrentWebHomeLink twikiLink">WebHome</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>TroubleshootingComputeElement</span> <br />    
Topic revision: r27 - 07 Feb 2017 - 19:12:43 - <a href="/bin/view/Main/BrianBockelman" class="twikiLink">BrianBockelman</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />