<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> CondorSubmittingMultipleJobs &lt; Documentation &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Documentation/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Documentation/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Documentation/CondorSubmittingMultipleJobs?_T=16 Feb 2017" type="application/x-wiki" title="edit CondorSubmittingMultipleJobs" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Documentation/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Documentation/CondorSubmittingMultipleJobs"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#FFFF99;
	}
	.patternBookView {
		border-color:#FFFF99;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> 
<h1><a name="Submitting_Multiple_Jobs_with_Co"></a>  Submitting Multiple Jobs with Condor </h1>
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#About_this_Document"> About this Document</a>
</li> <li> <a href="?cover=print#Requirements"> Requirements</a>
</li> <li> <a href="?cover=print#Submitting_Multiple_Jobs"> Submitting Multiple Jobs</a> <ul>
<li> <a href="?cover=print#Changes_to_the_Condor_submit_fil"> Changes to the Condor submit file.</a>
</li></ul> 
</li> <li> <a href="?cover=print#Conclusion"> Conclusion</a>
</li> <li> <a href="?cover=print#References"> References</a>
</li> <li> <a href="?cover=print#Comments"> Comments</a>
</li></ul> 
</div>
<p />
<h1><a name="About_this_Document"></a> About this Document </h1>
In this tutorial, we will demonstrate how to easily submit multiple jobs to the OSG using Condor-G.
<p />
<h1><a name="Requirements"></a> Requirements </h1>
In order to complete this document, you will need: <ul>
<li> A DOE Grid <a href="/bin/view/Documentation/CertificateUserGet" class="twikiLink">User Certificate</a>
</li> <li> Membership in a <a href="/bin/view/Documentation/WhatIsVO" class="twikiLink">Virtual Organization</a>
</li> <li> Access to a machine with the <a href="/bin/view/Documentation/Release3/InstallOSGClient" class="twikiLink">OSG-Client</a> (or <a href="/bin/view/ReleaseDocumentation/ClientInstallationGuide" class="twikiLink">OSG-Client 1.2, Pacman version</a>) installed. Remember to install also Condor-G if optional and to setup the environment if needed.
</li> <li> Complete the previous <a href="/bin/view/Documentation/CondorSubmittingSingleJob" class="twikiLink">tutorial about submitting single Condor-G grid jobs</a>.
</li> <li> Know the endpoint you are submitting to, as covered in the <a href="/bin/view/Documentation/FindAvailableResource" class="twikiLink">finding available resources</a> document.
</li></ul> 
<p />
<p />
<h1><a name="Submitting_Multiple_Jobs"></a> Submitting Multiple Jobs </h1>
Let's see how we would submit four jobs at once, all slightly different.  Use the following script:
<p />
Create a file named <code>mytest2.sh</code> with the following text in it: <pre class="file">
#!/bin/sh
echo "Hello World!"
echo "I am Condor job $1"

hostname
printenv
if [ "X${OSG_GRID}X"" != "XX" ]; then
 source $OSG_GRID/setup.sh
fi
voms-proxy-info -all
</pre>
<p />
Make mytest2.sh executable. That is: <pre class="screen">
[user@client ~]$ chmod +x mytest2.sh
</pre>
<p />
Make another file named <code>condorg_test2.submit</code> with the following text in it: <pre class="file">
universe      = grid
grid_resource = <span style="background-color:yellow">osg-gw-2.t2.ucsd.edu:/jobmanager-condor</span> <font color="#ff0000"> Change the the endpoint! </font> 
executable    = mytest2.sh
arguments     = $(Cluster).$(Process)
output        = test.$(Cluster).$(Process).out
error         = test.$(Cluster).$(Process).err
log           = test.log
queue 4

argument      = "Alternate $(Cluster).$(Process)"
queue 2
</pre>
<p />
We'll discuss the new portions below after we submit the job.
<ol>
   <li> <em>(If you haven't already and if you nees)</em> Source the environment for the OSG client before starting and obtain a proxy from your VOMS, here assuming the uscms VO:
<pre class="screen">
[user@client ~]$ voms-proxy-init --voms cms:/cms
</pre>
As before, replace <code>cms:/cms</code> with the proper name/group of your VO.
   <li>Submit this job just as you did with the single job:
<pre class="screen">
[user@client ~]$ condor_submit condorg_test2.submit
</pre>
  </li>
   <li>Use <code>condor_q</code> to display information about your jobs:
      <pre class="screen">[user@client ~]$ condor_q </pre></li>
</ol>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Changes_to_the_Condor_submit_fil"></a> Changes to the Condor submit file. </span></h2>
<p />
Let's walk through the new things in the Condor submit file (New as compared to the previous example of <a href="/bin/view/Documentation/CondorSubmittingSingleJob" class="twikiLink">submitting a single job</a>:
<pre class="file">
arguments = $(Cluster).$(Process)
</pre>
This illustrates a simple expansion for the job; $(Cluster) and $(Process) are <em>macros</em> which will be expanded to the Condor job cluster and process ID, respectively. Roughly, the cluster and process numbers are the "job number" most other batch systems use.  
<p />
The Arguments key will set the arguments passed to the script when the job is executed.  By setting the arguments to the process and cluster, we will run a slightly different job each time the submit file is done.  This is very useful if you need to have unique output or input.  The unique output can be named:
<pre class="file">
output = test.$(Cluster).$(Process).out
</pre>
Each time you run the job, you will get a different output file; this is useful to re-run the same job over and over without having to worry about file handling.  Between <code>arguments</code> and <code>output</code>, without modifying the submit file, we can run a range of jobs and record the output in different files without having to ever edit the submit file.
<p />
The next new command is <code>queue</code>:
<pre class="file">
queue 4
</pre>
This instructs condor to submit 4 identical jobs except for the process number. Process numbers are useful for managing a group of similar jobs.  It's also useful for writing scripts that need to know what "job number" it is in a group of jobs.
<p />
For example, let's say we have 1,000 different files to process.  If we had a sorted list of file names known to every job, we could simply use <code>queue 1000</code> and pass $(Process) as the argument to the job; the script would then be able to determine precisely what file it is assigned to process by looking at the corresponding entry in the list.  By having a unique, zero-based counter in our jobs, we don't have to do a lot of the coordination and "plumbing" that we would have to implement for our jobs otherwise.
<p />
Finally, this example demonstrates that one submit file can submit many, very different jobs.  After any <code>queue</code> command, you can start describing a new job which begins as a copy as a previous.  So, in our submit file, after <code>queue 4</code>, we have the following lines:
<pre class="file">
arguments = Alternate $(Cluster).$(Process)
queue 2
</pre>
<p />
This creates a new job, complete identical to the previously submitted one above the <code>queue 4</code>, except for the arguments passed to the script.  This provides a mechanism for again creating similar jobs that must differ more than the <code>$(Process)</code> trick allows. 
<p />
Once you submit this job, the output of condor_q will look something like: (pay attention to the ID column):
<pre class="screen">
[user@client ~]$ condor_submit condorg_test.submit 
Submitting job(s)......
Logging submit event(s)......
6 job(s) submitted to cluster 23078.
[user@client ~]$  condor_q 23078

-- Submitter: glidein.unl.edu : <129.93.229.144:54854> : glidein.unl.edu
 ID      OWNER            SUBMITTED     RUN_TIME ST PRI SIZE CMD               
23078.0   user        2/19 16:57   0+00:00:00 I  0   0.0  mytest.sh 23078.0  <font color="#ff0000"> # Cluster is 23078 & Process is 0. The Job ID is 23078.0 </font>
23078.1   user        2/19 16:57   0+00:00:00 I  0   0.0  mytest.sh 23078.1
23078.2   user        2/19 16:57   0+00:00:00 I  0   0.0  mytest.sh 23078.2
23078.3   user        2/19 16:57   0+00:00:00 I  0   0.0  mytest.sh 23078.3
23078.4   user        2/19 16:57   0+00:00:00 I  0   0.0  mytest.sh Alterna  <font color="#ff0000"> # Arguments were cut off, but Process did increment to 4 </font>
23078.5   user       2/19 16:57   0+00:00:00 I  0   0.0  mytest.sh Alterna
</pre>
<p />
<h1><a name="Conclusion"></a> Conclusion </h1>
In this section, we started a more complex Condor example.  The four key concepts are: <ul>
<li> Condor submit files are more than simple key/values pairs; you can include some special <em>macros</em> which are dynamic and change for each job.
</li> <li> Job clusters and processes provide an easy way for structuring and bookkeeping very similar jobs without the need to write many scripts to do this for you.  The "plumbing" is built in.
</li> <li> The <code>queue</code> command gives you the ability to submit many nearly-identical jobs from one config file.
</li> <li> Multiple jobs can be specified per submit file, and only the differences between each set of jobs needs to be described.
</li></ul> 
<p />
So far, the only files we move about are the executable, stderr, and stdout.  We have not tackled jobs which perform more complex data handling - processing input or handling output, or moving files in general.  This will be done in the next section.
<p />
<h1><a name="References"></a> References </h1> <ul>
<li> The <a href="http://www.cs.wisc.edu/condor/manual/v7.4/condor_submit.html" target="_top">documentation for condor_submit</a> will show you many more options you can include in your submit file.
</li> <li> The <a href="http://www.cs.wisc.edu/condor/manual/v7.4/condor_q.html" target="_top">documentation for condor_q</a> will show you a lot more you can do with condor_q. Note, for example, the <code>-globus</code> option.
</li></ul> 
<p />
<p />
<p />
<h1><a name="Comments"></a> <strong>Comments</strong> </h1>
<form method="post" action="https://twiki.opensciencegrid.org/bin/save/Documentation/CondorSubmittingMultipleJobs" enctype="multipart/form-data" name="tableappend0" id="tableappend0">
<p />
<div class="commentPlugin commentPluginPromptBox">
<table><tr valign="middle"><td><textarea  rows="3" cols="70" name="comment" wrap="soft" onfocus="if(this.value=='')this.value=''" onblur="if(this.value=='')this.value=''"></textarea></td><td><input  type="submit" value="Add comment" /></td></tr></table>
</div><!--/commentPlugin-->
<p />
<input type="hidden" name="comment_action" value="save"  />
<input type="hidden" name="comment_type" value="tableappend"  />
<input type="hidden" name="comment_index" value="0"  /></form>
<p />
<!-- CONTENT MANAGEMENT PROJECT
############################################################################################################
 DEAR DOCUMENT OWNER
 <code><b>===============</b></code>
<p />
 Thank you for claiming ownership for this document! Please fill in your <span class="twikiNewLink">FirstLast<a href="/bin/edit/Documentation/FirstLast?topicparent=Documentation.CondorSubmittingMultipleJobs" rel="nofollow" title="FirstLast (this topic does not yet exist; you can create it)">?</a></span> name here: <ul>
<li> Local OWNER = <span class="twikiNewLink">BrianBockelman<a href="/bin/edit/Documentation/BrianBockelman?topicparent=Documentation.CondorSubmittingMultipleJobs" rel="nofollow" title="BrianBockelman (this topic does not yet exist; you can create it)">?</a></span>
</li></ul> 
<p />
 Please define the document area, choose one of the defined areas from the next line
 DOC_AREA = (<span class="twikiNewLink">ComputeElement<a href="/bin/edit/Documentation/ComputeElement?topicparent=Documentation.CondorSubmittingMultipleJobs" rel="nofollow" title="ComputeElement (this topic does not yet exist; you can create it)">?</a></span>|Storage|VO|Security|User|Monitoring|General|Trash/Trash/Integration|Operations|Tier3) <ul>
<li> Local DOC_AREA       = User
</li></ul> 
<p />
 define the primary role the document serves, choose one of the defined roles from the next line
 DOC_ROLE = (<span class="twikiNewLink">EndUser<a href="/bin/edit/Documentation/EndUser?topicparent=Documentation.CondorSubmittingMultipleJobs" rel="nofollow" title="EndUser (this topic does not yet exist; you can create it)">?</a></span>|Student|Developer|SysAdmin|VOManager) <ul>
<li> Local DOC_ROLE       = Scientist
</li></ul> 
<p />
 Please define the document type, choose one of the defined types from the next line
 DOC_TYPE = (Troubleshooting|Training|Installation|HowTo|Planning|Navigation|Knowledge) <ul>
<li> Local DOC_TYPE       = Training  Please define if this document in general needs to be reviewed before release ( 1 | 0 )
</li> <li> Local INCLUDE_REVIEW = 1
</li></ul> 
<p />
 Please define if this document in general needs to be tested before release ( 1 | 0 ) <ul>
<li> Local INCLUDE_TEST   = 1
</li></ul> 
<p />
 change to 1 once the document is ready to be reviewed and back to 0 if that is not the case <ul>
<li> Local REVIEW_READY   = 1
</li></ul> 
<p />
 change to 1 once the document is ready to be tested and back to 0 if that is not the case <ul>
<li> Local TEST_READY     = 1
</li></ul> 
<p />
 change to 1 only if the document has passed the review and the test (if applicable) and is ready for release <ul>
<li> Local RELEASE_READY  = 1
</li></ul> 
<p />
<p />
 DEAR DOCUMENT REVIEWER
 <code><b>==================</b></code>
<p />
 Thank for reviewing this document! Please fill in your <span class="twikiNewLink">FirstLast<a href="/bin/edit/Documentation/FirstLast?topicparent=Documentation.CondorSubmittingMultipleJobs" rel="nofollow" title="FirstLast (this topic does not yet exist; you can create it)">?</a></span> name here: <ul>
<li> Local REVIEWER       = <span class="twikiNewLink">AlainRoy<a href="/bin/edit/Documentation/AlainRoy?topicparent=Documentation.CondorSubmittingMultipleJobs" rel="nofollow" title="AlainRoy (this topic does not yet exist; you can create it)">?</a></span> Please define the review status for this document to be in progress ( 2 ), failed ( 0 ) or passed ( 1 )
</li> <li> Local REVIEW_PASSED  = 1
</li></ul> 
<p />
<p />
 DEAR DOCUMENT TESTER
 <code><b>================</b></code>
<p />
 Thank for testing this document! Please fill in your <span class="twikiNewLink">FirstLast<a href="/bin/edit/Documentation/FirstLast?topicparent=Documentation.CondorSubmittingMultipleJobs" rel="nofollow" title="FirstLast (this topic does not yet exist; you can create it)">?</a></span> name here: <ul>
<li> Local TESTER         = <span class="twikiNewLink">MarcoMambelli<a href="/bin/edit/Documentation/MarcoMambelli?topicparent=Documentation.CondorSubmittingMultipleJobs" rel="nofollow" title="MarcoMambelli (this topic does not yet exist; you can create it)">?</a></span> Please define the test status for this document to be in progress ( 2 ), failed ( 0 ) or passed ( 1 )
</li> <li> Local TEST_PASSED    = 1
</li></ul> 
############################################################################################################
--></div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Documentation<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Documentation/GridUsersGuide" class="twikiLink">GridUsersGuide</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>CondorSubmittingMultipleJobs</span> <br />    
Topic revision: r26 - 06 Dec 2016 - 18:12:37 - <a href="/bin/view/Main/KyleGross" class="twikiLink">KyleGross</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />