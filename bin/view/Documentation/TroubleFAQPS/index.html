<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> TroubleFAQPS &lt; Documentation &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Documentation/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Documentation/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Documentation/TroubleFAQPS?_T=16 Feb 2017" type="application/x-wiki" title="edit TroubleFAQPS" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Documentation/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Documentation/TroubleFAQPS"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#FFFF99;
	}
	.patternBookView {
		border-color:#FFFF99;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <link rel="stylesheet" type="text/css" href="https://twiki.opensciencegrid.org/twiki/pub/Documentation/Tools/exercises.css">
<p />
<!-- This is the default OSG documentation template. Please modify it in -->
<!-- the sections indicated to create your topic.                        --> 
<p />
<!-- By default the title is the <span class="twikiNewLink">WikiWord<a href="/bin/edit/Documentation/WikiWord?topicparent=Documentation.TroubleFAQPS" rel="nofollow" title="WikiWord (this topic does not yet exist; you can create it)">?</a></span> used to create this topic. If  -->
<!-- you want to modify it to something more meaningful, just replace    -->
<!-- <a href="/bin/view/Documentation/TroubleFAQPS" class="twikiCurrentTopicLink twikiLink">TroubleFAQPS</a> below with i.e "My Topic".                                  -->
<p />
<h1><a name="perf_SONAR_FAQ_and_Troubleshooti"></a>  perf SONAR  FAQ and  Troubleshooting  for  OSG  and  WLCG  Instances </h1>
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#FAQ"> FAQ</a> <ul>
<li> <a href="?cover=print#My_perfSONAR_disks_are_filling_u"> My perfSONAR disks are filling up with log messages.</a>
</li> <li> <a href="?cover=print#Infrastructure_Monitoring_check"> Infrastructure Monitoring (check_mk metrics)</a>
</li></ul> 
</li></ul> 
</div>
<p />
<p />
Here  we  will  provide  details on  troubleshooting  perfSONAR  installations  for  OSG and WLCG  as well  as some additional configuration options and  a FAQ.
<p />
There are a good set of  <code>cli</code>  tools  for  perfSONAR  available.  Details on these  tools are at <a href="https://twiki.grid.iu.edu/bin/view/Documentation/Release3/NetworkPerformanceToolkit" target="_top">https://twiki.grid.iu.edu/bin/view/Documentation/Release3/NetworkPerformanceToolkit</a>    The  <code>owping</code> and <code>bwctl</code> tools  can  be  very useful  to test from your location  to  any perfSONAR instance running either  the  OWAMP or BWCTL  services  respectively.
<p />
We are maintaining a <a href="https://twiki.opensciencegrid.org/bin/view/Documentation/NetworkingTroubleShooting" target="_top">Network Troubleshooting</a> Wiki page to guide users in identifying and following up on network problems.
<p />
To further secure access to your perfSONAR web interface, we are providing a <a href="/bin/view/Documentation/SecureperfSONAR" class="twikiLink">securing the perfSONAR web</a> page (not yet tested).  
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="FAQ"></a> FAQ </span></h2>
<h3><a name="My_perfSONAR_disks_are_filling_u"></a> My perfSONAR disks are filling up with log messages. </h3>
<p />
The default logging in perfSONAR 3.4 produces a lot of output and some sites are filling their disks with logging data.  This has been reported to the perfSONAR developers and there will be fixes coming in future versions.  In the meantime you can reduce the amount of logging by doing the following.  As <code>root</code> you can locate all the relevant logger.conf files:
<pre>
&#91;root&#64;psum01 ~]# locate logger.conf
/opt/SimpleLS/bootstrap/etc/SimpleLSBootStrapClientDaemon-logger.conf
/opt/perfsonar&#95;ps/ls&#95;cache&#95;daemon/etc/ls&#95;cache&#95;daemon-logger.conf
/opt/perfsonar&#95;ps/ls&#95;registration&#95;daemon/etc/ls&#95;registration&#95;daemon-logger.conf
/opt/perfsonar&#95;ps/regular&#95;testing/etc/regular&#95;testing-logger.conf
/opt/perfsonar&#95;ps/toolkit/etc/config&#95;daemon-logger.conf
/opt/perfsonar&#95;ps/toolkit/etc/service&#95;watcher-logger.conf
/opt/perfsonar&#95;ps/toolkit/web/root/admin/administrative&#95;info/etc/logger.conf
/opt/perfsonar&#95;ps/toolkit/web/root/admin/enabled&#95;services/etc/logger.conf
/opt/perfsonar&#95;ps/toolkit/web/root/admin/ntp/etc/logger.conf
/opt/perfsonar&#95;ps/toolkit/web/root/admin/regular&#95;testing/etc/logger.conf
/opt/perfsonar&#95;ps/toolkit/web/root/gui/services/etc/logger.conf
</pre>
You can move the logging levels for DEBUG and INFO up to WARN level via:
<pre>
sed -i &#39;s/DEBUG,/INFO,/g&#39; `locate logger.conf`
sed -i &#39;s/INFO,/WARN,/g&#39; `locate logger.conf`
</pre>
<p />
Comment out the 'verbose' line from <code>/etc/owampd/owampd.conf</code>
<p />
Finally reboot:
<pre>
reboot
</pre>
<p />
<h3><a name="Infrastructure_Monitoring_check"></a> Infrastructure Monitoring (check_mk metrics) </h3> <ol>
<li> <strong>perfSONAR 3.4+ Toolkit Version</strong> metric is failing <ul>
<li> This metrics checks if your sonar is at particular version (as of Dec. 12, it checks if it's at 3.4.1). In case you're at version 3.4 (and not 3.4.1), please check if you have automatic yum updates enabled, this is strongly recommended due to security issues we have seen in the past. In case you're still running version an older version (3.3), please update and reconfigure as soon as possible following <a href="https://twiki.opensciencegrid.org/bin/view/Documentation/InstallUpdatePS" target="_top">Installation Guide</a>
</li></ul> 
</li> <li> <strong>perfSONAR Administrator Details</strong> metric is failing
</li> <li> <strong>perfSONAR BWCTL Bandwidth Test Controller</strong> metric is failing <ul>
<li> This means that we're unable to connect to your bandwidth controller port, please ensure you have correct firewall settings (especially white listed subnets allowed) as described in the <a href="https://twiki.opensciencegrid.org/bin/view/Documentation/InstallUpdatePS" target="_top">Installation Guide</a> . This can also indicate failures of bwctl daemon, please check <a href="http://www.perfsonar.net/about/faq" target="_top">http://www.perfsonar.net/about/faq</a> (e.g. <a href="http://www.perfsonar.net/about/faq/#Q22" target="_top">http://www.perfsonar.net/about/faq/#Q22</a>), you can ask for help by opening a GGUS ticket to WLCG perfSONAR support
</li></ul> 
</li> <li> <strong>perfSONAR esmond Measurement Archive</strong> metric is failing <ul>
<li> This means that your measurement archive is not accessible, there can be many possible causes (disk full, httpd not running or inaccessible, etc.), you can ask for help by opening a GGUS ticket to WLCG perfSONAR support.
</li></ul> 
</li> <li> <strong>perfSONAR Homepage</strong> is failing <ul>
<li> This means the toolkit's homepage is inaccessible, please check for usual causes (disk full, httpd not running or blocked), we need to be able to access your homepage via HTTP or HTTPS
</li></ul> 
</li> <li> <strong>perfSONAR Latitude/Longitude Configured</strong> is failing
</li> <li> <strong>perfSONAR Mesh Configuration</strong> is failing <ul>
<li> This indicates that you're missing the recommended mesh configuration. Please configure your mesh URL(s) in <strong>/opt/perfsonar_ps/mesh_config/etc/agent_configuration.conf</strong>.  We have a new <code>auto-mesh</code> capability now and all sites should set:
</li> <li> Set this to <code>https://myosg.grid.iu.edu/pfmesh/mine/hostname/&lt;FQDN&gt;</code>    Replace <code>&lt;FQDN&gt;</code> with the fully qualified domain name of your host, e.g., <code>psum01.aglt2.org</code>.  Values for each instance are <a href="http://grid-monitoring.cern.ch/perfsonar_config.txt" target="_top">in this list</a>.
</li> <li> <pre>
&#60;mesh&#62;
      configuration&#95;url https://myosg.grid.iu.edu/pfmesh/mine/hostname/psum01.aglt2.org
      validate&#95;certificate 0
      required 1
&#60;/mesh&#62;
</pre>
</li> <li> Please REMOVE any old mesh configuration, this metric will also fail in case you have both the new mesh config and the old mesh URLs
</li></ul> 
</li> <li> <strong>perfSONAR NTP Service</strong> is failing <ul>
<li> This indicates that NTP service is not running correctly on your sonar, please note that NTP is critical service. Please refer to <a href="http://www.perfsonar.net/about/faq/" target="_top">http://www.perfsonar.net/about/faq/</a> 
</li></ul> 
</li> <li> <strong>perfSONAR Regular Testing Service</strong> is failing  <ul>
<li> This indicates that regular testing service is not working, please try to enable/disable it following <a href="http://docs.perfsonar.net/manage_regular_tests.html#disabling-enabling-regular-tests" target="_top">http://docs.perfsonar.net/manage_regular_tests.html#disabling-enabling-regular-tests</a> 
</li> <li> In case the issue persists, please open ticket to WLCG perfSONAR SU in GGUS
</li></ul> 
</li> <li> <strong>perfSONAR Toolkit Version</strong> is failing <ul>
<li> This metrics checks if your sonar is at particular version (as of Dec. 12, it checks if it's at 3.4.1). In case you're at version 3.4 (and not 3.4.1), please check if you have automatic yum updates enabled, this is strongly recommended due to security issues we have seen in the past. In case you're still running version an older version (3.3), please update and reconfigure as soon as possible following <a href="https://twiki.opensciencegrid.org/bin/view/Documentation/InstallUpdatePS" target="_top">Installation Guide</a>
</li></ul> 
</li> <li> There are <strong>many tests failing</strong> for given sonar, where should I start <ul>
<li> Please update and reconfigure your sonar following <a href="https://twiki.opensciencegrid.org/bin/view/Documentation/InstallUpdatePS" target="_top">Installation Guide</a>. Please ensure firewall doesn't block access from the whitelisted subnets that are required for the infrastructure monitoring to work. 
</li></ul> 
</li> <li> <strong>Where can I get support on managing WLCG perfSONAR</strong> <ul>
<li> You can open ticket in GGUS to WLCG perfSONAR support unit or contact directly wlcg-perfsonar-support (at cern.ch)
</li></ul> 
</li> <li> <strong>perfSONAR esmond Freshness Latency/Bandwidth Direct</strong> is failing or gives warning <ul>
<li> This metric checks freshness of the local measurement archive, in particular it checks if it contains fresh results for all the configured tests. This metric is needed to determine if we're able to consistently get results from perfSONAR boxes in WLCG. Currently it's a non-critical test, you can ignore it.
</li></ul> 
</li> <li> <strong>perfSONAR esmond Freshness Latency/Bandwidth Reverse</strong> is failing or gives warning <ul>
<li> This metric checks freshness of the local measurement archive, in particular it checks if it contains fresh results for all the configured reverse tests (reverse test is any test that is done from remote to local sonar). This metric is needed to determine if we're able to consistently get results from perfSONAR boxes in WLCG. Currently it's a non-critical test, you can ignore it.
</li></ul> 
</li> <li> <strong>perfSONAR NDT HTTP Network Diagnostic Tester</strong> and/or <strong>perfSONAR NDT P Network Diagnostic Tester</strong> and/or <strong>perfSONAR NPAD Network Path and Application Diagnosis</strong> are failing <ul>
<li> Both metrics check if you have disabled NDT and NPAD as we recommend in the <a href="https://twiki.opensciencegrid.org/bin/view/Documentation/InstallUpdatePS" target="_top">Installation/Update Guide</a>. Please follow the guide to disable this service.
</li></ul> 
</li> <li> <strong>perfSONAR Toolkit Memory</strong> is failing <ul>
<li> Starting with perfSONAR version 3.4, the minimal required memory is at least 4GBs. In case hardware update is not possible for your sonars, we can still use them to run on demand tests for debugging purposes, but we won't be able to run any baselining activities.
</li></ul> 
</li></ol> 
<p />
<p />
<p />
<p />
<hr />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Backlinks"></a>  Backlinks </span></h2>
<p />
<hr/>
Twiki topics in <a href="/bin/view/Documentation/WebHome" class="twikiCurrentWebHomeLink twikiLink">Documentation</a> web containing an "INCLUDE" of this page: <br />     
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table1" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> Section </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLast"> Topic </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol twikiLast"> Last Updated by </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<div class="patternSearchResultCount">Number of topics: <span class="twikiSearchResultCount">0</span></div><!--/patternSearchResultCount--><p />
<p />
<p />
Twiki topics in all others webs containing an "INCLUDE" of this page: <br />     
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table2" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> Section </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLast"> Topic </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol twikiLast"> Last Updated by </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
<p />
<p />
<a href="/twiki/bin/oops/Documentation/TroubleFAQPS?template=backlinksweb" target="_top">All references to this document in the <strong>Documentation</strong> web only</a>  <br />      <a href="/twiki/bin/oops/Documentation/TroubleFAQPS?template=backlinksallwebs" target="_top">All references to this document in <strong>all</strong> webs</a>
<p />
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Child_Topics"></a>  Child Topics </span></h2>
<p />
<strong><em>Immediate children of this topic include the following:</em></strong>
<ul><li><a href="/bin/view/Documentation/SecureperfSONAR">SecureperfSONAR</a> </ul>
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Major_Updates"></a>  Major Updates </span></h2>
<p />
<p />
-- <a href="/bin/view/Main/ShawnMcKee" class="twikiLink">ShawnMcKee</a> - 16 Oct 2014</div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Documentation<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><span class="twikiNewLink">MeetingNotesMar28<a href="/bin/edit/Documentation/MeetingNotesMar28?topicparent=Documentation.TroubleFAQPS" rel="nofollow" title="MeetingNotesMar28 (this topic does not yet exist; you can create it)">?</a></span> &gt; <a href="/bin/view/Documentation/TwikiWebs" class="twikiLink">TwikiWebs</a> &gt; <a href="/bin/view/Documentation/NetworkingInOSG" class="twikiLink">NetworkingInOSG</a> &gt; <a href="/bin/view/Documentation/DeployperfSONAR" class="twikiLink">DeployperfSONAR</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>TroubleFAQPS</span> <br />    
Topic revision: r12 - 02 Jun 2015 - 09:56:19 - <span class="twikiNewLink">MarianBabik<a href="/bin/edit/Main/MarianBabik?topicparent=Documentation.TroubleFAQPS" rel="nofollow" title="MarianBabik (this topic does not yet exist; you can create it)">?</a></span>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />