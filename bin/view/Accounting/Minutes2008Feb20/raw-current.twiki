---+!!&lt;nop&gt;%TOPIC%
%TOC%

---++Introduction

Minutes of Gratia meeting
   * Last meeting: [[Minutes2008Feb13][Februrary 13]]
   * Previous meetings: MeetingMinutes
   * Coordinates: Wednesday at 1:30pm CST/CDT, 1-510-665-5437 and use the meeting ID: 2966. 

---++Attending

TBA.
&lt;!--

   * [[Main.PenelopeConstanta][Penelope Constanta]].
   * [[Main.ChrisGreen][Chris Green]].
   * [[Main.JeffreyMack][Jeff Mack]].
   * [[Main.StevenTimm][Steve Timm]].
   * [[Main.JohnWeigand][John Weigand]].

---++Apologies
   * [[Main.PhilippeCanal][Philippe Canal]].
   * [[mailto:karunach@nhn.ou.edu][Karthik Arunachalam]].

   * Diana Bonham.
   * [[Main.PhilippeCanal][Philippe Canal]].
   * [[Main.PenelopeConstanta][Penelope Constanta]].
   * [[Main.ChrisGreen][Chris Green]].
   * [[Main.JeffreyMack][Jeff Mack]].
   * [[Main.StevenTimm][Steve Timm]].
   * John Urish.
   * Margherita Vittone.
   * [[Main.JohnWeigand][John Weigand]].
   * [[mailto:karunach@nhn.ou.edu][Karthik Arunachalam]].

--&gt;

---++Action items from previous meeting:

---++DB and Schema issues

---++OSG Issues

---++Collector

Penelope:
For the integration of Margherita&#39;s code with the current gratia-administation pages to support login/logout and displaying menus according to role. Setup of gratia-vm02 and gratiax21 is complete. Both accept hhtps connections, connecting to gratiax21 requires confirmation that this the correct site as I used the same host certificate as on gratia-vm02....

John:
Have had email discussions involving Margherita and Penelope as
to test error conditions to set up on the gratiax34 VOMS server
and how/what to report.  VOMS is not to informative as to
any error condition.  My current suggestion is to generate
something like:

&quot;System Error in attempting to contact VOMS server
($VOMS_SERVER_NAME).  Contact your Gratia administrator ($EMAIL_ADDRESS) 
for assistance.&quot;

... with EMAIL_ADDRESS coming from the monitor.to.address0 parameter
of the service-configuration.properties file.  Or we can create a new 
parameter.


VDT configure_gratia script
-----------------------------
I discovered that the VDT configure_gratia script (for reporting)
was never updated to include the creation os the cron service for
the static reports.  Modified the script to include this and tested
it on gratiax33.   I am not sure what to do with it, but I&#39;m thinking
of creating a vdt directory in CVS, and including it there.

I tested again the static reports on gratiax33 and they appear to
have the same problem as on the v0.32 cutover.  I have not had
a chance to investigate if it is caused by my method of updating
with the latest build or another problem.

---++Report development
Jeff: Completed (with Philippe) updating Process Accounting Requirements document.
Finished set of process accounting reports for next Tuesday&#39;s briefing. There&#39;s at least one more that I will build if time permits.
Built report with technique for building x-axis with dates from date table rather than from EndTime date values in usage records. This eliminates problems with missing date values on x-axis.

Penelope:
Timestamp logging completed. Fixed minor problem with jsp code that called birt (it was called twice costing about 1.2sec). 

Birt training was canceled as Jeff and I are pasted the initial training that was available. This was exchanged for two days of birt developer&#39;s time (via phone or video conference) and one person training for Birt 2.2.2 when available. 

---++Probes

John/Chris: GRAM Trash/Auditing is still required for the non delegating GT4 jobs.

Chris: Where should I store the name of the VO as coming from the FQAN.
Philippe: Store it in VOName in the form (Fermilab/MiniBoone) to re-use the existing stuff.

Chris: How should I record the DN (slash vs comma)
All: since slash is the most common, let use that, see if Condor probe can be changed to also use the slash
and then we will have to deal with the legacy entries.

---++Test Bed

Test environment for MySql Replication Testing
-------------------------------------------------
1. Steve Timm made  gratiax22 and gratiax23 available with host/http 
certs for use in testing replication.

2. John Urish then installed a v0.32 Collector/Reporting on both from 
the VDT install scripts
    - on both nodes, the VDT_LOCATION (installation directory) is
       /usr/local/osg-collector.
    - MySql DB in a VDT environment is in
        $VDT_LOCATION /vdt-app-data/mysql5/var
    - urls:
        
http://gratiax22.fnal.gov:8880/gratia-administration/administration.html
        http://gratiax22.fnal.gov:8880/gratia-reporting/
        
http://gratiax23.fnal.gov:8880/gratia-administration/administration.html
        http://gratiax23.fnal.gov:8880/gratia-reporting/

3,  The intent is to replicate from x22 to x23.
   - gratiax22 is populated with approx 12K records from gratiax33
   - gratiax23 has no data.

4. Backup/recovery points.
   - The installation scripts take a simple file system back of the 
MySql database at
      points.  These can be used to start over.  The backups are in:
        VDT_LOCATION/vdt-app-data/mysql5   as (the file name says it all)

drwxr-xr-x  5 mysql mysql 4096 Feb 15 09:56 var
drwxr-xr-x  5 mysql mysql 4096 Feb 15 09:54 var.no-gratia-tables
drwxr-xr-x  5 mysql mysql 4096 Feb 15 09:56 var.w-empty-gratia-tables

     Additionally, on x22, a backup was taken after the 12K records were
     populated in the database.

drwxr-xr-x  5 mysql mysql 4096 Feb 15 11:15 var.backup

    This is to facilitate restarting tests from scratch with minimal 
effort.  For
    example, to recover x22 to the point go a populated DB, you would:
    a. stop Tomcat and MySql by:
          &gt; source /usr/local/osg-collector/setup.sh
          &gt; vdt-control --off  tomcat-55
          &gt; vdt-control --off  mysql5
          &gt; cd /usr/local/osg-collector/vdt-app-data/mysql5
          &gt; rm -rf  ./var/*
          &gt; scp -pr ./var.backup/*  ./var/.
          &gt; vdt-control --on  mysql5
          &gt; vdt-control --on  tomcat-55

5. Using the mysql client in a VDT installed collector.
    Due to the way in which VDT has setup this installation of gratia, 
there is
    small hurdle to overcome since they download 2 versions of MySql.
    This issue is with the socket the client uses.

    &gt; source /usr/local/osg-collector/setup.sh
    &gt; mysql --socket 
/usr/local/osg-collector/vdt-app-data/mysql5/var/mysql.sock 
--host=localhost --port=49152 -u root gratia

---++Any Other Business

APEL-WLCG interface
-------------------------
1. Updated the Normalization factors for AGLT23.
2. Modified the LCG.py script.
    - The search of atlas data for the &#39;Unknown&#39; VO was taking 5 
minutes/ site.
    - the entire process taking over 3 hours sometimes due to conflicts 
with the mysqlhotcopy&#39;s (2 of them everyone out for 2 hours each night)
    - Changed to do a single (7 minute) query for all sites in the time 
period with unknown VOs and process only  those APEL-WLCG sites that have
data.  Only 1 in the last 2 months.  This reduced the elapsed time to 25 minutes.
    - implemented 2/19
3. While doing #2 above discovered a means of overriding the MySql
     optimizer which sometimes is not the most intelligent of processes.
     If you specify the select as &quot;SELECT  STRAIGHT_JOIN....&quot;, MySql will
     use the order in which you construct the sql either explicitly or implicitly.

John:
VOMS parser effort estimate
-------------------------------
No progress.
I still need to talk to Igor and Tanya.

---++To be discussed later:

---++DB Engine Discussion.

The estimate of 3 to 14 FTE months to translate to Postgres is accepted as being correct (or at least of the ballpark).

Summary Of Advantages:
&lt;verbatim&gt;
           MyISam                                   InnoDB                                           Postgress
good
          not much to do                         Transactions                                   Transactions
                                                          referential integrity                          referential integrity
                                                         MySQL -&gt; skills in the Gratia team      well know backup/recovery procedure
                                                         VDT                                                a lot of expertise in the LSCS.
bad
          no transaction -&gt; data loss.       [no clear backup strategy](striked)     conversion is non trivial
          no referential integrity.               (Debatable)                                      lack of skills in Gratia team
          locks-up.                                   VDT                                               VDT
&lt;/verbatim&gt;

Igor:  Before we can make a final decision we need to be looking at the overall pictures (Gratia and Department), this picture can not be completely resolved until the OSG requirement and SLA agreement are finalized.

Philippe: I am not seeing which part of the agreement will might significantly affect the decision.  Our current code is ready to take advantage of InnoDb.  I would like to take a decision sooner rather than later.

Igor: still I am think it is important to wait for the agreement.

Action Items: Write down Innodb backup strategy.  Calculate number for backup and recovery time.

Action Items: Diana works on schema review.
