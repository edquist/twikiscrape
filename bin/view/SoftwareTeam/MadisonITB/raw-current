<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> MadisonITB &lt; SoftwareTeam &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/SoftwareTeam/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/SoftwareTeam/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/SoftwareTeam/MadisonITB?_T=16 Feb 2017" type="application/x-wiki" title="edit MadisonITB" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/SoftwareTeam/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/SoftwareTeam/MadisonITB"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiPref.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twiki_edit.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern_edit.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">
#patternTopBar,
#patternTopBarContentsOuter {
	height:95px; /* top bar height; make room for header columns */
}
#twikinetTopToolBar,
#twikinetTopToolBar table {
	top:95px; /* top bar height */
	height:48px;
}
#patternClearHeaderCenter,
#patternClearHeaderLeft,
#patternClearHeaderRight {
	height:144px; /* 95 + border + 48 */
}
#twikinetLogo {
	position:absolute;
	width:100%;
	height:95px;
}
#twikinetLogo a {
	position:absolute;
	display:block;
	width:179px;
	height:65px;
	background:none;
	top:10px;
	left:340px;
}
#twikinetLogo a:link, 
#twikinetLogo a:visited {
	border:none;
}
#twikinetLogo a:hover {
	border-style:none none solid none;
	border-width:1px;
	border-color:#c4cbd6;
}
#twikinetLogo a span {
	display:none;
}
#patternOuter {
	margin-left:220px;
}
#patternLeftBar {
	width:220px;
	margin-left:-220px;
}
</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#DDDDDD;
	}
	.patternBookView {
		border-color:#DDDDDD;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternRawViewPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternWrapper"><div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain"><div id="patternClearHeaderCenter"></div>
<div id="patternMainContents"><div class="patternTop"><span class="patternHomePath"><span class="patternHomePathTitle">You are here: </span> <a href="/bin/view/Main/WebHome" class="twikiLink">TWiki    </a><span class='twikiSeparator'>&gt;</span><img src="/twiki/pub/TWiki/TWikiDocGraphics/web-bg-small.gif" border="0" alt="" width="13" height="13" style="background-color:#DDDDDD" />&nbsp;<a href="/bin/view/SoftwareTeam/WebHome">SoftwareTeam Web</a><span class='twikiSeparator'>&gt;</span><a href="/bin/view/SoftwareTeam/InternalDocs" class="twikiLink">InternalDocs</a><span class='twikiSeparator'>&gt;</span><a href="https://twiki.opensciencegrid.org/bin/view/SoftwareTeam/MadisonITB" title='Topic revision: 39 (16 Feb 2017 - 16:06:58)'>MadisonITB</a> <span class='patternRevInfo'>(16 Feb 2017, <a href="/bin/view/Main/BrianLin" class="twikiLink">BrianLin</a>)</span> (raw view)</span><!-- /patternHomePath--></div><!--/patternTop--><div class="twikiContentHeader"></div><div class="patternContent"><div class="patternTopic"> <textarea name=""  rows="22    " cols="70    " readonly="readonly" style="width: 99%    " id="topic" class="twikiTextarea twikiTextareaRawView">&lt;style type=&quot;text/css&quot;&gt;pre em { color: red; font-weight: normal; font-style: normal; }&lt;/style&gt;

---+ Software/Release Team ITB Site Design

%TOC{depth=&quot;2&quot;}%

---++ Madison ITB Machines

All physical hosts are located in 3370A in the VDT rack.

| *Host* | *Purpose* | *OS* | *Arch* | *CPU Model* | *CPUs* | *RAM* | *Storage* | *Notes* |
| %RED%itb-data1%ENDCOLOR% | worker node | SL 6.3 | x86 64-bit | Celeron G530 2.4Ghz | 2 / 2 | 8 GB | 750 GB &amp;times; 2 (SW RAID 1) | planned as HDFS data node |
| %RED%itb-data2%ENDCOLOR% | worker node | SL 6.3 | x86 64-bit | Celeron G530 2.4Ghz | 2 / 2 | 8 GB | 750 GB &amp;times; 2 (SW RAID 1) | planned as HDFS data node |
| %RED%itb-data3%ENDCOLOR% | worker node | SL 5.8 | x86 64-bit | Celeron G530 2.4Ghz | 2 / 2 | 8 GB | 750 GB &amp;times; 2 (SW RAID 0) | planned as HDFS data node |
| %RED%itb-data4%ENDCOLOR% | worker node | SL 6.3 | x86 64-bit | Xeon E3-1220 3.10GHz | 2 / 4 | 8 GB | 750 GB &amp;times; 2 (SW RAID 1) | planned as !XRootD data node |
| %RED%itb-data5%ENDCOLOR% | worker node | SL 6.3 | x86 64-bit | Xeon E3-1220 3.10GHz | 2 / 4 | 8 GB | 750 GB &amp;times; 2 (SW RAID 1) | planned as !XRootD data node |
| %RED%itb-data6%ENDCOLOR% | worker node | SL 5.8 | x86 64-bit | Xeon E3-1220 3.10GHz | 2 / 4 | 8 GB | 384 GB in /var/lib/condor/execute | planned as !XRootD data node |
| itb-host-1 | KVM host | SL 7.3 | x86 64-bit | Xeon E5-2450 2.10GHz | 16 / 32 | 64 GB | 1 TB &amp;times; 4 (HW RAID 5) | |
| &amp;nbsp;&amp;middot;&amp;nbsp; itb-ce1 | HTCondor-CE, CM | SL 6.8 | x86 64-bit | VM | 4 | 6 GB | 192 GB | |
| &amp;nbsp;&amp;middot;&amp;nbsp; %RED%itb-glidein%ENDCOLOR% | !GlideinWMS VO frontend? | SL 6.3 | x86 64-bit | VM | 3 | 6 GB | 50 GB | |
| &amp;nbsp;&amp;middot;&amp;nbsp; %RED%itb-gums-rsv%ENDCOLOR% | GUMS, RSV | SL 6.3 | x86 64-bit | VM | 3 | 6 GB | 50 GB | |
| &amp;nbsp;&amp;middot;&amp;nbsp; %BLUE%itb-hdfs-name1%ENDCOLOR% | &amp;mdash; (so far) | SL ? | x86 64-bit | VM | 4 | 6 GB | 192 GB | |
| &amp;nbsp;&amp;middot;&amp;nbsp; %RED%itb-hdfs-name2%ENDCOLOR% | &amp;mdash; (so far) | SL 6.3 | x86 64-bit | VM | 3 | 6 GB | 50 GB | |
| &amp;nbsp;&amp;middot;&amp;nbsp; %RED%itb-se-hdfs%ENDCOLOR% | &amp;mdash; (so far) | SL 6.3 | x86 64-bit | VM | 3 | 6 GB | 50 GB | |
| &amp;nbsp;&amp;middot;&amp;nbsp; %RED%itb-se-xrootd%ENDCOLOR% | &amp;mdash; (so far) | SL 6.3 | x86 64-bit | VM | 3 | 6 GB | 50 GB | |
| &amp;nbsp;&amp;middot;&amp;nbsp; itb-submit | HTCondor submit | SL 6.8 | x86 64-bit | VM | 4 | 6 GB | 192 GB | |
| &amp;nbsp;&amp;middot;&amp;nbsp; %BLUE%itb-xrootd%ENDCOLOR% | &amp;mdash; (so far) | SL ? | x86 64-bit | VM | 4 | 6 GB | 192 GB | |
| itb-host-2 | worker node | SL 6.8 | x86 64-bit | Xeon E5-2450 2.10GHz | 16 / 32 | 64 GB | 352 GB in $(EXECUTE) | |
| itb-host-3 | worker node | SL 7.3 | x86 64-bit | Xeon E5-2450 2.10GHz | 16 / 32 | 64 GB | 352 GB in $(EXECUTE) | |

(Data last updated 2017-02-03 by Tim C. %RED%Red%ENDCOLOR% indicates a host that has yet to be rebuilt; %BLUE%Blue%ENDCOLOR% is rebuilt but currently off.)


---++ ITB Goals, Revisited 2016-11-03

Roughly in order of priority, at least for the top few items.

   * Test pre-release builds of HTCondor and HTCondor-CE in an OSG context
      * Install software and run jobs as soon as possible after a pre-release
      * An implementation idea: Maybe have more than one CE and/or HTCondor instance? One for &amp;ldquo;production&amp;rdquo; and one for rapid testing
   * Add the ability to create and control job pressure locally
      * Run all the time? Some of the time? Most of the time, but be able to drain or spike on demand?
      * Maybe add a VO front-end?
   * Review and significantly tighten firewall rules on ITB hosts
   * Add HTCondor-CE-Bosco to the overall site plan, so that we can test it, too
   * Test the OSG stack before release (i.e., updates out of osg-prerelease)
   * Have a mix of EL6 and EL7 execute hosts and user jobs to test EL&amp;nbsp;6&amp;rarr;7 migration
   * Test other batch systems
      * Slurm
      * PBS, in some flavor
      * LSF and SGE usage is waning in the field, so they are lowest priority
   * Add other types of hosts (e.g., VO frontend, storage, RSV, squid, etc.)
      * Current HDFS/XRootD nodes could be repurposed or we could spin up new VMs on =itb-host-1=
      * We could potentially run our own factory in the future
   * Investigate whether there is a way to switch easily between ITB and production pilots and payloads
   * Test large-customer specific workflows (e.g., LIGO)
   * Investigate monitoring/testing setup for site verification
      * Ask sites (e.g., UNL) for their solutions
   * Flexible site installation
      * Configuration management for production and/or base hosts (logins, ntpd, repo RPMs, etc.)
      * Determine upgrade procedure: do we upgrade the hosts in place with the option of reverting to production images or do we hotswap production machines with freshly installed testing machines


---++ Configuration

Basic host configuration is handled by Ansible and a local Git repository of playbooks.

---+++ Git Repository

The authoritative Git repository for Madison ITB configuration is =gitolite@git.chtc.wisc.edu:osgitb=. Clone the repository and push validated changes back to it.

---+++ Ansible

The =osghost= machine has Ansible 2.2.0.0 installed via RPM. Use other hosts and versions at your own risk.

---++++ Common Ansible commands

*Note:*
   * For critical passwords, see Tim C. or other knowledgeable Madison OSG staff in person.
   * All commands below are meant to be run from the =osgitb= directory from Git.

To run Ansible for the first time on a new machine:

&lt;pre class=&quot;screen&quot;&gt;ansible-playbook secure.yml -i inventory -u root -k --ask-vault-pass -f 20 -l &lt;em&gt;HOST-PATTERN&lt;/em&gt;
ansible-playbook site.yml -i inventory -u root -k --ask-vault-pass -f 20 -l &lt;em&gt;HOST-PATTERN&lt;/em&gt;&lt;/pre&gt;

The &lt;em&gt;HOST-PATTERN&lt;/em&gt; can be a glob-like pattern or a regular expression that matches host names in the inventory file; see Ansible documentation for details.

After initial successful runs of both playbooks, subsequent runs should replace the =-u root -k= part with =-bK= to use your own login and =sudo=. For example:

&lt;pre class=&quot;screen&quot;&gt;ansible-playbook secure.yml -i inventory -bK --ask-vault-pass -f 20 -l &lt;em&gt;HOST-PATTERN&lt;/em&gt;
ansible-playbook site.yml -i inventory -bK -f 20 &lt;em&gt;[ -l HOST-PATTERN ]&lt;/em&gt;&lt;/pre&gt;

Omit the =-l= option to apply configuration to all hosts.

If you have your own playbook to manage personal configuration, run it as follows:

&lt;pre class=&quot;screen&quot;&gt;ansible-playbook &lt;em&gt;PLAYBOOK-PATH&lt;/em&gt; -i inventory -f 20 &lt;em&gt;[ -l HOST-PATTERN ]&lt;/em&gt;&lt;/pre&gt;

---++++ Adding host and other certificates

(This is in very rough form, but the key bits are here.)

   1. Ask Mat to get new certificates&amp;nbsp;&amp;mdash; be sure to think about =http=, =rsv=, and other service certificates
   1. Wait for Mat to tell you that the new certificates are in =/p/condor/home/certificates=
   1. =scp -p= the certificate(s) (&lt;code&gt;*cert.pem*&lt;/code&gt; and &lt;code&gt;*key.pem&lt;/code&gt;) to your home directory on =osghost= or whatever machine you use for Ansible
   1. Find the corresponding certificate location(s) in the Ansible =roles/certs/files= directory
   1. =cp -p= the certificate files over the top of the existing Ansible ones (or create new, equivalent paths)
   1. Run =ansible-vault encrypt FILE(S)= to encrypt the files&amp;nbsp;&amp;mdash; get the Ansible vault password from Tim&amp;nbsp;C. if you need it
   1. Verify permissions, contents (you can =cat= the encrypted files), etc.
   1. Apply the files with something like =ansible-playbook secure.yml -i inventory -bK -f 20 -t certs=
   1. Commit changes (now or after applying)
   1. Push changes to origin

---++++ Doing yum updates

   1. Check to see if updates are needed and, if so, what would be updated: &lt;pre class=&quot;screen&quot;&gt;ansible &lt;em&gt;[ HOST | GROUP ]&lt;/em&gt; -i inventory -bK -f 20 -m command -a &#39;yum check-update&#39;&lt;/pre&gt;\
       &lt;p&gt;You can name a single =HOST= or an inventory =GROUP= (such as the handy =current= group); with a group, you can further restrict the hosts with a =-l= option.&lt;/p&gt;\
       &lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; =yum check-update= exits with status code =100= when it succeeds in identifying packages to update; presumably, Ansible will show these results as failures.&lt;/p&gt;
   1. Review the package lists to be updated and decide whether to proceed with all updates or limited ones
   1. Do updates (cat: =ansible= command to come when I actually do this)

---++ Monitoring

---+++ HTCondor-CE View

Once we sort out our firewall rules, pilot, VO, and schedd availability graphs should be available [[http://itb-ce1.chtc.wisc.edu:59619][here]] through HTCondor-CE View.

---+++ Tracking payload jobs via Kibana

At this time, the easest way to verify that payload jobs are running within the glideinWMS pilots is to track their records via &lt;literal&gt;&lt;a href=&quot;https://gracc.opensciencegrid.org/kibana/app/kibana#/discover?_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now%2Fw,mode:quick,to:now%2Fw))&amp;_a=(columns:!(_source),index:%27gracc.osg-itb.raw-*%27,interval:auto,query:(query_string:(analyze_wildcard:!f,query:%27*%27)),sort:!(EndTime,desc))&quot;&gt;Kibana&lt;/a&gt;&lt;/literal&gt;. To view all payload jobs that have run on our ITB site in the past week, use &lt;literal&gt;&lt;a href=&quot;https://gracc.opensciencegrid.org/kibana/app/kibana#/discover?_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now%2Fw,mode:quick,to:now%2Fw))&amp;_a=(columns:!(ProbeName),index:%27gracc.osg-itb.raw-*%27,interval:auto,query:(query_string:(analyze_wildcard:!f,query:%27ResourceType:%20Payload%20AND%20ProbeConfig:%20%22condor:itb-ce1.chtc.wisc.edu%22%27)),sort:!(EndTime,desc))&quot;&gt;this query&lt;/a&gt;&lt;/literal&gt;. 

---++ Making a New Virtual Machine on itb-host-1

For this procedure, you will need login access to the CHTC Cobbler website, which is separate from other CHTC logins. If you do not have an account, request one from the CHTC system administrators.

   1. If this is a new host (combination of MAC address, IP address, and hostname), set up host with CHTC Infrastructure
      1. Pick a MAC address, starting with =00:16:3e:= followed by three random octets (e.g., =00:16:3e:f7:29:ee=)
      1. Email htcondor-inf@cs.wisc.edu with a request for a new OSG ITB VM, including the chosen MAC address
      1. Wait to receive the associated IP address for the new host
   1. Create or edit the Cobbler system object for the host
      1. Access https://cobbler-widmir.chtc.wisc.edu/cobbler_web
      1. In the left navigation area, under “Configuration”, click the “Systems” link
      1. For a new host, click the “Create New System” button; for an existing host, filter by “Name” for the fully qualified hostname then click “Edit” to the right of the entry
      1. In the *first* “General” section: select a “Profile” of “Scientific_6_8_osg_vm” or “Scientific_7_2_osg_vm”
      1. In the *second* “General” section, check the “Netboot Enabled” checkbox
      1. In the “Networking (Global)” section, set “Hostname” to the fully qualified hostname for the virtual machine
      1. In the “Networking” section, select the “eth0” interface to edit, and set the “MAC Address”, “IP Address”, and “DNS Name” fields for the host
      1. Click the “Save” button
      1. In the left navigation area, under “Actions”, click the “Sync” link
   1. Log in to =itb-host-1= and become =root=
   1. Create the libvirt definition file
      1. Create a new XML file named after the desired hostname (e.g., =itb-ce2.xml=) and copy in the template below
      1. Replace ={{ HOSTNAME }}= with the fully qualified hostname of the new virtual host
      1. Replace ={{ MAC_ADDRESS }}= with the MAC address of the new virtual host (from above)
      1. If desired, edit other values in the XML definition file; ask CHTC Infrastructure for help, if needed
      1. Save the XML file
      1. Create a new, empty disk image for the virtual host, in its correct location (as specified in the XML file):&lt;pre class=&quot;screen&quot;&gt;truncate -s 192G /var/lib/libvirt/images/&lt;em&gt;HOSTNAME&lt;/em&gt;.dd
chown qemu:qemu /var/lib/libvirt/images/&lt;em&gt;HOSTNAME&lt;/em&gt;.dd&lt;/pre&gt;
      1. Load the new host definition into libvirt:&lt;pre class=&quot;screen&quot;&gt;virsh define XML-FILE&lt;/pre&gt;
   1. Install the new machine
      1. Start the virtual machine:&lt;pre class=&quot;screen&quot;&gt;virsh start HOSTNAME&lt;/pre&gt;\
       &lt;p&gt;At this time, the machine will boot over the network, and Cobbler will install and minimally configure the OS, then reboot the now-installed machine. This whole process takes 15–20 typically. You may be able to ssh into the machine during the install process, but there is no need to monitor or interfere.&lt;/p&gt;
      1. Once the machine is available (which you can only guess at), ssh in and verify that the machine basically works
      1. Immediately run Ansible on the machine, first with the =secure.yml= playbook, then the =site.yml= one (see above)
      1. Log in to the machine and look around to make sure it seems OK
      1. When things look good, tell virsh to start the virtual machine when the host itself starts:&lt;pre class=&quot;screen&quot;&gt;virsh autostart HOSTNAME&lt;/pre&gt;

---+++ Libvirt VM Template

&lt;pre class=&quot;file&quot;&gt;
&amp;lt;domain type=&#39;kvm&#39;&amp;gt;

  &amp;lt;name&amp;gt;{{ HOSTNAME }}&amp;lt;/name&amp;gt;

  &amp;lt;memory unit=&#39;GiB&#39;&amp;gt;6&amp;lt;/memory&amp;gt;
  &amp;lt;vcpu&amp;gt;4&amp;lt;/vcpu&amp;gt;
  &amp;lt;os&amp;gt;
    &amp;lt;type&amp;gt;hvm&amp;lt;/type&amp;gt;
    &amp;lt;boot dev=&#39;network&#39;/&amp;gt;
    &amp;lt;boot dev=&#39;hd&#39;/&amp;gt;
    &amp;lt;bios useserial=&#39;yes&#39; rebootTimeout=&#39;0&#39;/&amp;gt;
  &amp;lt;/os&amp;gt;
  &amp;lt;features&amp;gt;
    &amp;lt;acpi/&amp;gt;
    &amp;lt;apic/&amp;gt;
    &amp;lt;pae/&amp;gt;
  &amp;lt;/features&amp;gt;

  &amp;lt;devices&amp;gt;

    &amp;lt;emulator&amp;gt;/usr/libexec/qemu-kvm&amp;lt;/emulator&amp;gt;

    &amp;lt;disk type=&#39;file&#39; device=&#39;disk&#39;&amp;gt;
      &amp;lt;source file=&#39;/var/lib/libvirt/images/{{ HOSTNAME }}.dd&#39;/&amp;gt;
      &amp;lt;target dev=&#39;vda&#39; bus=&#39;virtio&#39;/&amp;gt;
    &amp;lt;/disk&amp;gt;

    &amp;lt;interface type=&#39;bridge&#39;&amp;gt;
      &amp;lt;mac address=&#39;{{ MAC_ADDRESS }}&#39;/&amp;gt;
      &amp;lt;source bridge=&#39;br0&#39;/&amp;gt;
      &amp;lt;model type=&#39;virtio&#39;/&amp;gt;
    &amp;lt;/interface&amp;gt;

    &amp;lt;serial type=&#39;pty&#39;&amp;gt;
      &amp;lt;target port=&#39;0&#39;/&amp;gt;
    &amp;lt;/serial&amp;gt;
    &amp;lt;console type=&#39;pty&#39;&amp;gt;
      &amp;lt;target type=&#39;serial&#39; port=&#39;0&#39;/&amp;gt;
    &amp;lt;/console&amp;gt;

    &amp;lt;graphics type=&#39;vnc&#39; autoport=&#39;yes&#39; listen=&#39;127.0.0.1&#39;/&amp;gt;

  &amp;lt;/devices&amp;gt;
&amp;lt;/domain&amp;gt;
&lt;/pre&gt;

---++ Archive

Archived Madison ITB notes are on [[MadisonItbArchive][another page]].

---+++ Old Puppet information &amp;mdash; now obsolete and awaiting decommissioning ([[https://jira.opensciencegrid.org/browse/SOFTWARE-2559][SOFTWARE-2559]])

Configuration is managed by Puppet using the UW Center for High-Throughput Computing&#39;s Puppet server on =wid-service-1.chtc.wisc.edu=. See [[MadisonITBInstanceConfiguration]] for details.

---+++ New Puppet ideas &amp;mdash; now obsolete and not implemented

   * We maintain and build our own current (4.x) Puppet RPMs (including dependencies) for EL&amp;nbsp;6 and EL&amp;nbsp;7 based on Fedora SRPMs&amp;nbsp;&amp;mdash; this looks very doable
   * We run a Puppet Master on =osghost= or, if absolutely necessary, on a VM on =osghost=
   * Firewall rules will limit Puppet client access to the Puppet Master to a minimal range of IP addresses
   * We use public Puppet classes wherever possible (e.g., NTP from Puppet Labs)
   * When necessary, we write and maintain simple-as-possible Puppet classes for basic machine setup
   * Goals for automated configuration management:
      * Manage the system clock (i.e., a properly configured NTP daemon)
      * Manage a set of local user accounts, groups, and public SSH keys
      * Manage a =sudoers= file for local user accounts
      * Manage firewall rules
      * Install a basic set of common tools (nominations: vi, emacs)
   * In the meantime, we will write, maintain, and apply documentation to make these changes manually
</textarea> <div class="patternSigLine"><span class="twikiRight twikiMakeVisible" style="text-align:left;"><span class="twikiLeft patternTextareaButton patternButtonFontSelector" title="Switch to monotype or propotional font">&nbsp;</span><span class="twikiLeft patternTextareaButton patternButtonEnlarge" title="Enlarge edit box">&nbsp;</span><span class="twikiLeft patternTextareaButton patternButtonShrink" title="Shrink edit box">&nbsp;</span></span><br class="twikiClear" /></div><!-- /patternSigLine--></div><!-- /patternTopic-->
<div class="twikiContentFooter"></div></div><!-- /patternContent-->
<a name="topic-actions"></a><div class="twikinetRounded twikinetRoundedTopicActions"><div class="rCRounded"><div class="rCTR"><div class="rCTL"></div><!--/rCTL--><div class="patternTopicActions"><div class="patternTopicAction"><span class="patternActionButtons"><span class="patternButton"><a href='https://twiki.opensciencegrid.org/bin/edit/SoftwareTeam/MadisonITB?t=1487267584;nowysiwyg=1' rel='nofollow' title='Edit this topic text' accesskey='e'><span class='twikiAccessKey'>E</span>dit</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span class='patternButton'><a href='/bin/attach/SoftwareTeam/MadisonITB' rel='nofollow' title='Attach an image or document to this topic' accesskey='a'><span class='twikiAccessKey'>A</span>ttach</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span class='patternButton'><a href='/bin/view/SoftwareTeam/MadisonITB?cover=print;raw=on' rel='nofollow' title='Printable version of this topic' accesskey='p'><span class='twikiAccessKey'>P</span>rint version</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><span><a href='/bin/rdiff/SoftwareTeam/MadisonITB?type=history' rel='nofollow' title='View total topic history' accesskey='h'><span class='twikiAccessKey'>H</span>istory</a></span>: r39&nbsp;<a rel="nofollow" href="/bin/rdiff/SoftwareTeam/MadisonITB?rev1=39;rev2=38">&lt;</a>&nbsp;<a rel="nofollow" href="/bin/view/SoftwareTeam/MadisonITB?rev=38">r38</a>&nbsp;<a rel="nofollow" href="/bin/rdiff/SoftwareTeam/MadisonITB?rev1=38;rev2=37">&lt;</a>&nbsp;<a rel="nofollow" href="/bin/view/SoftwareTeam/MadisonITB?rev=37">r37</a>&nbsp;<a rel="nofollow" href="/bin/rdiff/SoftwareTeam/MadisonITB?rev1=37;rev2=36">&lt;</a>&nbsp;<a rel="nofollow" href="/bin/view/SoftwareTeam/MadisonITB?rev=36">r36</a>&nbsp;<a rel="nofollow" href="/bin/rdiff/SoftwareTeam/MadisonITB?rev1=36;rev2=35">&lt;</a>&nbsp;<a rel="nofollow" href="/bin/view/SoftwareTeam/MadisonITB?rev=35">r35</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/oops/SoftwareTeam/MadisonITB?template=backlinksweb' rel='nofollow' title='Search the SoftwareTeam Web for topics that link to here' accesskey='b'><span class='twikiAccessKey'>B</span>acklinks</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='https://twiki.opensciencegrid.org/bin/view/SoftwareTeam/MadisonITB' rel='nofollow' title='View topic' accesskey='v'><span class='twikiAccessKey'>V</span>iew topic</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/oops/SoftwareTeam/MadisonITB?template=oopsmore&amp;param1=39&amp;param2=39' rel='nofollow' title='Delete or rename this topic; set parent topic; view and compare revisions' accesskey='m'><span class='twikiAccessKey'>M</span>ore topic actions</a></span></span></div><!--/patternTopicAction--></div><!--/patternTopicActions--></div><!--/rCTR--><div class="rCBR"><div class="rCBL"></div><!--/rCBL--></div><!--/rCBR--></div><!--/rCRounded--></div><!--/twikinetRounded--><div class="patternInfo twikiGrayText"><div class="patternRevInfo">Topic revision: r39 - 16 Feb 2017 - 16:06:58 - <a href="/bin/view/Main/BrianLin" class="twikiLink">BrianLin</a></div><!-- /patternRevInfo--></div><!-- /patternInfo-->
</div><!-- /patternMainContents-->
</div><!-- /patternMain--><div id="patternLeftBar"><div id="patternClearHeaderLeft"></div>
<div id="patternLeftBarContents">
<head>
	<style type="text/css" media="all">
	
		.float-left {
			float:	left;
		}

		.float-right {
			float:	right;
		}

		.rounded {
      		border-radius:	 		8px;
			-moz-border-radius: 	8px;
			-webkit-border-radius:	8px;		
		}
		
		.rounded-top {
      		border-radius:	 		8px 8px 0px 0px;
			-moz-border-radius: 	8px 8px 0px 0px;
			-webkit-border-radius:	8px 8px 0px 0px;		
		}
		
		.bordered {
			border:	1px solid #AAAAAA;
		}

		.bordered-bottom {
			border-bottom:	1px solid #AAAAAA;
		}

		.high-contrast {
			color:		#FF6600;
			background: #000060;		
		}

                .low-contrast {
			color:		#FF6600;
			background: #ADD8E6;		
		}

	
		.container {
display: inline-block;
			margin:		0;
			padding:	0;
		}
		
		.box {
			display:				block;
			margin:			 0;
			padding:		0;
		}

                #head-block {
                        color:               #FF6600;	
                        background:    #333380;
                }
							
		#menu {
			font-family:	"Lucida Grande", sans-serif;
			font-size:		small;
			margin:		0px 0px 10px 0px;
			padding:	0px 0px 0.3em 0px;
			background: #EAEDF2;
		}
							
		#menul {
			font-family:	"Lucida Grande", sans-serif;
			font-size:		small;
			margin:		0px 0px 10px 0px;
			padding:	0px 0px 0.3em 0px;
			background: #F4F6F9

		}		
		#head {
			margin:		0px;
			padding:	0.2em 5px 0.2em 10px;
			font-size:	normal;
			font-weight:	bold;
			color:			#FF6600;	
		}
		
		#head a {
			text-decoration:	none;
			color:			#FF6600;	
		}

		#head a:hover {
			background: 		#EAEDF2;
			text-decoration:	none;
			color:			#FFBB00;	
		}

		#head a:visited {
			text-decoration:	none;
			color:			#FF6600;	
		}

		#head a:active {
			text-decoration:	none;
			color:			#FF6600;	
		}

		#head a:link {
			text-decoration:	none;
			color:			#FF6600;	
		}

                #iteml {
			padding:	0.1em 5px 0.0em 10px;
                }

		#iteml a {
			background: 		#F4F6F9
			text-decoration:	none;
			color:			#000044;			
		}

		#iteml a:hover {
			background: 		#F4F6F9
			text-decoration:	none;
			color:			#FF6600;			
		}
		#item {
			padding: 0.1em 5px 0.0em 10px;
		}
		
		#item a {
			background: 		#EAEDF2;
			text-decoration:	none;
			color:			#000044;			
		}

		#item a:hover {
			background: 		#EAEDF2;	
			text-decoration:	none;
			color:			#FF6600;			
		}
</style>
</head>
Hello, <a href="/bin/view/Main/TWikiGuest" class="twikiLink">TWikiGuest</a>
<a href="https://twiki.grid.iu.edu/bin/view/TWiki/TWikiRegistration" target="_top"><br/>Register</a>
<p />
<p />
<!-- Google CSE Search Box Ends
<h5><a name="Common_links"></a> Common links </h5> <ul>
<li> <a href="/bin/view/Main/WebHome" class="twikiLink">OSG TWiki home</a>
</li> <li> <a href="/bin/view/Documentation/Release3/WebHome" class="twikiLink">RPM Install guides - OSG 3.0</a>
</li> <li> <a href="/bin/view/ReleaseDocumentation/WebHome" class="twikiLink">Pacman Install guides OSG 1.2</a>
</li> <li> <a href="/bin/view/Documentation/WebHome" class="twikiLink">Technical Documentation</a>
</li> <li> <a href="/bin/view/Documentation/SiteAdminResources" class="twikiLink">Contact Info</a> 
</li> <li> <strong><a href="/bin/view/Main/ICantFindItForm" class="twikiLink">I can't find it!</a></strong>  -->
</li></ul> 
<div class="container">
<p />
    <div class="box rounded bordered" id="menu">
        <div class="box rounded-top high-contrast" id="head"><a  style="" href="/bin/view/Main/WebHome" class="twikiLink" title="Home">About the OSG</a></div>
        <div id="item"><a  style="" href="/bin/view/Documentation/UsingTheGrid" class="twikiLink" title="Instructions for Using OSG">New Users</a></div>
        <div id="item"><a href="http://myosg.grid.iu.edu/map?map_attrs_shownr=on&amp;all_sites=on&amp;active=on&amp;active_value=1&amp;disable_value=1&amp;gridtype=on&amp;gridtype_1=on" target="_top">OSG Sites</a></div>
        <div id="item"><a  style="" href="http://myosg.grid.iu.edu/vosummary?all_vos=on&amp;active=on&amp;active_value=1&amp;datasource=summary" target="_top" title="List of Virtual Organizations">OSG VOs</a></div>
        <div id="item"><a href="http://display.grid.iu.edu/" target="_top">OSG Usage Graphs</a></div>
        <div id="item"><a  style="" href="https://indico.fnal.gov/categoryDisplay.py?categId=86" target="_top" title="OSG Event Calendar">Events</a></div>
       <div id="item"><a href="/bin/view/Management/OSGOrganizationInformation" class="twikiLink">OSG Organization</a></div>
<p />
    </div>
<p />
<p />
    <div class="box rounded bordered" id="menu">
        <div class="box rounded-top high-contrast" id="head">OSG at Work</div>
        <div id="item"><a  style="" href="/bin/view/Documentation/WebHome" class="twikiLink" title="Official Documentation Home">Technical Documentation</a></div>
        <div id="item"><a href="/bin/view/Security/WebHome" class="twikiLink">Security</a></div>
        <div id="item"><a href="/bin/view/SoftwareTeam/WebHome" class="twikiCurrentWebHomeLink twikiLink">Software Team</a></div>
        <div id="item"><a href="/bin/view/Education/WebHome" class="twikiLink">Education</a></div>
        <div id="item"><a href="/bin/view/Management/WebHome" class="twikiLink">Management</a></div>
        <div id="item"><a  style="" href="/bin/view/Management/ScientificPublications" class="twikiLink" title="Scientific Publications and Citing OSG">Scientific Publications</a></div>
        <div id="item"><a href="/bin/view/Management/OSGResearchHighlights" class="twikiLink">Research Highlights</a></div>
    </div>
<p />
<p />
		<div class="box rounded bordered" id="menu">
			<div class="box rounded-top high-contrast" id="head"><a  style="" href="/bin/view/Main/WebHome" class="twikiLink" title="TWiki Main Web">Documentation Links</a></div>
			<div id="item"><a  style="" href="/bin/view/Documentation/Release3/NavContributeDocumentation" class="twikiLink" title="OSG Documentation System Information">How To Write Documents</a></div>
			<div id="item"><a  style="" href="/bin/view/Documentation/DocFormattingRules" class="twikiLink" title="Formatting OSG Documents">Formatting Documents</a></div>
                        <div id="item"><a  style="" href="/bin/view/SoftwareTeam/WebTopicCreator" class="twikiLink" title="Create a New TWiki Page"> <img width="16" alt="newtopic" align="top" src="/twiki/pub/TWiki/TWikiDocGraphics/newtopic.gif" height="16" border="0" /> Create New Topic</a></div>
                        <div id="item"><a  style="" href="/bin/view/Main/WebList" class="twikiLink" title="List of Webs"> <img width="16" alt="index" align="top" src="/twiki/pub/TWiki/TWikiDocGraphics/index.gif" height="16" border="0" /> List of Webs</a></div>
                        <div id="item"><a  style="" href="/bin/view/SoftwareTeam/WebIndex" class="twikiLink" title="Index of Topics"> <img width="16" alt="index" align="top" src="/twiki/pub/TWiki/TWikiDocGraphics/index.gif" height="16" border="0" /> Topic Index</a></div>
                        <div id="item"><a href="/bin/view/Documentation/WebTopicList" class="twikiLink"> <img width="16" alt="index" align="top" src="/twiki/pub/TWiki/TWikiDocGraphics/index.gif" height="16" border="0" /> Topic List</a></div>
                        <div id="item"><a  style="" href="/bin/view/SoftwareTeam/WebChanges" class="twikiLink" title="List of Pages that have Changed by Change Date"> <img width="16" alt="changes" align="top" src="/twiki/pub/TWiki/TWikiDocGraphics/changes.gif" height="16" border="0" /> Changes</a></div>
                        <div id="item"><a  style="" href="/bin/view/Main/TWikiUsers" class="twikiLink" title="Alphabetized List of TWiki Users"> <img width="16" alt="person" align="top" src="/twiki/pub/TWiki/TWikiDocGraphics/person.gif" height="16" border="0" /> TWiki Users</a></div>
		</div>
<p />
</div>
</div><!-- /patternLeftBarContents--></div><!-- /patternLeftBar-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--></div><!-- /patternWrapper--><div id="patternTopBar"><div id="twikinetLogo"><a href="http://www.twiki.net/"><span>TWIKI.NET</span></a></div><div id="patternTopBarContents"><div class="twikiLeft"><span id="twikiLogo" class="twikiImage"><a href="http://www.opensciencegrid.org    "><img src="/twiki/pub/Main/WebHome/osg-logo.png    " border="0" alt="OpenScience Grid Website    " style="border:none;" /></a></span></div>
<div class="twikiRight">
<table cellpadding="0" cellspacing="0" border="0"><tr><td class="twikinetSearchJump twikinetSearchJumpLeft">
 <ul>
<li> <form name="jumpForm" action="/bin/view/SoftwareTeam/MadisonITB"><input id="jumpFormField" type="text" class="twikiInputField" name="topic" value="" size="16" /><input type="submit" class="twikinetJumpButton" name="submit" value="" /></form>
</li> <li> <form name="quickSearchForm" action="/bin/view/SoftwareTeam/WebSearch"><input type="text" class="twikiInputField" id="quickSearchBox" name="search" value="" size="18" /><input type="hidden" name="scope" value="all" /><input type="hidden" name="web" value="SoftwareTeam" /><input type="submit" size="5" class="twikinetSearchButton" name="submit" value="" /></form>
</li> <li> </li></ul> 
</td>
<td class="twikinetSearchJumpRight"></td>
</tr></table><br class="twikiClear" /></div></div></div><!-- /patternTopBar--><div id="twikinetTopToolBar"><div id="twikinetTopToolBarContents"><div class="twikinetWebName twikiLeft">
<table cellpadding="0" cellspacing="0" border="0"><tr><td style="vertical-align:middle;">
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="SoftwareTeam"></a>  <a href="/bin/view/SoftwareTeam/WebHome" class="twikiCurrentWebHomeLink twikiLink">SoftwareTeam</a> </span></h2>
</td></tr></table>
</div><!--/twikinetWebName-->
<div class="twikinetToolBar twikiRight">
<table cellpadding="0" cellspacing="0" border="0"><tr><td><a href="https://twiki.opensciencegrid.org/bin/edit/SoftwareTeam/MadisonITB?t=1487267584;nowysiwyg=1" rel="nofollow">
<span class="rCRounded"><span class="rCTR"><span class="rCTL"></span><!--/rCTL-->
<span class="twikiLinkLabel twikinetEditIcon"><span class='twikiAccessKey'>E</span>dit</span>
</span><!--/rCTR--><span class="rCBR"><span class="rCBL"></span></span><!--/rCBR--></span><!--/rCRounded-->
</a></td><td><a href="/bin/attach/SoftwareTeam/MadisonITB" rel="nofollow">
<span class="rCRounded"><span class="rCTR"><span class="rCTL"></span><!--/rCTL-->
<span class="twikiLinkLabel"><span class='twikiAccessKey'>A</span>ttach</span>
</span><!--/rCTR--><span class="rCBR"><span class="rCBL"></span></span><!--/rCBR--></span><!--/rCRounded-->
</a></td><td><a href="/bin/genpdf/SoftwareTeam/MadisonITB?pdftitle=MadisonITB" rel="nofollow">
<span class="rCRounded"><span class="rCTR"><span class="rCTL"></span><!--/rCTL-->
<span class="twikiLinkLabel">PDF</span>
</span><!--/rCTR--><span class="rCBR"><span class="rCBL"></span></span><!--/rCBR--></span><!--/rCRounded-->
</a></td></tr></table>
<br class="twikiClear" /></div><!--/patternToolBar--></div><!--/twikinetTopToolBarContents--></div><!--/twikinetTopToolBar--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>