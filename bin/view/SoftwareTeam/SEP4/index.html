<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> SEP4 &lt; SoftwareTeam &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/SoftwareTeam/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/SoftwareTeam/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/SoftwareTeam/SEP4?_T=16 Feb 2017" type="application/x-wiki" title="edit SEP4" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/SoftwareTeam/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/SoftwareTeam/SEP4"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#DDDDDD;
	}
	.patternBookView {
		border-color:#DDDDDD;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <h1><a name="Software_Enhancement_Proposal_4"></a> Software Enhancement Proposal 4: Software in the OSG Job Environment </h1>
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table1" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <font color="#252b37">SEP</font> </th>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> 4 </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <font color="#252b37">Title</font> </th>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> Software in the OSG Job Environment </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <font color="#252b37">Comment Period Ends:</font> </th>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> (Not yet ready for comments) </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <font color="#252b37">Last Modified:</font> </th>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> 2010-03-17 </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <font color="#252b37">Created:</font> </th>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> 2010-03-17 </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <font color="#252b37">Author:</font> </th>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> Brian Bockelman </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <font color="#252b37">Status:</font> </th>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> Being Written </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> <font color="#252b37">Type:</font> </th>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol twikiLast"> Environment </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Proposal_What_must_true_in_an_OS"></a> Proposal: What must true in an OSG job environment </span></h2>
<p />
For any Globus-based job that is run on a OSG CE resource, the following should be true of the environment: <ol>
<li> $OSG_GRID must be defined.
</li> <li> After sourcing <code>$OSG_GRID/setup.sh</code> or <code>$OSG_GRID/setup.csh</code>, the contents of the OSG worker node software must be in the job's environment. <ul>
<li> Here, the "contents of the OSG worker node software" must include the software packages deployed by some version of the OSG wn-client package.
</li> <li> The major version number of the wn-client package must match the major version number of the OSG CE service.  Examples are given below.
</li></ul> 
</li> <li> The environment must be such that Condor-G grid_monitor functions. <ul>
<li> Practically, this means that for jobs running in jobmanager-fork, $GLOBUS_LOCATION must point to the $GLOBUS_LOCATION of the CE.
</li></ul> 
</li></ol> 
<p />
This proposal matches what many (but not all) sites are doing today. This proposal is meant to ensure that OSG agrees on what has previously been informally agreed.
<p />
Please note that we say <em>should</em> instead of <em>must</em>. We <strong>strongly encourage</strong> all sites to do these things, but we understand that in some cases you might be unable to do so, perhaps because you are running a cluster where the worker node software isn't supported (such as Windows). But we hope that nearly all sites can support these requirements.
<p />
Also, OSG should make it easy for sites to advertise what version of the worker node software has been installed (or if it hasn't been installed). As of today, this has not been provided.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Motivation"></a> Motivation </span></h2>
<p />
Experience has shown that sites are very responsive to the needs of a VO which owns the resource.  However, as opportunistic usage of the OSG has begun to accelerate, we have found that each VO has a slightly different interpretation of the job environment (for both batch system jobs and fork jobs).  This results in many VOs asking sites for different customizations to suit their needs.  Feedback from sites shows they can find these multiple, differing requests confusing - there's no clear guidance from the OSG on whether the VO requests are considered reasonable.
<p />
The primary motivation of this SEP is threefold: <ol>
<li> Manage expectations for the opportunistic VO.  This will help VOs moderate requests and understand what they can expect from an opportunistic site.
</li> <li> Inform sites of the OSG's policy.  This will provide guidance on how they should deploy OSG software in such a manner that they can satisfy most VOs.
</li> <li> Keep OSG's policy consistent.  Wiki-based documentation changes with time and policies can inadvertently be reversed.  This SEP is meant to serve as an official statement.
</li></ol> 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Expectations"></a> Expectations </span></h2>
<p />
<strong>Users</strong> can expect sites to advertise what version of the worker node software they have, and to find that version of the worker node software (as described above) for all jobs submitted to a site (both fork and batch).
<p />
<strong>Sites</strong> should expect to install the worker node software if at all possible.
<p />
<strong>The OSG software stack</strong> is expect to provide the capability to advertise the worker node software.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Actionable_Items"></a> Actionable Items. </span></h2>
<p />
The OSG does not like to "punish sites" or make central decisions for them.  However, in order to be accessible to users, we do ask sites to have commonalities in their environment. 
<p />
If a VO encounters a site that doesn't follow this policy, we recommend they file a ticket with the OSG GOC.  The GOC will follow the following actions: <ol>
<li> Work with the site to deploy their software in such a manner that it meets this policy.
</li> <li> Help the site to stop advertising access to opportunistic VOs.
</li></ol> 
<p />
We believe OSG sites are not malicious; we find them to usually be helpful and responsive.  If not in compliance with a policy or best practice, it is usually due to poor communication or documentation from the OSG, and they are happy to make changes if the OSG is willing to help them.
<p />
If a site does not want to change their software environment or remove access in the information services, OSG Operations will defer to the Executive Board to determine what action to take next.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Anti_Examples"></a> Anti-Examples </span></h2>
<p />
We want to narrowly restrict the purview of this proposal.  This proposal <ul>
<li> Does not propose to add or remove packages from the OSG WN-client.  The contents of the WN-client is a separate issue.
</li> <li> Does not say how the software should be installed.  The software components should be made available - we did not say that the pacman wn-client package must be installed. <ul>
<li> For example, if a site wants to hand-install the necessary software, and hand write their own setup.sh file, they may.  However, the OSG wouldn't be able to provide software support in such a case!
</li> <li> A site might want to meet these requirements by exporting the CE install via NFS to the worker node.  THIS IS NOT RECOMMENDED.  However, this would meet the requirements.
</li></ul> 
</li> <li> Does not require $OSG_GRID to be in the same location on the CE and worker node, or even in the same directory on all the worker nodes.
</li></ul> 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Example_software_configurations"></a> Example software configurations </span></h2>
<p />
Here are different ways that a site might meet the SEP requirements: <ol>
<li> (Recommended method #1) Install the wn-client package locally on every worker node.  Install the ce package locally on the OSG CE.  Install the wn-client package into the same directory on the OSG-CE so it is accessible to fork jobs. 
</li> <li> (Recommended method #2) Install the wn-client package in a shared-filesystem that is available as a read-only directory on all worker nodes. Also install it in the OSG-CE installation so it is accessible to fork jobs. 
</li> <li> Install the wn-client package into the CE install directory, and export the CE install directory via NFS to all worker nodes.
</li> <li> If wn-client cannot be put into the same directory name on all the worker nodes, the site may use batch-system provided hooks in order to change the value of OSG_GRID on a per-node basis.  For Condor, this can be done in the job wrapper; for PBS, this can be done in the job's prologue script.
</li></ol> </div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: SoftwareTeam<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/SoftwareTeam/WebHome" class="twikiCurrentWebHomeLink twikiLink">WebHome</a> &gt; <a href="/bin/view/SoftwareTeam/SEPIndex" class="twikiLink">SEPIndex</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>SEP4</span> <br />    
Topic revision: r4 - 22 Mar 2010 - 20:00:13 - <span class="twikiNewLink">AlainRoy<a href="/bin/edit/SoftwareTeam/AlainRoy?topicparent=SoftwareTeam.SEP4" rel="nofollow" title="AlainRoy (this topic does not yet exist; you can create it)">?</a></span>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />