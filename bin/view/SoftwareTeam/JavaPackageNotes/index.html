<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> JavaPackageNotes &lt; SoftwareTeam &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/SoftwareTeam/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/SoftwareTeam/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/SoftwareTeam/JavaPackageNotes?_T=16 Feb 2017" type="application/x-wiki" title="edit JavaPackageNotes" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/SoftwareTeam/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/SoftwareTeam/JavaPackageNotes"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#DDDDDD;
	}
	.patternBookView {
		border-color:#DDDDDD;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--TABLEPLUGIN_table1--><style type="text/css" media="all">
.tableSortIcon img {padding-left:.3em; vertical-align:text-bottom;}
</style>
<!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <h1><a name="Java_Packaging_Policy_for_Scient"></a> Java Packaging Policy for Scientific Linux 5 </h1>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Background"></a> Background </span></h2>
<p />
See:
<p /> <ul>
<li> <a href="https://jira.opensciencegrid.org/browse/SOFTWARE-3" target="_top">JIRA ticket SOFTWARE-3</a>
</li> <li> <a href="https://twiki.cern.ch/twiki/bin/view/EMI/HowToUseJavaInEMI" target="_top">How to use Java in EMI</a>
</li> <li> <a href="http://fedoraproject.org/wiki/Packaging/Java" target="_top">Fedora packaging guidelines for Java</a>
</li></ul> 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Policy"></a> Policy </span></h2>
<p />
At the most general level, the following policy is <font color="#ff0000">recommended</font>:
<p /> <ul>
<li> Follow the <a href="http://fedoraproject.org/wiki/Packaging/Java" target="_top">Fedora Packaging Guidelines for Java</a>, when possible
</li> <li> By default, use the Oracle JDK for build and installation dependencies, but allow OpenJDK for builds and installs when required
</li> <li> Rethink everything once OpenJDK 7 is out and available as the default JDK from our supported platform(s)
</li></ul> 
<p />
<strong>Reasoning:</strong> Most OSG Java packages have been built and/or tested <em>only</em> against the Oracle JDK, although some now use OpenJDK (e.g., VOMS Admin). In general (i.e., not just in OSG), OpenJDK 6 causes problems for some people and some software. An Oracle JDK RPM is available from Scientific Linux 5, although not from other RHEL-5-like distributions.
<p />
<h3><a name="Declaring_Dependencies_on_Java"></a> Declaring Dependencies on Java </h3>
<p />
For <font color="#ff0000">all packages</font> that declare build and runtime dependencies on Java, the following policy is <font color="#ff0000">recommended</font>:
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table1" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <font color="#252b37">Java</font> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol1"> <font color="#252b37">Build Dependency</font> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol2 twikiLastCol"> <font color="#252b37">Runtime Dependency</font> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> Oracle JDK (default) </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> <code>java-sun</code> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLastCol"> <code>java-devel-sun</code> </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> OpenJDK 6 </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLast"> <code>java-openjdk</code> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2 twikiLastCol twikiLast"> <code>java-devel-openjdk</code> </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
<strong>Reasoning:</strong> In this case, we disagree with EMI’s recommendations a little bit. They suggest using the generic <code>java</code> and <code>java-devel</code> virtual packages; however, <strong>both</strong> the Oracle JDK (i.e., java-1.6.0-sun-compat) and OpenJDK packages provide those virtual packages, so they do not help us specific precisely which flavor of Java we get. It is unclear why EMI recommends their use, honestly.
<p />
<h3><a name="Builds_Using_Ant_or_Maven"></a> Builds Using Ant or Maven </h3>
<p />
Ant and Maven are two common build tools (like <code>make</code>) in the Java environment. Maven is broader in scope and uses Ant. Ant is available in Scientific Linux 5, but apparently not RHEL 5 or <span class="twikiNewLink">CentOS<a href="/bin/edit/SoftwareTeam/CentOS?topicparent=SoftwareTeam.JavaPackageNotes" rel="nofollow" title="CentOS (this topic does not yet exist; you can create it)">?</a></span> 5; Maven is not available in any of the OS distributions nor EPEL. However another distribution, <a href="http://www.jpackage.org/" target="_top">JPackage</a>, provides RPMs for these build tools as well as tools of their own. The Fedora Packaging Guidelines explicitly recommend the use of JPackage.
<p />
For source packages of Java components that use Ant or Maven, the following policy is <font color="#ff0000">recommended</font>:
<p /> <ul>
<li> Where possible, use the recipes in the <a href="http://fedoraproject.org/wiki/Packaging/Java" target="_top">Fedora Packaging Guidelines for Java</a> for packaging Ant and Maven builds
</li> <li> For build systems (only), use the JPackage repository (with low priority) to get RPMs for Ant (if necessary) and Maven
</li></ul> 
<p />
<strong>Reasoning:</strong> We want to following the Fedora Packaging Guidelines (FPG) in general, so it makes sense to follow their Java guidelines, too. The use of JPackage is recommended because (a) it is part of the guidelines, (b) it is widely used in the general community for packaging Java, and (c) it provides RPMs of critical build tools, like Maven, that are missing from other standard distributions. The JPackage repository should not be needed at install time, so it is not part of our recommended list of install distributions.
<p />
<h3><a name="Runtime_Environment"></a> Runtime Environment </h3>
<p />
Many Java applications need the <code>JAVA_HOME</code> environment variable set in order to find all of the resources of the Java Runtime Environment (JRE). Therefore, the following policy is <font color="#ff0000">recommended</font>:
<p /> <ul>
<li> Each package must be checked to make sure its executables find and use the correct Java runtime
</li> <li> Use the alternatives system to locate the actual location of <code>JAVA_HOME</code> for a given JRE
</li></ul> 
<p />
<strong>Reasoning:</strong> When a Java-based package is installed, the system will have at least the required runtime JRE; however, other JREs may be installed as well, and it is possible that the <em>wrong</em> JRE will be the default according to the alternatives system. This issue could be caused by installing two packages, where one requires the Oracle JDK and one requires the <span class="twikiNewLink">OpenJDK<a href="/bin/edit/SoftwareTeam/OpenJDK?topicparent=SoftwareTeam.JavaPackageNotes" rel="nofollow" title="OpenJDK (this topic does not yet exist; you can create it)">?</a></span>. Given the potential for confusion, at the technical level and at the human level in trying to administer a system with multiple JREs, it is best to ask each package to locate and set up its own environment for its required JRE.
<p />
<h3><a name="Dependent_JAR_Files"></a> Dependent JAR Files </h3>
<p />
If a Java-based package comes with its own collection of dependent JAR files that are themselves also separately distributed (e.g., a package ships a copy of <code>jakarta-commons</code>), the following policy is <font color="#ff0000">recommended</font>:
<p /> <ul>
<li> When reasonable, remove the dependent JAR files and replace them with dependencies on the standard packages that contain them
</li> <li> When it is not reasonable to remove the dependent JAR files, leave them <strong>BUT</strong> provide a <code>README-OSG</code> in the package that explains the situation, including the reasons <em>why</em> the dependent packages were left in place
</li></ul> 
<p />
<strong>Reasoning:</strong> The Fedora guidelines are very clear — it is not acceptable to ship pre-built JAR files. However, in the interest of shipping packages sooner rather than later, we will bend the Fedora rule where necessary. In the longer term, though, we should push hard to remove the dependent JAR files and comply with the Fedora policy.
<p />
<h3><a name="Platform_Support"></a> Platform Support </h3>
<p />
<font color="#ff0000">Recommended:</font>:
<p /> <ul>
<li> To support RHEL 5-compatible platforms other than Scientific Linux 5, we will pass-through SL5 Java packages such as: <ul>
<li> <code>java-1.6.0-sun-compat</code>
</li> <li> The Oracle JDK — either from SL5, or by direct download + minimal packaging
</li> <li> <code>jpackage-utils</code>
</li></ul> 
</li></ul> 
<p />
<strong>Reasoning:</strong> SL5 has a complete set of Java packages for our needs, but other RHEL 5-variants do not. Yet, it would be nice to support as many of the RHEL 5-variants as possible. Further, there are no negative consequences to a SL5 install of passing through their packages in the OSG Software Stack.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Open_Issues"></a> Open Issues </span></h2>
<p />
None at this time.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Notes"></a> Notes </span></h2>
<p />
According to the EMI page, the <code>java</code> dependency is the recommended runtime dependency. That virtual package is satisfied by:
<p /> <ul>
<li> java-1.4.2-gcj-compat
</li> <li> java-1.6.0-openjdk (1.6.0.0-1.11.b16 through 1.6.0.0-1.22.1.9.8)
</li> <li> java-1.6.0-sun-compat (1.6.0.20-1 through 1.6.0.26-3)
</li></ul> 
<p />
<h3><a name="java_1_6_0_openjdk"></a> java-1.6.0-openjdk </h3>
<p />
OpenJDK is an open-source implementation of the Java platform. OpenJDK 7 will be the Oracle-backed reference implementation of Java 7, but the status of OpenJDK 6 (= java-1.6.0-openjdk) in the Java ecosystem is less clear.
<p />
Nonetheless, this set of packages (including -demo, -devel, -javadoc, and -src) are available in Scientific Linux 5.6 (and presumably, earlier) and provide a complete JDK/JRE.
<p />
Package properties:
<p /> <ul>
<li> It sets up the JDK to work with the RPM alternatives system
</li> <li> It provides a bunch of virtual packages to satisfy dependencies (including <code>java-sdk</code> but not <code>jdk</code>)
</li></ul> 
<p />
<h3><a name="java_1_6_0_sun_compat"></a> java-1.6.0-sun-compat </h3>
<p />
From the RPM metadata: This package provides JPackage compatibility symlinks and directories for the vendor's JDK rpm.
<p />
I think what this means is that the Oracle/Sun JDK 1.6 does not install into the filesystem like the JPackage standard dictates, so the -compat RPM adds a bunch of symlinks and empty directories to the filesystem to satisfy JPackage. Also, the package appears to have the following properties:
<p /> <ul>
<li> It sets up the Oracle/Sun JDK to play nicely with the RPM alternatives system
</li> <li> It conflicts with certain JDK packages from IBM, Blackdown, and BEA
</li> <li> It provides a bunch of virtual packages to satisfy dependencies
</li> <li> It depends on the <code>jdk</code> virtual package, which is the Oracle/Sun JDK package
</li></ul> 
<p />
This compatibility package is available only on Scientific Linux 5, not CentOS 5 or from EPEL. So <strong>if</strong> we depend on it for our Java packaging, then we are either constrained to Scientific Linux 5 or must pass-through the <code>-compat</code> package.
<p />
<h3><a name="jdk"></a> jdk </h3>
<p />
Scientific Linux 5, at least, supplies the full Oracle/Sun JDK 1.6.</div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: SoftwareTeam<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/SoftwareTeam/WebHome" class="twikiCurrentWebHomeLink twikiLink">WebHome</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>JavaPackageNotes</span> <br />    
Topic revision: r7 - 27 Jul 2011 - 20:48:15 - <a href="/bin/view/Main/TimCartwright" class="twikiLink">TimCartwright</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />