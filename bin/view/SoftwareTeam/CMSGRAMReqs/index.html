<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> CMSGRAMReqs &lt; SoftwareTeam &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/SoftwareTeam/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/SoftwareTeam/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/SoftwareTeam/CMSGRAMReqs?_T=16 Feb 2017" type="application/x-wiki" title="edit CMSGRAMReqs" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/SoftwareTeam/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/SoftwareTeam/CMSGRAMReqs"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#DDDDDD;
	}
	.patternBookView {
		border-color:#DDDDDD;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <h1><a name="CMS_GRAM_Improvement_Requirement"></a> CMS GRAM Improvement Requirements </h1>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Requirement_1_Clean_up_Globus_cr"></a> Requirement 1: Clean up Globus cruft </span></h2>
<p />
CMS needs tools that are enabled by default on the CE to clean up the old cruft that failed Globus jobs leave behind in the user home directories and the Globus temporary directories. By "old" we mean older than 10 days, though the number should be configurable. Specifically, the following files should be cleaned up:
<p /> <ol>
<li> In each user's home directory: <ol>
<li> Old gram_job_mgr*.log files
</li> <li> Old gram_scratch* directories
</li> <li> Old files in the .globus/.gass_cache directory
</li> <li> Old files in the .globus/job directory
</li></ol> 
</li> <li> Old files in the $GLOBUS_LOCATION/tmp/gram_job_state directory
</li></ol> 
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Requirement_2_Change_priority_of"></a> Requirement 2: Change priority of the Globus gatekeeper </span></h2>
<p />
The priority of the globus-gatekeeper process should have a nice level and ionice level of 20 by default. This was requested by CMS as <a href="http://crt.cs.wisc.edu/Ticket/Display.html?user=guest&amp;pass=guest&amp;id=5028" target="_top">VDT Ticket #5028</a>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Requirement_3_Prevent_fork_job_m"></a> Requirement 3: Prevent fork job manager synchronization </span></h2>
<p />
We should apply the following patch to the fork job manager poll function so that when there are many Condor-G grid_monitors (which are fork jobs), they are not sychronized. 
<p />
<pre>
--- globus/lib/perl/Globus/GRAM/JobManager/fork.pm     2010-09-29 17:59:17.000000000 -0500
+++ globus/lib/perl/Globus/GRAM/JobManager/fork.pm     2010-10-01 10:12:20.000000000 -0500
@@ -464,7 +464,7 @@
        $self->log("poll: job id defined!");
        return { JOB_STATE => Globus::GRAM::JobState::FAILED };
    }
-
+    sleep(int(10+rand(10)));
    $self->log("polling job " . $jobid);
    $_ = kill(0, split(/,/, $jobid));
</pre>
<p />
This is now ticket <a href="http://crt.cs.wisc.edu/Ticket/Display.html?user=guest&amp;pass=guest&amp;id=8923" target="_top">VDT Ticket #8923</a>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Requirement_4_Extend_Condor_job"></a> Requirement #4: Extend Condor job manager to be able set accounting groups. </span></h2>
<p />
Apply patch written by CMS that extracts FQAN from user's proxy then uses VO information to set Condor accounting group information. This is documented in <a href="http://crt.cs.wisc.edu/Ticket/Display.html?user=guest&amp;pass=guest&amp;id=5838" target="_top">VDT Ticket #5838</a></div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: SoftwareTeam<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/SoftwareTeam/WebHome" class="twikiCurrentWebHomeLink twikiLink">WebHome</a> &gt; <a href="/bin/view/SoftwareTeam/Projects" class="twikiLink">Projects</a> &gt; <a href="/bin/view/SoftwareTeam/CMSGRAM" class="twikiLink">CMSGRAM</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>CMSGRAMReqs</span> <br />    
Topic revision: r2 - 03 May 2011 - 20:03:25 - <span class="twikiNewLink">AlainRoy<a href="/bin/edit/SoftwareTeam/AlainRoy?topicparent=SoftwareTeam.CMSGRAMReqs" rel="nofollow" title="AlainRoy (this topic does not yet exist; you can create it)">?</a></span>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />