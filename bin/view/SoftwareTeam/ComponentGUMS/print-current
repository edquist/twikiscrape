<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> ComponentGUMS &lt; SoftwareTeam &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/SoftwareTeam/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/SoftwareTeam/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/SoftwareTeam/ComponentGUMS?_T=16 Feb 2017" type="application/x-wiki" title="edit ComponentGUMS" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/SoftwareTeam/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/SoftwareTeam/ComponentGUMS"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#DDDDDD;
	}
	.patternBookView {
		border-color:#DDDDDD;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <h1><a name="OSG_Software_Component_GUMS"></a> OSG Software Component: GUMS </h1>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Purpose"></a> Purpose </span></h2>
<p />
GUMS is a service that authorizes and maps users from their global identity to a local (Unix id) identity. It is not a required service (some sites use the simple <code>edg-mkgridmap</code> to construct a <code>grid-mapfile</code> instead), but it is commonly used. It is helpful when you have more than one resource (Compute Element, Storage Element, etc.), because they can share authorization and mapping data. It is particularly helpful when using gLExec at a site, because gLExec runs on every worker node and needs authorization and mapping information.
<p />
GUMS is a web application that runs in Tomcat.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Usage"></a> Usage </span></h2>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Source"></a> Source </span></h2>
<p />
GUMS is owned and maintained by Brookhaven National Laboratory. The only current person working on it is John Hover. Work for GUMS is tracked in the OSG JIRA, under the GUMS project.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Packaging"></a> Packaging </span></h2>
<p />
<strong>Repository:</strong> OSG.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="History"></a> History </span></h2>
<p />
<h3><a name="Use_of_VOMS_APIs"></a> Use of VOMS APIs </h3>
<p />
[Written by John Hover, 2 October 2012; some edits for TWiki by Tim Cartwright.]
<p />
From 2004 to 2012, GUMS retrieved users from VOMS servers via the VOMSAdmin web service interface.
<p />
From 2004 to about 2009 the service endpoint URL was described via a combination of baseUrl and remainderURL in the virtualOrganization and userGroup definitions, e.g.:
<p />
<pre>
  &#60;virtualOrganization
    name&#61;&#39;virtualOrganizationA&#39;
    baseUrl&#61;&#39;https://lcg-voms.cern.ch:8443/voms&#39;
</pre>
<p />
<pre>
 &#60;userGroup
    virtualOrganization&#61;&#39;virtualOrganizationA&#39;
    remainderUrl&#61;&#39;/atlas/services/VOMSAdmin&#39;/&#62;
</pre>
<p />
In 2009, we realized that lots of VOs shared particular VOMS servers, so we instead defined baseUrl in a vomsServer element, with the remainderUrl in a vomsUserGroup element, e.g.:
<p />
<pre>
  &#60;vomsServer
    name&#61;&#39;lcg-voms.cern.ch&#39;
    baseUrl&#61;&#39;https://lcg-voms.cern.ch:8443/voms&#39;
</pre>
<p />
<pre>
 &#60;vomsUserGroup
    vomsServer&#61;&#39;lcg-voms.cern.ch&#39;
    remainderUrl&#61;&#39;/atlas/services/VOMSAdmin&#39;/&#62;
</pre>
<p />
During all this time, the URL included the full path to the VOMSAdmin interface in the remainderUrl element.
<p />
In 2012, we learned that GUMS had always been doing this wrong. We should have been pulling users from a different VOMS API, VOMSCompatibility. The reasons for this have to do with what is returned by the calls:
<p />
VOMSAdmin.listMembers() returns a list of the <strong>primary</strong> DNs for each registered user. If you want <strong>all</strong> the user DNs, you must then explicitly ask for secondary certs.
<p />
VOMSCompatibility.getGridmapUsers() returns a flat list of all DNs for all registered users.
<p />
This distinction never mattered until recent changes to VOMSAdmin intended to take advantage of the multi-cert VO user concept.
<p />
GUMS 1.3.18 dropped the service path from the config. The baseUrl + remainderUrl element should now just point to the base of that VO, e.g.:
<p />
<pre>
https://lcg-voms.cern.ch:8443/voms/atlas
</pre>
<p />
The decision about whether to use the VOMSCompatibility API or the VOMSAdmin API will be made dynamically, and internally. Currently I'm always just using VOMSCompatibility.getGridmapUsers(). But this change sets the stage to allow implementation of the multi-cert VO user model in future versions of GUMS. What this would permit is for users with multiple certificates to always be mapped to the same UNIX user, regardless of which cert is used.
<p />
Now, I don't especially like that idea, as I think OSG sites shouldn't even guarantee that all jobs from one user are necessarily mapped to the same UNIX ID if separated widely in time. EGI/LCG does not. Users there are mapped to small number of pool accounts which get rapidly recycled.
<p />
But it seemed prudent to set up the code in advance to make it possible to do complex user updates if it becomes a critical feature.
<p />
As far as documentation, what is needed to prepare for GUMS 1.3.18 is for the GOC VO package to have the <code>/services/VOMSAdmin</code> and/or <code>/services/VOMSCompatibility</code> strings removed from all the vomsUserGroup elements. Site admins would need to be directed to remove those manually if they instead intend to copy their old config files.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Future"></a> Future </span></h2></div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: SoftwareTeam<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/SoftwareTeam/ComponentHome" class="twikiLink">ComponentHome</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>ComponentGUMS</span> <br />    
Topic revision: r2 - 02 Oct 2012 - 19:18:12 - <a href="/bin/view/Main/TimCartwright" class="twikiLink">TimCartwright</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />