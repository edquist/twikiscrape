---+!! glexec testing

%TOC%

%STARTINCLUDE%

---+ General Description


These tests had the same results for both settings below in the condor config for the gatekeeper CE:
   * DELEGATE_JOB_GSI_CREDENTIALS = False
   * DELEGATE_JOB_GSI_CREDENTIALS = True

The columns for the __grid/voms-proxy-info__ are shown for the client proxy and the CE proxy ( __X509_USER_PROXY__ ) used to test glexec.

The job run was a __globus-job-run__ of a script that executed the following commands:
&lt;blockquote&gt;
export GLEXEC_CLIENT_CERT=$X509_USER_PROXY%BR%
$OSG_GLEXEC_LOCATION /usr/bin/id;
&lt;/blockquote&gt;
Both variables are contained in the user environment of the job.

In both scenarios, the CE and the WN are on the same node.  I don&#39;t know if this distorts the testing or not.

---+ RPM CE/WN
Condor
&lt;blockquote&gt;
condor-7.8.4-1.osg.el5.x86_64&lt;br/&gt;
osg-ce-condor-3.0.0-30.osg.el5.x86_64&lt;br/&gt;
&lt;/blockquote&gt;
glexec
&lt;blockquote&gt;
glexec-wrapper-scripts-0.0.6-1.2.osg.el5.noarch&lt;br/&gt;
glexec-0.9.6-1.2.osg.el5.x86_64&lt;br/&gt;
lcmaps-plugins-glexec-tracking-0.1.4-1.2.osg.el5.x86_64&lt;br/&gt;
osg-wn-client-glexec-3.0.0-16.osg.el5.noarch&lt;br/&gt;
&lt;/blockquote&gt;

These are the errors that were detected:
   * __glexec error__
&lt;blockquote&gt;
 __In /var/log/messages__: &lt;br /&gt;
lcmaps: Error: grid_verifyPathLenConstraints: Proxy Path Length Constraint exceeded on depth 0 of 5 for certificate &lt;br/&gt;
&quot;/DC=org/DC=doegrids/OU=People/CN=John Weigand 458491/CN=872623406/CN=671910884&quot;. &lt;br/&gt;
No Proxy certifcates were expected at this stage. &lt;br /&gt;
lcmaps: Error: Verifying certificate chain: certificate rejected 
&lt;/blockquote&gt;

   * __gatekeeper error_1__
&lt;blockquote&gt;
glexec never invoked.  gatekeeper failure. &lt;br /&gt;
1. __Authorized user against GUMS__ &lt;br /&gt;
2. __Then, no error, just this in /var/log/messages__ &lt;br /&gt;
&quot;Attempt to use limited proxy for service&quot; &lt;br /&gt;
3. __Client gets an error code 7__: &lt;br /&gt;
GRAM Job submission failed because authentication with the remote server failed (error code 7) 
&lt;/blockquote&gt;

   * __gatekeeper error_2__
&lt;blockquote&gt;
__globus-job-run output__:&lt;br/&gt;
GRAM Job submission failed because an authentication operation failed &lt;br /&gt;
globus_gsi_gssapi: Unable to verify remote side&#39;s credentials &lt;br /&gt;
globus_gsi_gssapi: Unable to verify remote side&#39;s credentials: Couldn&#39;t verify the remote certificate &lt;br /&gt;
OpenSSL Error: s3_pkt.c:1086: in library: SSL routines, function SSL3_READ_BYTES: sslv3 alert bad certificate SSL alert number 42 &lt;br /&gt; 
(error code 7) &lt;br /&gt;
&lt;br/&gt;
In  __/var/log/messages:__ &lt;br /&gt;
Oct  9 11:44:05 fermicloud003 GRAM-gatekeeper[22741]: Got connection ::ffff:131.225.154.60 at Tue Oct  9 11:44:05 2012 &lt;br /&gt;
Oct  9 11:44:05 fermicloud003 GRAM-gatekeeper[22741]: GSS failed Major:000a0000 Minor:0000000c Token:00000000 
&lt;/blockquote&gt;

---++ RPM Client
voms/grid proxies
&lt;blockquote&gt;
voms-2.0.6-5.osg.src.rpm&lt;br /&gt;
globus-proxy-utils-5.0-5.osg.src.rpm&lt;br /&gt;
&lt;/blockquote&gt;

%TABLE{ tableborder=&quot;1&quot; cellpadding=&quot;0&quot; cellspacing=&quot;1&quot;  headerbg=&quot;#99CCCC&quot; databg=&quot;#FFFFCC, #FFFFFF&quot;}%
%EDITTABLE{ header=&quot;| *Command* | *arguments* | *glexec status* | *client%BR%grid-proxy-info* | *client%BR%voms-proxy-info* | *WN%BR%grid-proxy-info* | *WN%BR%voms-proxy-info* | *Notes* |&quot;  format=&quot;| textarea, 1x15 | textarea, 1x6 | textarea, 1x6 | textarea, 1x20 | textarea, 1x20 | textarea, 1x20 | textarea, 1x20 | textarea, 1x60 |&quot; changerows=&quot;on&quot; quietsave=&quot;on&quot; editbutton=&quot;Edit table&quot; }%
| *Command* | *arguments* | *glexec status* | *client &lt;br /&gt;    grid-proxy-info* | *client &lt;br /&gt;    voms-proxy-info* | *WN &lt;br /&gt;    grid-proxy-info* | *WN &lt;br /&gt;    voms-proxy-info* | *Notes* |
| grid-proxy-init | | OK | RFC 3820 compliant impersonation proxy | RFC compliant proxy | RFC 3820 compliant limited proxy | RFC compliant proxy | |
| ^ | -old | OK | full legacy globus proxy | proxy | limited legacy globus proxy | limited proxy | |
| ^ | -draft | FAILED | Proxy draft (pre-RFC) compliant impersonation proxy | GT3-style proxy | Proxy draft (pre-RFC) compliant limited proxy | GT3-style proxy | See __glexec error__ |
| ^ | -rfc | OK | RFC 3820 compliant impersonation proxy | RFC compliant proxy | RFC 3820 compliant limited proxy | RFC compliant proxy | |
| ^ | -independent | OK | RFC 3820 compliant independent proxy | RFC compliant proxy | RFC 3820 compliant limited proxy | RFC compliant proxy | |
| ^ | -limited | Gatekeeper failure | RFC 3820 compliant limited proxy | RFC compliant proxy | | | See __gatekeeper error_1__ |
| | | | | | | | |
| voms-proxy-init | | OK | full legacy globus proxy | proxy | limited legacy globus proxy | limited proxy | |
| ^ | -old &lt;br /&gt;-proxyver 2 | OK | full legacy globus proxy | proxy | limited legacy globus proxy | limited proxy | |
| ^ | -rfc &lt;br /&gt;-proxyver 4 | OK | RFC 3820 compliant impersonation proxy | RFC compliant proxy | RFC 3820 compliant limited proxy | RFC compliant proxy | |
| ^ | -proxyver 3 | Gatekeeper failure | end entity credential | GT3-style proxy | | | See __gatekeeper error_2__ |


---++Pacman Client
voms/grid proxies
&lt;blockquote&gt;
VDT version 2.0.0p35 &lt;br/&gt;      
Globus Toolkit, pre web-services, client 4.0.8&lt;br/&gt;      
GPT 3.2-4.0.8p1&lt;br/&gt;      
MyProxy Client 5.3&lt;br/&gt;      
VOMS Client 1.8.8-2p1&lt;br/&gt;      
&lt;/blockquote&gt;

%TABLE{ tableborder=&quot;1&quot; cellpadding=&quot;0&quot; cellspacing=&quot;1&quot; headerbg=&quot;#99CCCC&quot; databg=&quot;#FFFFCC, #FFFFFF&quot;}%
%EDITTABLE{ header=&quot;| *Command* | *arguments* | *glexec status* | *client%BR%grid-proxy-info* | *client%BR%voms-proxy-info* | *WN%BR%grid-proxy-info* | *WN%BR%voms-proxy-info* | *Notes* |&quot;  format=&quot;| textarea, 1x15 | textarea, 1x6 | textarea, 1x6 | textarea, 1x20 | textarea, 1x20 | textarea, 1x20 | textarea, 1x20 | textarea, 1x60 |&quot; changerows=&quot;on&quot; quietsave=&quot;on&quot; editbutton=&quot;Edit table&quot; }%
| *Command* | *arguments* | *glexec status* | *client &lt;br /&gt;    grid-proxy-info* | *client &lt;br /&gt;    voms-proxy-info* | *WN &lt;br /&gt;    grid-proxy-info* | *WN &lt;br /&gt;    voms-proxy-info* | *Notes* |
| grid-proxy-init | | FAILED | Proxy draft (pre-RFC) compliant impersonation proxy | GT3-style proxy | Proxy draft (pre-RFC) compliant limited proxy | GT3-style proxy | See __glexec error__ |
| ^ | -old | OK | full legacy globus proxy | proxy | limited legacy globus proxy | limited proxy | |
| ^ | -draft | OK | full legacy globus proxy | proxy | limited legacy globus proxy | limited proxy | |
| ^ | -rfc | OK | RFC 3820 compliant impersonation proxy | RFC compliant proxy | RFC 3820 compliant limited proxy | RFC compliant proxy | |
| ^ | -independent | FAILED | Proxy draft (pre-RFC) compliant independent proxy | GT3-style proxy | Proxy draft (pre-RFC) compliant limited proxy | GT3-style proxy | See __glexec error__ |
| ^ | -limited | Gatekeeper failure | Proxy draft (pre-RFC) compliant limited proxy | GT3-style proxy | | | See __gatekeeper error_1__ |
| | | | | | | | |
| voms-proxy-init | | OK | full legacy globus proxy | proxy | limited legacy globus proxy | limited proxy | |
| ^ | -proxyver 2 | OK | full legacy globus proxy | proxy | limited legacy globus proxy | limited proxy | |
| ^ | -rfc &lt;br /&gt;-proxyver 4 | OK | RFC 3820 compliant impersonation proxy | RFC compliant proxy | RFC 3820 compliant limited proxy | RFC compliant proxy | |
| ^ | -proxyver 3 | Failed | Proxy draft (pre-RFC) compliant impersonation proxy | GT3-style proxy | Proxy draft (pre-RFC) compliant limited proxy | GT3-style proxy | See __glexec error__ |


---+ PACMAN CE/WN
CE
&lt;blockquote&gt;
VDT version 2.0.0p36:&lt;br /&gt;
Condor/Condor-G 7.2.5 &lt;br /&gt;
Globus Toolkit, pre web-services, client 4.0.8 &lt;br /&gt;
Globus Toolkit, pre web-services, server 4.0.8&lt;br /&gt;
Globus Toolkit, web-services, client 4.0.8 &lt;br /&gt;
Globus Toolkit, web-services, server 4.0.8 &lt;br /&gt;
MyProxy Client 5.3  &lt;br /&gt;
PRIMA Authorization Module 0.8.8 &lt;br /&gt;
PRIMA Authorization Module For GT4 Web Services 0.1.2 &lt;br /&gt;
pyOpenSSL module 0.9 &lt;br /&gt;
VOMS Client 1.8.8-2p1  &lt;br /&gt;
&lt;/blockquote&gt;

WN
&lt;blockquote&gt;
VDT version 2.0.0p36:      &lt;br /&gt;
glexec 0.6.8.3-osg3 (lcas 1.3.11.3 and lcmaps 1.4.8.4) 0.6.8.3-osg3  &lt;br /&gt;
gLite Data Delegation API 2.0.0-7   &lt;br /&gt;
gLite Data Delegation Client 2.0.0-5   &lt;br /&gt;
GPT 3.2-4.0.8p1  &lt;br /&gt;
MyProxy Client 5.3   &lt;br /&gt;
PRIMA Authorization Module 0.8.8  &lt;br /&gt;
pyOpenSSL module 0.9  &lt;br /&gt;
VOMS Client 1.8.8-2p1  &lt;br /&gt;
&lt;/blockquote&gt;

These are the errors that were detected:

   * __gatekeeper error_1__
&lt;blockquote&gt;
glexec never invoked.  gatekeeper failure. &lt;br /&gt;
1. __User was not authorized by GUMS__ &lt;br /&gt;
2. __Client gets an error code 7__: &lt;br /&gt;
GRAM Job submission failed because authentication with the remote server failed (error code 7)
&lt;/blockquote&gt;

   * __gatekeeper error_2__
&lt;blockquote&gt;
glexec never invoked.  gatekeeper failure. &lt;br /&gt;
1. __User was authorized by GUMS__ &lt;br /&gt;
2. __globus-gatekeeper-log__ &lt;br /&gt;
 PID: 8988 --Failure: Attempt to use limited proxy for service&lt;br /&gt;
 PID: 8988 -- Failure: Attempt to use limited proxy for service&lt;br /&gt;
3. __Client gets an error code 7__: &lt;br /&gt;
GRAM Job submission failed because authentication with the remote server failed (error code 7)
&lt;/blockquote&gt;

   * __gatekeeper error_3__
&lt;blockquote&gt;
__globus-job-run output__:&lt;br/&gt;
GRAM Job submission failed because an authentication operation failed &lt;br /&gt;
globus_gsi_gssapi: Unable to verify remote side&#39;s credentials &lt;br /&gt;
globus_gsi_gssapi: Unable to verify remote side&#39;s credentials: Couldn&#39;t verify the remote certificate &lt;br /&gt;
OpenSSL Error: s3_pkt.c:1086: in library: SSL routines, function SSL3_READ_BYTES: sslv3 alert bad certificate SSL alert number 42 &lt;br /&gt; 
(error code 7) &lt;br /&gt;
&lt;br/&gt;
In  __globus-gatekeeper-log__ :__ &lt;br /&gt;
GSS authentication failure &lt;br /&gt;
GSS Major Status: Authentication Failed&lt;br /&gt;
GSS Minor Status Error Chain:&lt;br /&gt;
accept_sec_context.c:gss_accept_sec_context:183:&lt;br /&gt;
SSLv3 handshake problems&lt;br /&gt;
globus_i_gsi_gss_utils.c:globus_i_gsi_gss_handshake:910:&lt;br /&gt;
Unable to verify remote side&#39;s credentials&lt;br /&gt;
globus_i_gsi_gss_utils.c:globus_i_gsi_gss_handshake:883:&lt;br /&gt;
SSLv3 handshake problems: Couldn&#39;t do ssl handshake&lt;br /&gt;
OpenSSL Error: s3_srvr.c:2528: in library: SSL routines, function SSL3_GET_CLIENT_CERTIFICATE: no certificate returned&lt;br /&gt;
globus_gsi_callback.c:globus_gsi_callback_handshake_callback:547:&lt;br /&gt;
Could not verify credential&lt;br /&gt;
globus_gsi_callback.c:globus_i_gsi_callback_cred_verify:787:&lt;br /&gt;
Can&#39;t get the local trusted CA certificate: Cannot find trusted CA certificate with hash afca1e19 in /usr/local/osg-ce/globus/TRUSTED_CA&lt;br /&gt;
Failure: GSS failed Major:000a0000 Minor:00000006 Token:00000000&lt;br /&gt;
&lt;/blockquote&gt;

---++ RPM Client
voms/grid proxies
&lt;blockquote&gt;
voms-2.0.6-5.osg.src.rpm&lt;br /&gt;
globus-proxy-utils-5.0-5.osg.src.rpm&lt;br /&gt;
&lt;/blockquote&gt;

%TABLE{ tableborder=&quot;1&quot; cellpadding=&quot;0&quot; cellspacing=&quot;1&quot;  headerbg=&quot;#99CCCC&quot; databg=&quot;#FFFFCC, #FFFFFF&quot;}%
%EDITTABLE{ header=&quot;| *Command* | *arguments* | *glexec status* | *client%BR%grid-proxy-info* | *client%BR%voms-proxy-info* | *WN%BR%grid-proxy-info* | *WN%BR%voms-proxy-info* | *Notes* |&quot;  format=&quot;| textarea, 1x15 | textarea, 1x6 | textarea, 1x6 | textarea, 1x20 | textarea, 1x20 | textarea, 1x20 | textarea, 1x20 | textarea, 1x60 |&quot; changerows=&quot;on&quot; quietsave=&quot;on&quot; editbutton=&quot;Edit table&quot; }%
| *Command* | *arguments* | *glexec status* | *client &lt;br /&gt;    grid-proxy-info* | *client &lt;br /&gt;    voms-proxy-info* | *WN &lt;br /&gt;    grid-proxy-info* | *WN &lt;br /&gt;    voms-proxy-info* | *Notes* |
| grid-proxy-init | | OK | RFC 3820 compliant impersonation proxy | RFC compliant proxy | RFC 3820 compliant limited proxy | RFC compliant proxy | |
| ^ | -old | OK | full legacy globus proxy | proxy | limited legacy globus proxy | limited proxy | |
| ^ | -draft | OK | Proxy draft (pre-RFC) compliant impersonation proxy | GT3-style proxy | Proxy draft (pre-RFC) compliant limited proxy | GT3-style proxy | |
| ^ | -rfc | OK | RFC 3820 compliant impersonation proxy | RFC compliant proxy | RFC 3820 compliant limited proxy | RFC compliant proxy | |
| ^ | -independent | Gatekeeper failure | RFC 3820 compliant independent proxy | RFC compliant proxy | RFC 3820 compliant limited proxy | RFC compliant proxy | See __gatekeeper error_1__ |
| ^ | -limited | Gatekeeper failure | RFC 3820 compliant limited proxy | RFC compliant proxy | | | See __gatekeeper error_2__ |
| | | | | | | | |
| voms-proxy-init | | OK | full legacy globus proxy | proxy | limited legacy globus proxy | limited proxy | |
| ^ | -old &lt;br /&gt;-proxyver 2 | OK | full legacy globus proxy | proxy | limited legacy globus proxy | limited proxy | |
| ^ | -rfc &lt;br /&gt;-proxyver 4 | OK | RFC 3820 compliant impersonation proxy | RFC compliant proxy | RFC 3820 compliant limited proxy | RFC compliant proxy | |
| ^ | -proxyver 3 | Gatekeeper failure | end entity credential | GT3-style proxy | | | See __gatekeeper error_3__ |


---++Pacman Client
voms/grid proxies
&lt;blockquote&gt;
VDT version 2.0.0p35 &lt;br/&gt;      
Globus Toolkit, pre web-services, client 4.0.8&lt;br/&gt;      
GPT 3.2-4.0.8p1&lt;br/&gt;      
MyProxy Client 5.3&lt;br/&gt;      
VOMS Client 1.8.8-2p1&lt;br/&gt;      
&lt;/blockquote&gt;

%TABLE{ tableborder=&quot;1&quot; cellpadding=&quot;0&quot; cellspacing=&quot;1&quot; headerbg=&quot;#99CCCC&quot; databg=&quot;#FFFFCC, #FFFFFF&quot;}%
%EDITTABLE{ header=&quot;| *Command* | *arguments* | *glexec status* | *client%BR%grid-proxy-info* | *client%BR%voms-proxy-info* | *WN%BR%grid-proxy-info* | *WN%BR%voms-proxy-info* | *Notes* |&quot;  format=&quot;| textarea, 1x15 | textarea, 1x6 | textarea, 1x6 | textarea, 1x20 | textarea, 1x20 | textarea, 1x20 | textarea, 1x20 | textarea, 1x60 |&quot; changerows=&quot;on&quot; quietsave=&quot;on&quot; editbutton=&quot;Edit table&quot; }%
| *Command* | *arguments* | *glexec status* | *client &lt;br /&gt;    grid-proxy-info* | *client &lt;br /&gt;    voms-proxy-info* | *WN &lt;br /&gt;    grid-proxy-info* | *WN &lt;br /&gt;    voms-proxy-info* | *Notes* |
| grid-proxy-init | | OK | Proxy draft (pre-RFC) compliant impersonation proxy | GT3-style proxy | Proxy draft (pre-RFC) compliant limited proxy | GT3-style proxy | |
| ^ | -old | OK | full legacy globus proxy | proxy | limited legacy globus proxy | limited proxy | |
| ^ | -draft | | | | | | The -draft arg is not available |
| ^ | -rfc | OK | RFC 3820 compliant impersonation proxy | RFC compliant proxy | RFC 3820 compliant limited proxy | RFC compliant proxy | |
| ^ | -independent | Gatekeeper failure | Proxy draft (pre-RFC) compliant independent proxy | GT3-style proxy | Proxy draft (pre-RFC) compliant limited proxy | GT3-style proxy | See __gatekeeper error_1__ |
| ^ | -limited | Gatekeeper failure | Proxy draft (pre-RFC) compliant limited proxy | GT3-style proxy | | | See __gatekeeper error_2__ |
| | | | | | | | |
| voms-proxy-init | | OK | full legacy globus proxy | proxy | limited legacy globus proxy | limited proxy | |
| ^ | -proxyver 2 | OK | full legacy globus proxy | proxy | limited legacy globus proxy | limited proxy | |
| ^ | -rfc &lt;br /&gt;-proxyver 4 | OK | RFC 3820 compliant impersonation proxy | RFC compliant proxy | RFC 3820 compliant limited proxy | RFC compliant proxy | |
| ^ | -proxyver 3 | OK | Proxy draft (pre-RFC) compliant impersonation proxy | GT3-style proxy | Proxy draft (pre-RFC) compliant limited proxy | GT3-style proxy | |


%STOPINCLUDE%
