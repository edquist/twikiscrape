<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> MitGums &lt; Main &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Main/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Main/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Main/MitGums?_T=16 Feb 2017" type="application/x-wiki" title="edit MitGums" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Main/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Main/MitGums"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#FFEFA6;
	}
	.patternBookView {
		border-color:#FFEFA6;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--TWISTYPLUGIN_TWISTY--><style type="text/css" media="all">
@import url("https://twiki.opensciencegrid.org/twiki/pub/TWiki/TwistyContrib/twist.css");
</style>
<script type='text/javascript' src='https://twiki.opensciencegrid.org/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js'></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikiPref.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TwistyContrib/twist.compressed.js"></script>
<script type="text/javascript">
// <![CDATA[
var styleText = '<style type="text/css" media="all">.twikiMakeVisible{display:inline;}.twikiMakeVisibleInline{display:inline;}.twikiMakeVisibleBlock{display:block;}.twikiMakeHidden{display:none;}</style>';
document.write(styleText);
// ]]>
</script>

<!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> This is a collection of knowledge gathered from <a href="https://ticket.grid.iu.edu/goc/13516" target="_top">GOC Ticket #13516</a>.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Cause_of_the_problem"></a> Cause of the problem </span></h2>
<p />
The root of the problem didn't actually exist in any GLOW specific configuration, the issue was a missing <code>voGroup</code> attribute in the 'NEBioGrid' <code>vomsUserGroup</code>. The chain of events goes something like:
<p /> <ol>
<li> GUMS goes through the list of <code>groupToAccountMappings</code> in <code>hostToGroupMapping</code> that matches the host the request comes from. 'sbgrid' comes before 'GLOW' in this list.
</li> <li> GUMS now checks the <code>groupToAccountMapping</code> = 'sbgrid' and checks to see if the request comes from a VO member of <code>userGroups</code> = 'sbgrid, <span class="twikiNewLink">NEBioGrid<a href="/bin/edit/Main/NEBioGrid?topicparent=Main.MitGums" rel="nofollow" title="NEBioGrid (this topic does not yet exist; you can create it)">?</a></span>'. 
</li> <li> It doesn't match on <code>vomsUserGroup</code> = 'sbgrid' and moves onto <code>vomsUserGroup</code> = 'NEBioGrid'
</li> <li> <code>matchFQAN</code> is set to 'vo' so it tries to see if the <code>voGroup</code> attribute matches the request. Since none exists it fails and never reaches the 'GLOW' <code>groupToAccountMapping</code>.
</li></ol> 
<p />
<div class="twistyPlugin twikiMakeVisibleInline">  <span id="twistyIdMainMitGums1show" class="twistyRememberSetting twistyStartHide twistyTrigger twikiUnvisited twistyInited0"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleopen-small.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Relevant GUMS entries</span></a> </span> <span id="twistyIdMainMitGums1hide" class="twistyRememberSetting twistyStartHide twistyTrigger twikiUnvisited twistyHidden twistyInited0"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleclose-small.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Hide Full Output</span></a> </span>  </div><!--/twistyPlugin twikiMakeVisibleInline--> <div class="twistyPlugin"><div id="twistyIdMainMitGums1toggle" class="twistyRememberSetting twistyStartHide twistyContent twikiMakeHidden twistyInited0">
<pre>
&#60;pre class&#61;&#34;screen&#34;&#62;
&#60;vomsUserGroup
        name&#61;&#39;sbgrid&#39;
        access&#61;&#39;read all&#39;
        description&#61;&#39;&#39;
        vomsServer&#61;&#39;sbgrid&#39;
        matchFQAN&#61;&#39;vo&#39;
        acceptProxyWithoutFQAN&#61;&#39;true&#39;
        voGroup&#61;&#39;/SBGrid&#39;/&#62;

&#60;vomsUserGroup
        name&#61;&#39;NEBioGrid&#39;
        access&#61;&#39;read all&#39;
        description&#61;&#39;&#39;
        vomsServer&#61;&#39;NEBioGrid&#39;
        matchFQAN&#61;&#39;vo&#39;
        acceptProxyWithoutFQAN&#61;&#39;true&#39;/&#62;

&#60;groupToAccountMapping
        name&#61;&#39;sbgrid&#39;
        description&#61;&#39;&#39;
        accountingVoSubgroup&#61;&#39;sbgrid&#39;
        accountingVo&#61;&#39;SBGrid&#39;
        userGroups&#61;&#39;sbgrid, NEBioGrid&#39;
        accountMappers&#61;&#39;sbgrid, NEBioGrid&#39;/&#62;

&#60;hostToGroupMapping
        groupToAccountMappings&#61;&#39;cmsdcmon1, localUsers, cdf, fermilab, minos, usminos, ukminos, minossoft, miniboone, gadu, grase, ivdgl, mis, fmri, sdss, star, newUsatlasProd, newUsatlasSoft, newUsatlas, newAtlas, uscmsuser, cmsuser, uscmst2admin, uscmssoft, uscmsprod, cmshipro, uscmsprio, uscmsphedex, uscmsfrontier, cmslcgadmin, cmsuser-null, dzeroana, dzeroservice, dzerouser, dosar, des, des-production, gridex, nanohub, geant4, hcc, i2u2, mariachi, osg, nwicg, ops, gugrid, gpn, compbiogrid, ilc, nysgrid, sbgrid, GLOW, cigi, gums-test&#39;
        description&#61;&#39;&#39;
        cn&#61;&#39;&#42;.fnal.gov&#39;/&#62;
&#60;/pre&#62;
</pre>
</div></div> <!--/twistyPlugin-->
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="What_we_know"></a> What we know </span></h2>
<p />
A job submitted with a proxy with GLOW VO credentials to MIT's CE fails but there aren't any issues with other VOs (attempted with a fermilab and a CMS VO):
<p />
<pre class="rootscreen">
[user@client ~]$ voms-proxy-init -voms GLOW -cert test/usercert.pem -key test/userkey.pem 
Enter GRID pass phrase:
Your identity: /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Brian Lin 1047
Creating temporary proxy ....................... Done
Contacting  glow-voms.cs.wisc.edu:15001 [/DC=org/DC=doegrids/OU=Services/CN=glow-voms.cs.wisc.edu] "GLOW" Done
Creating proxy ................................................................................................. Done

Your proxy is valid until Tue Sep 17 06:11:50 2013

[user@client ~]$ globus-job-run localhost /usr/bin/whoami     
GRAM Job submission failed because authentication with the remote server failed (error code 7)

[user@client ~]$ voms-proxy-info -all
subject   : /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Brian Lin 1047/CN=proxy
issuer    : /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Brian Lin 1047
identity  : /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Brian Lin 1047
type      : proxy
strength  : 1024 bits
path      : /tmp/x509up_u1758
timeleft  : 11:59:49
key usage : Digital Signature, Key Encipherment, Data Encipherment
=== VO GLOW extension information ===
VO        : GLOW
subject   : /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Brian Lin 1047
issuer    : /DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=Services/CN=glow-voms.cs.wisc.edu
attribute : /GLOW/Role=NULL/Capability=NULL
timeleft  : 11:59:49
uri       : glow-voms.cs.wisc.edu:15001

</pre>
<p />
When submitting a job from the CE, the only log file we see affected is <code>/var/log/tomcat5/gums-service-cybersecurity.log</code>, where our request is being denied. When submitting a job with no associated VO, we see entries in <code>/var/log/tomcat5/gums-service-admin.log</code> that say it's a null mapping so this would seem to imply that GLOW VO users aren't finishing out the mapping logic.
<p />
<div class="twistyPlugin twikiMakeVisibleInline">  <span id="twistyIdMainMitGums2show" class="twistyRememberSetting twistyStartHide twistyTrigger twikiUnvisited twistyInited0"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleopen-small.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">XML Entry in gums-service-cybersecurity.log</span></a> </span> <span id="twistyIdMainMitGums2hide" class="twistyRememberSetting twistyStartHide twistyTrigger twikiUnvisited twistyHidden twistyInited0"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleclose-small.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Hide Full Output</span></a> </span>  </div><!--/twistyPlugin twikiMakeVisibleInline--> <div class="twistyPlugin"><div id="twistyIdMainMitGums2toggle" class="twistyRememberSetting twistyStartHide twistyContent twikiMakeHidden twistyInited0">
<pre class="screen">
<pre>
&#60;?xml version&#61;&#34;1.0&#34; encoding&#61;&#34;UTF-8&#34;?&#62;
&#60;samlp:Response xmlns:samlp&#61;&#34;urn:oasis:names:tc:SAML:2.0:protocol&#34; InResponseTo&#61;&#34;ID-1169479693&#34; Version&#61;&#34;2.0&#34;&#62;
   &#60;saml:Assertion xmlns:saml&#61;&#34;urn:oasis:names:tc:SAML:2.0:assertion&#34; Version&#61;&#34;2.0&#34;&#62;
      &#60;saml:Statement xmlns:xacml-saml&#61;&#34;urn:oasis:names:tc:xacml:2.0:profile:saml2.0:v2:schema:assertion&#34; xmlns:xsi&#61;&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xsi:type&#61;&#34;xacml-saml:XACMLAuthzDecisionStatementType&#34;&#62;
         &#60;XACMLcontext:Request xmlns:XACMLcontext&#61;&#34;urn:oasis:names:tc:xacml:2.0:context:schema:os&#34; xsi:type&#61;&#34;XACMLcontext:RequestType&#34;&#62;
            &#60;XACMLcontext:Subject SubjectCategory&#61;&#34;urn:oasis:names:tc:xacml:1.0:subject-category:access-subject&#34; xsi:type&#61;&#34;XACMLcontext:SubjectType&#34;&#62;
               &#60;XACMLcontext:Attribute AttributeId&#61;&#34;http://authz-interop.org/xacml/subject/subject-x509-id&#34; DataType&#61;&#34;http://www.w3.org/2001/XMLSchema#string&#34; xsi:type&#61;&#34;XACMLcontext:AttributeType&#34;&#62;
                  &#60;XACMLcontext:AttributeValue xsi:type&#61;&#34;XACMLcontext:AttributeValueType&#34;&#62;/DC&#61;com/DC&#61;DigiCert-Grid/O&#61;Open Science Grid/OU&#61;People/CN&#61;Brian Lin 1047&#60;/XACMLcontext:AttributeValue&#62;
               &#60;/XACMLcontext:Attribute&#62;
               &#60;XACMLcontext:Attribute AttributeId&#61;&#34;http://authz-interop.org/xacml/subject/subject-x509-issuer&#34; DataType&#61;&#34;http://www.w3.org/2001/XMLSchema#string&#34; xsi:type&#61;&#34;XACMLcontext:AttributeType&#34;&#62;
                  &#60;XACMLcontext:AttributeValue xsi:type&#61;&#34;XACMLcontext:AttributeValueType&#34;&#62;/DC&#61;com/DC&#61;DigiCert-Grid/O&#61;DigiCert Grid/CN&#61;DigiCert Grid CA-1&#60;/XACMLcontext:AttributeValue&#62;
               &#60;/XACMLcontext:Attribute&#62;
               &#60;XACMLcontext:Attribute AttributeId&#61;&#34;http://authz-interop.org/xacml/subject/certificate-serial-number&#34; DataType&#61;&#34;http://www.w3.org/2001/XMLSchema#string&#34; xsi:type&#61;&#34;XACMLcontext:AttributeType&#34;&#62;
                  &#60;XACMLcontext:AttributeValue xsi:type&#61;&#34;XACMLcontext:AttributeValueType&#34;&#62;-1&#60;/XACMLcontext:AttributeValue&#62;
               &#60;/XACMLcontext:Attribute&#62;
               &#60;XACMLcontext:Attribute AttributeId&#61;&#34;http://authz-interop.org/xacml/subject/validity-not-before&#34; DataType&#61;&#34;http://www.w3.org/2001/XMLSchema#dateTime&#34; xsi:type&#61;&#34;XACMLcontext:AttributeType&#34;&#62;
                  &#60;XACMLcontext:AttributeValue xsi:type&#61;&#34;XACMLcontext:AttributeValueType&#34;&#62;2013-09-16T19:05:12Z&#60;/XACMLcontext:AttributeValue&#62;
               &#60;/XACMLcontext:Attribute&#62;
               &#60;XACMLcontext:Attribute AttributeId&#61;&#34;http://authz-interop.org/xacml/subject/validity-not-after&#34; DataType&#61;&#34;http://www.w3.org/2001/XMLSchema#dateTime&#34; xsi:type&#61;&#34;XACMLcontext:AttributeType&#34;&#62;
                  &#60;XACMLcontext:AttributeValue xsi:type&#61;&#34;XACMLcontext:AttributeValueType&#34;&#62;2013-09-17T07:10:12Z&#60;/XACMLcontext:AttributeValue&#62;
               &#60;/XACMLcontext:Attribute&#62;
            &#60;/XACMLcontext:Subject&#62;
            &#60;XACMLcontext:Resource xsi:type&#61;&#34;XACMLcontext:ResourceType&#34;&#62;
               &#60;XACMLcontext:Attribute AttributeId&#61;&#34;urn:oasis:names:tc:xacml:1.0:resource:resource-id&#34; DataType&#61;&#34;http://www.w3.org/2001/XMLSchema#string&#34; xsi:type&#61;&#34;XACMLcontext:AttributeType&#34;&#62;
                  &#60;XACMLcontext:AttributeValue xsi:type&#61;&#34;XACMLcontext:AttributeValueType&#34;&#62;http://authz-interop.org/xacml/resource/resource-type/ce&#60;/XACMLcontext:AttributeValue&#62;
               &#60;/XACMLcontext:Attribute&#62;
            &#60;/XACMLcontext:Resource&#62;
            &#60;XACMLcontext:Resource xsi:type&#61;&#34;XACMLcontext:ResourceType&#34;&#62;
               &#60;XACMLcontext:Attribute AttributeId&#61;&#34;http://authz-interop.org/xacml/resource/dns-host-name&#34; DataType&#61;&#34;http://www.w3.org/2001/XMLSchema#string&#34; xsi:type&#61;&#34;XACMLcontext:AttributeType&#34;&#62;
                  &#60;XACMLcontext:AttributeValue xsi:type&#61;&#34;XACMLcontext:AttributeValueType&#34;&#62;t2bat0210.cmsaf.mit.edu&#60;/XACMLcontext:AttributeValue&#62;
               &#60;/XACMLcontext:Attribute&#62;
            &#60;/XACMLcontext:Resource&#62;
            &#60;XACMLcontext:Resource xsi:type&#61;&#34;XACMLcontext:ResourceType&#34;&#62;
               &#60;XACMLcontext:Attribute AttributeId&#61;&#34;http://authz-interop.org/xacml/resource/resource-x509-id&#34; DataType&#61;&#34;http://www.w3.org/2001/XMLSchema#string&#34; xsi:type&#61;&#34;XACMLcontext:AttributeType&#34;&#62;
                  &#60;XACMLcontext:AttributeValue xsi:type&#61;&#34;XACMLcontext:AttributeValueType&#34;&#62;/DC&#61;org/DC&#61;doegrids/OU&#61;Services/CN&#61;t2bat0210.cmsaf.mit.edu&#60;/XACMLcontext:AttributeValue&#62;
               &#60;/XACMLcontext:Attribute&#62;
            &#60;/XACMLcontext:Resource&#62;
            &#60;XACMLcontext:Resource xsi:type&#61;&#34;XACMLcontext:ResourceType&#34;&#62;
               &#60;XACMLcontext:Attribute AttributeId&#61;&#34;http://authz-interop.org/xacml/resource/resource-x509-issuer&#34; DataType&#61;&#34;http://www.w3.org/2001/XMLSchema#string&#34; xsi:type&#61;&#34;XACMLcontext:AttributeType&#34;&#62;
                  &#60;XACMLcontext:AttributeValue xsi:type&#61;&#34;XACMLcontext:AttributeValueType&#34;&#62;/DC&#61;org/DC&#61;DOEGrids/OU&#61;Certificate Authorities/CN&#61;DOEGrids CA 1&#60;/XACMLcontext:AttributeValue&#62;
               &#60;/XACMLcontext:Attribute&#62;
            &#60;/XACMLcontext:Resource&#62;
            &#60;XACMLcontext:Action xsi:type&#61;&#34;XACMLcontext:ActionType&#34;&#62;
               &#60;XACMLcontext:Attribute AttributeId&#61;&#34;urn:oasis:names:tc:xacml:1.0:action:action-id&#34; DataType&#61;&#34;http://www.w3.org/2001/XMLSchema#string&#34; xsi:type&#61;&#34;XACMLcontext:AttributeType&#34;&#62;
                  &#60;XACMLcontext:AttributeValue xsi:type&#61;&#34;XACMLcontext:AttributeValueType&#34;&#62;http://authz-interop.org/xacml/action/action-type/execute-now&#60;/XACMLcontext:AttributeValue&#62;
               &#60;/XACMLcontext:Attribute&#62;
            &#60;/XACMLcontext:Action&#62;
            &#60;XACMLcontext:Environment xsi:type&#61;&#34;XACMLcontext:EnvironmentType&#34;&#62;
               &#60;XACMLcontext:Attribute AttributeId&#61;&#34;urn:oasis:names:tc:xacml:1.0:environment:current-dateTime&#34; DataType&#61;&#34;http://www.w3.org/2001/XMLSchema#dateTime&#34; xsi:type&#61;&#34;XACMLcontext:AttributeType&#34;&#62;
                  &#60;XACMLcontext:AttributeValue xsi:type&#61;&#34;XACMLcontext:AttributeValueType&#34;&#62;2013-09-16T21:37:18Z&#60;/XACMLcontext:AttributeValue&#62;
               &#60;/XACMLcontext:Attribute&#62;
               &#60;XACMLcontext:Attribute AttributeId&#61;&#34;http://authz-interop.org/xacml/environment/pep-oblig-supported&#34; DataType&#61;&#34;http://www.w3.org/2001/XMLSchema#string&#34; xsi:type&#61;&#34;XACMLcontext:AttributeType&#34;&#62;
                  &#60;XACMLcontext:AttributeValue xsi:type&#61;&#34;XACMLcontext:AttributeValueType&#34;&#62;http://authz-interop.org/xacml/obligation/afs-token&#60;/XACMLcontext:AttributeValue&#62;
               &#60;/XACMLcontext:Attribute&#62;
               &#60;XACMLcontext:Attribute AttributeId&#61;&#34;http://authz-interop.org/xacml/environment/pep-oblig-supported&#34; DataType&#61;&#34;http://www.w3.org/2001/XMLSchema#string&#34; xsi:type&#61;&#34;XACMLcontext:AttributeType&#34;&#62;
                  &#60;XACMLcontext:AttributeValue xsi:type&#61;&#34;XACMLcontext:AttributeValueType&#34;&#62;http://authz-interop.org/xacml/obligation/secondary-gids&#60;/XACMLcontext:AttributeValue&#62;
               &#60;/XACMLcontext:Attribute&#62;
               &#60;XACMLcontext:Attribute AttributeId&#61;&#34;http://authz-interop.org/xacml/environment/pep-oblig-supported&#34; DataType&#61;&#34;http://www.w3.org/2001/XMLSchema#string&#34; xsi:type&#61;&#34;XACMLcontext:AttributeType&#34;&#62;
                  &#60;XACMLcontext:AttributeValue xsi:type&#61;&#34;XACMLcontext:AttributeValueType&#34;&#62;http://authz-interop.org/xacml/obligation/uidgid&#60;/XACMLcontext:AttributeValue&#62;
               &#60;/XACMLcontext:Attribute&#62;
               &#60;XACMLcontext:Attribute AttributeId&#61;&#34;http://authz-interop.org/xacml/environment/pep-oblig-supported&#34; DataType&#61;&#34;http://www.w3.org/2001/XMLSchema#string&#34; xsi:type&#61;&#34;XACMLcontext:AttributeType&#34;&#62;
                  &#60;XACMLcontext:AttributeValue xsi:type&#61;&#34;XACMLcontext:AttributeValueType&#34;&#62;http://authz-interop.org/xacml/obligation/username&#60;/XACMLcontext:AttributeValue&#62;
               &#60;/XACMLcontext:Attribute&#62;
            &#60;/XACMLcontext:Environment&#62;
         &#60;/XACMLcontext:Request&#62;
         &#60;xacml-context:Response xmlns:xacml-context&#61;&#34;urn:oasis:names:tc:xacml:2.0:context:schema:os&#34;&#62;
            &#60;xacml-context:Result&#62;
               &#60;xacml-context:Decision&#62;Deny&#60;/xacml-context:Decision&#62;
               &#60;xacml-context:Status&#62;
                  &#60;xacml-context:StatusCode Value&#61;&#34;http://oasis/names/tc/xacml/1.0/status/ok&#34; /&#62;
               &#60;/xacml-context:Status&#62;
               &#60;xacml:Obligations xmlns:xacml&#61;&#34;urn:oasis:names:tc:xacml:2.0:policy:schema:os&#34;&#62;
                  &#60;xacml:Obligation FulfillOn&#61;&#34;Permit&#34; ObligationId&#61;&#34;http://authz-interop.org/xacml/obligation/username&#34; /&#62;
               &#60;/xacml:Obligations&#62;
            &#60;/xacml-context:Result&#62;
         &#60;/xacml-context:Response&#62;
      &#60;/saml:Statement&#62;
   &#60;/saml:Assertion&#62;
&#60;/samlp:Response&#62;
</pre>
</pre>
</div></div> <!--/twistyPlugin-->
<p />
9/17/13 - Now when I submit a job with a GLOW VO proxy, I don't see a response stanza in the XML output.
<p />
<h3><a name="gums_service_developer_log"></a> gums-service-developer.log </h3>
<p />
After turning on DEBUG output for gov.bnl.gums in <code>/etc/gums/log4j-service.properties</code>, I submitted a job with no associated VO and got denied as expected. Additionally, <code>gums-service-admin.log</code> shows it mapping to 'null'.
<p />
<pre class="screen">
17 Sep 2013 11:37:01,220 TP-Processor16 service.GUMSXACMLMappingServiceImpl [DEBUG]: Checking access on '/DC=org/DC=doegrids/OU=Services/CN=t2bat0210.cmsaf.mit.edu' for '/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Brian Lin 1047' with fqan 'null'
17 Sep 2013 11:37:01,255 TP-Processor16 service.GUMSXACMLMappingServiceImpl [DEBUG]: Denied access on '/DC=org/DC=doegrids/OU=Services/CN=t2bat0210.cmsaf.mit.edu' for '/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Brian Lin 1047' with fqan 'null'
</pre>
<p />
Now when trying with the GLOW VO, I get more output but there are a few blank lines in the logs and I don't get a "Denied Access" or "Credentials mapped" response. There are no corresponding entries that show up in <code>gums-service-admin.log</code>
<p />
<pre class="screen">
17 Sep 2013 11:39:39,445 TP-Processor22 service.GUMSXACMLMappingServiceImpl [DEBUG]: Checking access on '/DC=org/DC=doegrids/OU=Services/CN=t2bat0210.cmsaf.mit.edu' for '/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Brian Lin 1047' with fqan '/GLOW/Role=NULL/Capability=NULL'
17 Sep 2013 11:39:39,465 TP-Processor22 service.GUMSXACMLMappingServiceImpl [DEBUG]:
17 Sep 2013 11:39:39,567 TP-Processor24 service.GUMSXACMLMappingServiceImpl [DEBUG]: Checking access on '/DC=org/DC=doegrids/OU=Services/CN=t2bat0210.cmsaf.mit.edu' for '/DC=com/DC=DigiCert-Grid/O=Open Science Grid/OU=People/CN=Brian Lin 1047' with fqan '/GLOW/Role=NULL/Capability=NULL'
17 Sep 2013 11:39:39,583 TP-Processor24 service.GUMSXACMLMappingServiceImpl [DEBUG]:
</pre>
<p />
I get the same problem when submitting via an osgedu VO.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Red_Herrings"></a> Red Herrings? </span></h2>
<p />
<h3><a name="VOMS_GLOW_error_in_catalina_out"></a> VOMS GLOW error in catalina.out </h3>
<p />
There seems to be an issue with GUMS trying to reach out to glow-voms.cs.wisc.edu but:
<p /> <ol>
<li> The VO members in GLOW seem to be up to date. 
</li> <li> These errors do not correspond to each failed job submission.
</li></ol> 
<p />
<div class="twistyPlugin twikiMakeVisibleInline">  <span id="twistyIdMainMitGums3show" class="twistyRememberSetting twistyStartHide twistyTrigger twikiUnvisited twistyInited0"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleopen-small.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Error in catalina.out</span></a> </span> <span id="twistyIdMainMitGums3hide" class="twistyRememberSetting twistyStartHide twistyTrigger twikiUnvisited twistyHidden twistyInited0"><a href="#"><img src="/twiki/pub/TWiki/TWikiDocGraphics/toggleclose-small.gif" border="0" alt="" /><span class="twikiLinkLabel twikiUnvisited">Hide Full Output</span></a> </span>  </div><!--/twistyPlugin twikiMakeVisibleInline--> <div class="twistyPlugin"><div id="twistyIdMainMitGums3toggle" class="twistyRememberSetting twistyStartHide twistyContent twikiMakeHidden twistyInited0">
<pre class="screen">
AxisFault
 faultCode: {http://schemas.xmlsoap.org/soap/envelope/}Server.userException
 faultSubcode:
 faultString: org.glite.security.voms.admin.persistence.error.VOMSDatabaseException: Cannot open connection
 faultActor:
 faultNode:
 faultDetail:
        {http://xml.apache.org/axis/}hostname:glow-voms.cs.wisc.edu

org.glite.security.voms.admin.persistence.error.VOMSDatabaseException: Cannot open connection
        at org.apache.axis.message.SOAPFaultBuilder.createFault(SOAPFaultBuilder.java:222)
        at org.apache.axis.message.SOAPFaultBuilder.endElement(SOAPFaultBuilder.java:129)
        at org.apache.axis.encoding.DeserializationContext.endElement(DeserializationContext.java:1087)
        at org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)
        at org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown Source)
        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)
        at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)
        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)
        at org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)
        at javax.xml.parsers.SAXParser.parse(Unknown Source)
        at org.apache.axis.encoding.DeserializationContext.parse(DeserializationContext.java:227)
        at org.apache.axis.SOAPPart.getAsSOAPEnvelope(SOAPPart.java:696)
        at org.apache.axis.Message.getSOAPEnvelope(Message.java:435)
        at org.apache.axis.handlers.soap.MustUnderstandChecker.invoke(MustUnderstandChecker.java:62)
        at org.apache.axis.client.AxisClient.invoke(AxisClient.java:206)
        at org.apache.axis.client.Call.invokeEngine(Call.java:2784)
        at org.apache.axis.client.Call.invoke(Call.java:2767)
        at org.apache.axis.client.Call.invoke(Call.java:2443)
        at org.apache.axis.client.Call.invoke(Call.java:2366)
        at org.apache.axis.client.Call.invoke(Call.java:1812)
        at org.glite.security.voms.VOMSCompatibilitySoapBindingStub.getGridmapUsers(VOMSCompatibilitySoapBindingStub.java:344)
        at gov.bnl.gums.userGroup.VOMSUserGroup.retrieveMembers(VOMSUserGroup.java:466)
        at gov.bnl.gums.userGroup.VOMSUserGroup.updateMembers(VOMSUserGroup.java:352)
        at gov.bnl.gums.CoreLogic.updateGroupsImpl(CoreLogic.java:457)
        at gov.bnl.gums.CoreLogic.updateGroups(CoreLogic.java:214)
        at gov.bnl.gums.GUMS$1.run(GUMS.java:90)
        at java.util.TimerThread.mainLoop(Timer.java:512)
        at java.util.TimerThread.run(Timer.java:462)
</pre>
</div></div> <!--/twistyPlugin-->
<p />
<h3><a name="gums_config_diff"></a> gums.config diff </h3>
<p />
There were some differences between MIT's GUMS config and a working [with GLOW] Fermicloud VM GUMS config. Changes were made on the Fermicloud VM to match what was on MIT and the Fermicloud GUMS server was still functional.
<p />
<pre class="screen">
<pre>
--- mit            2013-09-16 15:59:07.494967495 -0500
+++ fermi          2013-09-16 15:56:51.108528790 -0500
&#64;&#64; -9,12 +9,12 &#64;&#64;
 &#60;vomsUserGroup
-name&#61;&#39;GLOW&#39;
-access&#61;&#39;read all&#39;
+name&#61;&#39;glow&#39;
+access&#61;&#39;read self&#39;
 description&#61;&#39;&#39;
 vomsServer&#61;&#39;glow&#39;
-matchFQAN&#61;&#39;exact&#39;
-acceptProxyWithoutFQAN&#61;&#39;false&#39;
+matchFQAN&#61;&#39;vo&#39;
+acceptProxyWithoutFQAN&#61;&#39;true&#39;
 voGroup&#61;&#39;/GLOW&#39;/&#62;
</pre>
</pre>
<p />
-- <a href="/bin/view/Main/BrianLin" class="twikiLink">BrianLin</a> - 16 Sep 2013</div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Main<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Main/BrianLin" class="twikiLink">BrianLin</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>MitGums</span> <br />    
Topic revision: r5 - 17 Sep 2013 - 18:24:37 - <a href="/bin/view/Main/BrianLin" class="twikiLink">BrianLin</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />