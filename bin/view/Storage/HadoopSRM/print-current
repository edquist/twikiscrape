<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> HadoopSRM &lt; Storage &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Storage/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Storage/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Storage/HadoopSRM?_T=16 Feb 2017" type="application/x-wiki" title="edit HadoopSRM" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Storage/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Storage/HadoopSRM"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#0000FF;
	}
	.patternBookView {
		border-color:#0000FF;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <h1><a name="Hadoop_SRM"></a>  <strong><noop>Hadoop SRM</strong> </h1>
<p />
<p />
<font color="#ff0000">
WARNING! This page is for an older version of Hadoop.
For newer versions, please visit <a href="/bin/view/Documentation/Release3/InstallHadoopSE" class="twikiLink">Hadoop Release 3 Installation</a>
</font>
<p />
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#Installation"> Installation</a> <ul>
<li> <a href="?cover=print#Quick_Start"> Quick Start</a>
</li> <li> <a href="?cover=print#Prerequisites"> Prerequisites</a>
</li> <li> <a href="?cover=print#YUM_Installation"> YUM Installation</a>
</li></ul> 
</li> <li> <a href="?cover=print#Configuration"> Configuration</a> <ul>
<li> <a href="?cover=print#Running_Bestman_SRM"> Running Bestman SRM</a> <ul>
<li> <a href="?cover=print#JMX_Monitoring"> JMX Monitoring</a>
</li></ul> 
</li></ul> 
</li></ul> 
</div>
<p />
<h1><a name="Installation"></a> Installation </h1>
<p />
Hadoop uses the <a href="https://twiki.grid.iu.edu/bin/view/Trash/ReleaseDocumentationBestmanGateway" target="_top">Bestman SRM server</a> in gateway mode to provide a SRM interface to Hadoop.  Bestman will use the Hadoop FUSE interface for namespace operations, such as mkdir, rm, and ls.  Bestman will use a <a href="/bin/view/Storage/HadoopGridFTP" class="twikiLink">Gridftp</a> server for reading and writing files.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Quick_Start"></a> Quick Start </span></h2>
<p />
Quickstart for the impatient.  This assumes you already have <a href="/bin/view/Storage/HadoopInstallation" class="twikiLink">Hadoop and FUSE</a> installed on the SRM server.
<p />
 <pre>
rpm -ivh http://vdt.cs.wisc.edu/hadoop/osg-hadoop-1-2.el5.noarch.rpm
yum install bestman
vi /opt/bestman/conf/bestman.rc # Edit appropriately (see below)
visudo # Add specific sudo privileges for the bestman user (see below)
service bestman start
</pre>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Prerequisites"></a> Prerequisites </span></h2>
<p />
The Bestman server has the following prerequisites:
<p /> <ol>
<li> You must also have already <a href="/bin/view/Storage/HadoopInstallation" class="twikiLink">installed and mounted</a> Hadoop using FUSE.
</li> <li> A <a href="/bin/view/Storage/HadoopGridFTP" class="twikiLink">GridFTP-HDFS</a> server must also be installed, but this does not need to be on the same server as the <span class="twikiNewLink">BestMan<a href="/bin/edit/Storage/BestMan?topicparent=Storage.HadoopSRM" rel="nofollow" title="BestMan (this topic does not yet exist; you can create it)">?</a></span> server.  A larger site will prefer to have their <span class="twikiNewLink">GridFTP<a href="/bin/edit/Storage/GridFTP?topicparent=Storage.HadoopSRM" rel="nofollow" title="GridFTP (this topic does not yet exist; you can create it)">?</a></span> and <a href="/bin/view/Storage/BeStMan" class="twikiLink">BeStMan</a> servers installed on separate hosts; see the list of <span class="twikiNewLink">deployment layouts<a href="/bin/edit/Storage/HadoopArchitectures?topicparent=Storage.HadoopSRM" rel="nofollow" title="deployment layouts (this topic does not yet exist; you can create it)">?</a></span> for more information.
</li></ol> 
<p />
Bestman is preconfigured to look for the host certificate and key in <code>/etc/grid-security/http/http*.pem</code>.
These files must exist and be readable by the bestman user.  Using certificates in a different directory or with different names is not supported.
<p />
The installation includes the latest CA Certificates package from the OSG as well as the fetch-crl CRL updater.
<p />
The rpm/yum installation will create a 'bestman' system account and group (uid,gid &lt; 500) on the host system for running the bestman SRM process. If you would like to control the uid/gid that is used, then you should create the 'bestman' user and group manually before installing the rpms.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="YUM_Installation"></a> YUM Installation </span></h2>
<p />
Remember, in order to use Bestman SRM, you must have the <a href="/bin/view/Storage/HadoopInstallation" class="twikiLink">Hadoop and the FUSE kernel module</a> already installed on your system in order to use the yum installer.
<p />
To configure your local installation for the yum repository, <a href="/bin/view/Storage/HadoopInstallation#Yum_install" class="twikiAnchorLink">follow the advice here</a> to install the <code>osg-hadoop</code> package for your site.
<p />
After installing the osg-hadoop yum configuration package, you can install the Bestman SRM server with:
<p />
<pre>
yum install bestman
</pre>
<p />
Updates can be installed with:
<p />
<pre>
yum upgrade bestman
</pre>
<p />
<h1><a name="Configuration"></a> Configuration </h1>
<p />
For those familiar with the VDT installation of bestman, you will know about the <code>configure_bestman</code> script for configuring the bestman server.  This script is not supported in the RPM package and will be removed in future releases.  Certain operations that you would normally do with <code>configure_bestman</code>, such as changing the certificate location, are not supported.
<p />
The installation of bestman and its dependencies creates several directories.  In addition to the Hadoop installation files, you will also find:
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table1" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> Log files </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> <code>/var/log/bestman</code> </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> runtime config files </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> <code>/opt/bestman/conf/*</code> </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> Bestman files </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> <code>/opt/bestman/</code> </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> init.d startup script </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1 twikiLastCol"> <code>/etc/init.d/bestman</code> </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> CA certificates </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol twikiLast"> <code>/etc/grid-security/certificates/*</code> </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
Bestman SRM uses the Hadoop FUSE mount to perform namespace operations, such as mkdir, rm, and ls.  As per the <a href="/bin/view/Storage/HadoopInstallation" class="twikiLink">Hadoop install instructions</a>, edit <code>/etc/sysconfig/hadoop</code> and run <code>service hadoop-firstboot start</code>.  It is <strong>not</strong> necessary (or even recommended) to start any hadoop services with <code>service hadoop start</code>.
<p />
The Bestman SRM configuration file is located in <code>/opt/bestman/conf/bestman.rc</code>.  There are a few settings that you need to add or change manually, depending on your site configuration:
<p />
<pre>
supportedProtocolList&#61;gsiftp://your.gridftp.server1:2811;gsiftp://your.gridftp.server2:2811
GUMSserviceURL&#61;https://your.gums.host:8443/gums/services/GUMSAuthorizationServicePort
localPathListAllowed&#61;/mnt/hadoop;/tmp
</pre>
<p />
Bestman uses sudo to perform changes to the filesystem namespace.  This ensures that directories get created and file get removed with the proper permissions.  You must manually add permissions.  Append the following to the end of the <code>/etc/sudoers</code> file with the <code>visudo</code> command:
<p />
<pre>
Cmnd&#95;Alias SRM&#95;CMD &#61; /bin/rm, /bin/mkdir, /bin/rmdir, /bin/mv, /bin/ls 
Runas&#95;Alias SRM&#95;USR &#61; ALL, !root 
bestman ALL&#61;(SRM&#95;USR) NOPASSWD:SRM&#95;CMD
</pre>
<p />
If you are running SL5, comment out the following line in /etc/sudoers:
<pre>
Defaults    requiretty
</pre>
With this option enabled, BeStMan will be unable to use sudo because it doesn't use a console.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Running_Bestman_SRM"></a> Running Bestman SRM </span></h2>
<p />
Start the Bestman SRM server with the command
<p />
<pre>
service bestman start
</pre>
<p />
To start Bestman SRM automatically at boot time:
<p />
<pre>
chkconfig bestman on
</pre>
<p />
<h3><a name="JMX_Monitoring"></a> JMX Monitoring </h3>
<p />
This is an optional customization which will allow admins to closely monitor <a href="/bin/view/Storage/BeStMan" class="twikiLink">BeStMan</a> activity.  This is not needed for a typical install.
<p />
This allows service administrators to closely monitor memory usage
and thread activity in a much more Java-centric manner than Ganglia
monitoring. To enable this, add the following command-line arguments
to the call to <code>java</code> in <code>$VDT_LOCATION/bestman/sbin/bestman.server</code>:
<p />
<pre>
-Dcom.sun.management.jmxremote.authenticate&#61;false -Dcom.sun.management.jmxremote&#61;true -Dcom.sun.management.jmxremote.ssl&#61;false -Dcom.sun.management.jmxremote.port&#61;8004
</pre>
<p />
Note that this allows anyone with access to port 8004 access to read
out your JVM internal metrics.</div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Storage<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span><a href="/bin/view/Storage/WebHome" class="twikiCurrentWebHomeLink twikiLink">WebHome</a> &gt; <a href="/bin/view/Storage/Hadoop" class="twikiLink">Hadoop</a><span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>HadoopSRM</span> <br />    
Topic revision: r15 - 07 Feb 2017 - 17:42:42 - <a href="/bin/view/Main/BrianBockelman" class="twikiLink">BrianBockelman</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />