<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> BeStManUseCases &lt; Storage &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Storage/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Storage/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Storage/BeStManUseCases?_T=16 Feb 2017" type="application/x-wiki" title="edit BeStManUseCases" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Storage/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Storage/BeStManUseCases"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#0000FF;
	}
	.patternBookView {
		border-color:#0000FF;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <h1><a name="BeStMan_Configuration_Use_Cases"></a>  <strong><noop>BeStMan Configuration Use Cases (BeStManUseCases)</strong> </h1>
<p />
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#Introduction"> Introduction</a>
</li> <li> <a href="?cover=print#VDT_BeStMan_Configuration_Script"> VDT BeStMan Configuration Script</a> <ul>
<li> <a href="?cover=print#BeStMan_fullmode_with_volatile_m"> BeStMan fullmode with volatile managed cache </a>
</li> <li> <a href="?cover=print#Configuring_volatile_and_permane"> Configuring volatile and permanent managed caches with BeStMan native script</a>
</li></ul> 
</li> <li> <a href="?cover=print#SRM_LBNL_Client_Commands"> SRM LBNL Client Commands</a> <ul>
<li> <a href="?cover=print#srm_copy_example_1"> srm-copy example #1 </a>
</li> <li> <a href="?cover=print#srm_copy_example_2"> srm-copy example #2</a>
</li> <li> <a href="?cover=print#srm_copy_example_3"> srm-copy example #3</a>
</li> <li> <a href="?cover=print#srm_copy_example_4"> srm-copy example #4</a>
</li></ul> 
</li> <li> <a href="?cover=print#SRM_Fermi_Client_Commands"> SRM Fermi Client Commands</a> <ul>
<li> <a href="?cover=print#srmcp_example_1"> srmcp example #1 </a>
</li></ul> 
</li> <li> <a href="?cover=print#LCG_Utils_Client_Commands"> LCG_Utils Client Commands</a> <ul>
<li> <a href="?cover=print#lcg_cp_example_1"> lcg-cp example #1 </a>
</li> <li> <a href="?cover=print#lcg_cp_example_2"> lcg-cp example #2</a>
</li> <li> <a href="?cover=print#lcg_cp_example_3"> lcg-cp example #3</a>
</li></ul> 
</li> <li> <a href="?cover=print#SRM_Fermi_Client_Problems"> SRM Fermi Client Problems</a>
</li> <li> <a href="?cover=print#LCG_Utils_Problems"> LCG Utils Problems</a>
</li></ul> 
</div>
<p />
<p />
<p />
<strong>Purpose</strong>: The purpose of this document is to provide additional information about possible configuration use cases for  <a href="http://sdm.lbl.gov/bestman" target="_top">BeStMan</a>.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Introduction"></a> Introduction </span></h2>
BeStMan could be installed from VDT or directly downloaded from  <a href="http://sdm.lbl.gov/bestman" target="_top">here</a>. The detailed BeStMan configuration Guide doesn't not cover all the possible cases, so it seems to be reasonable to provide additional information for site administrators that are planning to install, configure and use BeStMan as a OSG SE.
<p />
In this document we assume that you have already installed BeStMan and are in a process of configuring it.
<p />
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table1" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Storage/BeStManUseCases?cover=print;sortcol=0;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">BeStMan Flavor</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol1"> <a rel="nofollow" href="/bin/view/Storage/BeStManUseCases?cover=print;sortcol=1;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Type of Storage</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol2"> <a rel="nofollow" href="/bin/view/Storage/BeStManUseCases?cover=print;sortcol=2;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Space Management</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol3"> <a rel="nofollow" href="/bin/view/Storage/BeStManUseCases?cover=print;sortcol=3;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Sudoers enabled</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol4"> <a rel="nofollow" href="/bin/view/Storage/BeStManUseCases?cover=print;sortcol=4;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Configuration</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol5"> <a rel="nofollow" href="/bin/view/Storage/BeStManUseCases?cover=print;sortcol=5;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">LBNL Client</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol6"> <a rel="nofollow" href="/bin/view/Storage/BeStManUseCases?cover=print;sortcol=6;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Fermi Client</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol7 twikiLastCol"> <a rel="nofollow" href="/bin/view/Storage/BeStManUseCases?cover=print;sortcol=7;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">LCG Utils</font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> fullmode </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1"> Volatile storage </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2"> BeStMan managed cache </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol3"> no </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol4"> Could be configured by <a href="/bin/view/Storage/BeStManUseCases#BeStMan_fullmode_with_volatile_m" class="twikiCurrentTopicLink twikiAnchorLink">vdt configure_bestman</a> script </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol5"> srm-copy works <a href="/bin/view/Storage/BeStManUseCases#srm_copy_example_1" class="twikiCurrentTopicLink twikiAnchorLink">example #1</a> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol6"> srmcp works <a href="/bin/view/Storage/BeStManUseCases#srmcp_example_1" class="twikiCurrentTopicLink twikiAnchorLink">example #1</a>  <a href="/bin/view/Storage/BeStManUseCases#SRM_Fermi_Client_Problems" class="twikiCurrentTopicLink twikiAnchorLink">with some issues</a> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol7 twikiLastCol"> lcg-cp fails <a href="/bin/view/Storage/BeStManUseCases#LCG_Utils_Problems" class="twikiCurrentTopicLink twikiAnchorLink">with this error</a> </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> &nbsp; </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol1"> Volatile and permanent storage </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol2"> BeStMan managed cache and user managed cached </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol3"> yes </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol4"> Could be configured by <a href="/bin/view/Storage/BeStManUseCases#BeStMan_fullmode_with_volatile_m" class="twikiCurrentTopicLink twikiAnchorLink">vdt configure_bestman</a> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol5"> srm-copy works  <a href="/bin/view/Storage/BeStManUseCases#srm_copy_example_1" class="twikiCurrentTopicLink twikiAnchorLink">example #1</a> and  <a href="/bin/view/Storage/BeStManUseCases#srm_copy_example_2" class="twikiCurrentTopicLink twikiAnchorLink">example #2</a> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol6"> srmcp works  <a href="/bin/view/Storage/BeStManUseCases#SRM_Fermi_Client_Problems" class="twikiCurrentTopicLink twikiAnchorLink">with some issues</a> </td>
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol7 twikiLastCol"> lcg-cp works in  user's controlled cache (without space token)<a href="/bin/view/Storage/BeStManUseCases#lcg_cp_example_1" class="twikiCurrentTopicLink twikiAnchorLink">example #1</a> </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast">  </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLast"> Volatile and permanent storage </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol2 twikiLast"> BeStMan managed volatile and permanent caches </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol3 twikiLast"> no </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol4 twikiLast"> Have to be configured using  <a href="/bin/view/Storage/BeStManUseCases#Configuring_volatile_and_permane" class="twikiCurrentTopicLink twikiAnchorLink">native configuration script</a> </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol5 twikiLast"> srm-copy without space token always writes to volatile cache even when -retentionpolicy custodial is specified [[BeStManUseCases#srm_copy_example_3][example #3]. srm-copy with space token  [[BeStManUseCases#srm_copy_example_4][example #4]writes to custodial place if reserved space token was allocated for the custodial space </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol6 twikiLast"> srmcp works the same way as srm-copy </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol7 twikiLastCol twikiLast"> lcg-cp without space token<a href="/bin/view/Storage/BeStManUseCases#lcg_cp_example_2" class="twikiCurrentTopicLink twikiAnchorLink">example #2</a> and with "custodial" space token writes into custodial space <a href="/bin/view/Storage/BeStManUseCases#lcg_cp_example_3" class="twikiCurrentTopicLink twikiAnchorLink">example #3</a> </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="VDT_BeStMan_Configuration_Script"></a> VDT <a href="/bin/view/Storage/BeStMan" class="twikiLink">BeStMan</a> Configuration Script </span></h2>
<p />
The configuration script provided from VDT allows to setup limited subset of BeStMan parameters.
<p />
<pre class='screen'>
# vdt/setup/configure_bestman --help
Usage: vdt/setup/configure_bestman --vdt-install &lt;vdt install root&gt;
        --server &lt;y,n&gt;
        --user &lt;bestman user&gt;
        --cert &lt;bestman service cert&gt;
        --key  &lt;bestman service key&gt;
        --http-port &lt;public port number&gt;
        --https-port &lt;secure port number&gt;
        --globus-tcp-port-range &lt;low_port,high_port&gt;
        --volatile-file-lifetime &lt;lifetime in seconds&gt;
        --cache-size &lt;Cache size in MB&gt;
        --gums-host &lt;GUMS hostname&gt;
        --gums-port &lt;GUMS port number&gt;
        --gums-url &lt;GUMS URL&gt;
        --gums-dn &lt;Client DN for GUMS interface&gt;
        --enable-gateway
        --use-xrootd
        --with-tokens-list &lt;token-list&gt;
        --with-transfer-servers &lt;GridFTP server list&gt;
        --with-allowed-paths &lt;List of accessible paths&gt;
        --with-blocked-paths &lt;List of non-accessible paths&gt;
</pre>
<p />
<h3><a name="BeStMan_fullmode_with_volatile_m"></a> BeStMan fullmode with volatile managed cache </h3>
<p />
BeStMan fullmode with volatile managed cache could be configured with the following command:
<pre class="screen">
cd &lt;$VDT_LOCATION&gt;
. setup.sh
 vdt/setup/configure_bestman  --user daemon --cert &lt;bestmancert.pem&gt; --key  &lt;bestmankey.pem&gt; --server y  -- volatile-file-lifetime &lt;lifetime in seconds&gt;
</pre>
<p />
If volatile-file-lifetime is not set the lifetime of the file is set for 3 minutes, after that time the file is not accessible.
<p />
BeStMan fullmode could be used as in a gateway mode for user managed storage area.  If instead of SFN for manage cache you specify any directory that user has right to write (e.g. /tmp) BeStMan will allow filed to be copied in a specified location. If sudoers is modified accordingly BeStMan allows user to remove file, create and remove directory in the user managed area. User will not be able to  write to this area with dynamic space token. Bestman could limit the access of user managed cache if you specified 
<pre class="screen">
  --with-allowed-paths &lt;List of accessible paths&gt;
#or
  --with-blocked-paths &lt;List of non-accessible paths&gt;
</pre>
<p />
<h3><a name="Configuring_volatile_and_permane"></a> Configuring volatile and permanent managed caches with BeStMan native script </h3>
<p />
VDT doesn't provide enough option in configure_bestman script to allow you to configure BeStMan with volatile and permanent managed cache. In order to do so you will need to run native configuration script with the following parameters:
<pre class="screen">
cd &lt;VDT_LOCATION&gt;
cd bestman/setup
 ./configure  --with-java-home=&lt;JAVA_HOME&gt; \
       --with-srm-home=$VDT_LOCATION/bestman \
       --with-srm-owner=daemon \
       --with-cacert-path=$VDT_LOCATION/globus/TRUSTED_CA \
       --with-certfile-path=&lt;bestmancert.pem&gt; \
       --with-keyfile-path=&lt;bestmankey.pem&gt; \
       --with-eventlog-path=$VDT_LOCATION/vdt-app-data/bestman/logs \
       --with-cachelog-path=$VDT_LOCATION/bestman/logs \
       --with-http-port=10080 --with-https-port=10443  
       --enable-gums --with-gums-url=https://&lt;GUMS_HOST&gt;:&lt;GUMS_PORT&gt;/gums/services/GUMSAuthorizationServicePort \
       --enable-full-mode  --with-replica-storage-path=$VDT_LOCATION/bestman/cache  --with-replica-storage-size=&lt;SIZE&gt; \
       --with-custodial-storage-path=&lt;CACHE_NAME&gt;  --with-custodial-storage-size=&lt;SIZ&gt;
</pre>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="SRM_LBNL_Client_Commands"></a> SRM LBNL Client Commands </span></h2>
<h3><a name="srm_copy_example_1"></a> srm-copy example #1 </h3>
<p />
Writing file to volatile managed  cache:
<pre class="screen">
 srm-copy file:////tmp/test srm://fg0x1.fnal.gov:10443/srm/v2/server\?SFN=/srmcache/~/test_dir_1/test1
</pre>
<p />
<h3><a name="srm_copy_example_2"></a> srm-copy example #2 </h3>
<p />
Writing file to permanent user managed cache:
<pre class="screen">
 srm-copy file:////tmp/test srm://fg0x1.fnal.gov:10443/srm/v2/server\?SFN=/tmp/test1
</pre>
<p />
<h3><a name="srm_copy_example_3"></a> srm-copy example #3 </h3>
<p />
Writing file with retention policy option "custodial" still results in copying file into volatile cache:
<pre class="screen">
 srm-copy   file:////tmp/test srm://fg0x1.fnal.gov:10443/srm/v2/server\?SFN=/srmcache/~/test_dir_1/test20  -retention_policy=custodial
srm-copy   2.2.1.2.i7.p3  Fri Jul 10 15:56:18 PDT 2009
SRM-Clients and BeStMan Copyright(c) 2007-2009,
Lawrence Berkeley National Laboratory. All rights reserved.
Support at SRM@LBL.GOV and documents at http://datagrid.lbl.gov/bestman
 
SRM-CLIENT: Wed Sep 09 14:01:22 CDT 2009 Connecting to httpg://fg0x1.fnal.gov:10443/srm/v2/server

SRM-CLIENT: Wed Sep 09 14:01:23 CDT 2009 Calling SrmPrepareToPutRequest now ...
request.token=fnalgrid:30_PUT_3015184577
status=SRM_REQUEST_INPROGRESS
explanation=null
SRM-CLIENT: Next status call in 10 seconds.
SRM-CLIENT: Wed Sep 09 14:01:35 CDT 2009 Calling Status at Wed Sep 09 14:01:35 CDT 2009
SRM-CLIENT: Result Status from SRM (srmStatusOfPutRequest)=SRM_SUCCESS

SRM-CLIENT: RemainingPinTime=289
SRM-CLIENT: received TURL=gsiftp://fg0x1.fnal.gov//usr/local/osg-bestman-fullmode/vdt-app-data/bestman/cache/fnalgrid/V.0.0-276258463/test20

SRM-CLIENT: Wed Sep 09 14:01:35 CDT 2009 start file transfer
SRM-CLIENT:Source=file:////tmp/test
SRM-CLIENT:Target=gsiftp://fg0x1.fnal.gov//usr/local/osg-bestman-fullmode/vdt-app-data/bestman/cache/fnalgrid/V.0.0-276258463/test20

SRM-CLIENT: Wed Sep 09 14:01:37 CDT 2009 end file transfer for file:////tmp/test

SRM-CLIENT: Wed Sep 09 14:01:37 CDT 2009 Calling putDone for srm://fg0x1.fnal.gov:10443/srm/v2/server?SFN=/srmcache/~/test_dir_1/test20
Result.status=SRM_SUCCESS
Result.Explanation=null

SRM-CLIENT: Request completed with success

SRM-CLIENT: Printing text report now ...

SRM-CLIENT*REQUESTTYPE=put
SRM-CLIENT*TOTALFILES=1
SRM-CLIENT*TOTAL_SUCCESS=1
SRM-CLIENT*TOTAL_FAILED=0
SRM-CLIENT*REQUEST_TOKEN=fnalgrid:30_PUT_3015184577
SRM-CLIENT*REQUEST_STATUS=SRM_SUCCESS
SRM-CLIENT*SOURCEURL[0]=file:////tmp/test
SRM-CLIENT*TARGETURL[0]=srm://fg0x1.fnal.gov:10443/srm/v2/server?SFN=/srmcache/~/test_dir_1/test20
SRM-CLIENT*TRANSFERURL[0]=gsiftp://fg0x1.fnal.gov//usr/local/osg-bestman-fullmode/vdt-app-data/bestman/cache/fnalgrid/V.0.0-276258463/test20
SRM-CLIENT*ACTUALSIZE[0]=0
SRM-CLIENT*FILE_STATUS[0]=SRM_SUCCESS
SRM-CLIENT*EXPLANATION[0]=SRM-CLIENT: PutDone is called successfully
</pre>
<p />
<h3><a name="srm_copy_example_4"></a> srm-copy example #4 </h3>
<p />
If user reserves space toke in permanent managed cache, he can then write the file into that cache by specifying token id:
<pre class="screen">
srm-sp-reserve srm://fg0x1.fnal.gov:10443/srm/v2/server\?SFN=/srmcache/~ -size 1000000 -gsize 1000000 -lifetime 10000000  -userdesc custodial_space_2 -retentionpolicy custodial
srm-sp-reserve   2.2.1.2.i7.p3  Fri Jul 10 15:56:18 PDT 2009
SRM-Clients and BeStMan Copyright(c) 2007-2009,
Lawrence Berkeley National Laboratory. All rights reserved.
Support at SRM@LBL.GOV and documents at http://datagrid.lbl.gov/bestman
 

SRM-CLIENT: Exception from client=Unable to locate a login configuration
SRM-CLIENT: Connecting to serviceurl httpg://fg0x1.fnal.gov:10443/srm/v2/server
SRM-CLIENT: Wed Sep 09 14:05:03 CDT 2009 Calling SrmReserveSpace

SRM-CLIENT: .......................
        Status Code=SRM_SUCCESS
        SpaceToken=P.9
        TotalReservedSpaceSize=1000000
        Guaranteed Space Size=1000000
        Lifetime=-1

Printing text report now...

SRM-CLIENT*REQUEST_STATUS=SRM_SUCCESS
SRM-CLIENT*REQUEST-TOKEN=null
SRM-CLIENT*SPACE-TOKEN=P.9
SRM-CLIENT*EXPLANATION=null
SRM-CLIENT*TOTALRESERVEDSPACESIZE=1000000
SRM-CLIENT*GUARANTEEDSPACESIZE=1000000
SRM-CLIENT*LIFETIME=-1


#and 

srm-copy   file:////tmp/test srm://fg0x1.fnal.gov:10443/srm/v2/server\?SFN=/srmcache/~/test_dir_1/test21  -space_token=P.9
srm-copy   2.2.1.2.i7.p3  Fri Jul 10 15:56:18 PDT 2009
SRM-Clients and BeStMan Copyright(c) 2007-2009,
Lawrence Berkeley National Laboratory. All rights reserved.
Support at SRM@LBL.GOV and documents at http://datagrid.lbl.gov/bestman
 
SRM-CLIENT: Wed Sep 09 14:05:48 CDT 2009 Connecting to httpg://fg0x1.fnal.gov:10443/srm/v2/server

SRM-CLIENT: Wed Sep 09 14:05:49 CDT 2009 Calling SrmPrepareToPutRequest now ...
request.token=fnalgrid:31_PUT_3015184577
status=SRM_REQUEST_INPROGRESS
explanation=null
SRM-CLIENT: Next status call in 10 seconds.
SRM-CLIENT: Wed Sep 09 14:06:00 CDT 2009 Calling Status at Wed Sep 09 14:06:00 CDT 2009
SRM-CLIENT: Result Status from SRM (srmStatusOfPutRequest)=SRM_SUCCESS

SRM-CLIENT: RemainingPinTime=289
SRM-CLIENT: received TURL=gsiftp://fg0x1.fnal.gov//cache/fnalgrid/P.9-656461282/test21

SRM-CLIENT: Wed Sep 09 14:06:01 CDT 2009 start file transfer
SRM-CLIENT:Source=file:////tmp/test
SRM-CLIENT:Target=gsiftp://fg0x1.fnal.gov//cache/fnalgrid/P.9-656461282/test21

SRM-CLIENT: Wed Sep 09 14:06:04 CDT 2009 end file transfer for file:////tmp/test

SRM-CLIENT: Wed Sep 09 14:06:04 CDT 2009 Calling putDone for srm://fg0x1.fnal.gov:10443/srm/v2/server?SFN=/srmcache/~/test_dir_1/test21
Result.status=SRM_SUCCESS
Result.Explanation=null

SRM-CLIENT: Request completed with success

SRM-CLIENT: Printing text report now ...

SRM-CLIENT*REQUESTTYPE=put
SRM-CLIENT*TOTALFILES=1
SRM-CLIENT*TOTAL_SUCCESS=1
SRM-CLIENT*TOTAL_FAILED=0
SRM-CLIENT*REQUEST_TOKEN=fnalgrid:31_PUT_3015184577
SRM-CLIENT*REQUEST_STATUS=SRM_SUCCESS
SRM-CLIENT*SOURCEURL[0]=file:////tmp/test
SRM-CLIENT*TARGETURL[0]=srm://fg0x1.fnal.gov:10443/srm/v2/server?SFN=/srmcache/~/test_dir_1/test21
SRM-CLIENT*TRANSFERURL[0]=gsiftp://fg0x1.fnal.gov//cache/fnalgrid/P.9-656461282/test21
SRM-CLIENT*ACTUALSIZE[0]=0
SRM-CLIENT*FILE_STATUS[0]=SRM_SUCCESS
SRM-CLIENT*EXPLANATION[0]=SRM-CLIENT: PutDone is called successfully

</pre>
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="SRM_Fermi_Client_Commands"></a> SRM Fermi Client Commands </span></h2>
<h3><a name="srmcp_example_1"></a> srmcp example #1 </h3>
<pre class="screen">
srmcp -2  -send_cksm=false  file:////tmp/test srm://fg0x1.fnal.gov:10443/srm/v2/server?SFN=/srmcache/~/test_dir_1/test2
</pre>
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="LCG_Utils_Client_Commands"></a> LCG_Utils Client Commands </span></h2>
<h3><a name="lcg_cp_example_1"></a> lcg-cp example #1 </h3>
<p />
Copying file into permanent user controled space:
<p />
<pre class="screen">
 lcg-cp  -v --nobdii -D  srmv2 file:////tmp/test srm://fg0x1.fnal.gov:10443/srm/v2/server\?SFN=/tmp/test
</pre>
<p />
<h3><a name="lcg_cp_example_2"></a> lcg-cp example #2 </h3>
Copying file into permanent managed cache
<pre class="screen">
 lcg-cp  -v --nobdii -D  srmv2 file:////tmp/test srm://fg0x1.fnal.gov:10443/srm/v2/server\?SFN=/srmcache/~/test_dir_1/test3
</pre>
<p />
<h3><a name="lcg_cp_example_3"></a> lcg-cp example #3 </h3>
Copying file into permanent managed cache using space token description:
<p />
<pre class="screen">
 lcg-cp  -v --nobdii -D  srmv2 file:////tmp/test srm://fg0x1.fnal.gov:10443/srm/v2/server\?SFN=/srmcache/~/test_dir_1/test4 -S custodial_space_2
</pre>
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="SRM_Fermi_Client_Problems"></a> SRM Fermi Client Problems </span></h2>
<p /> <ol>
<li> srmcp  setup to verify  checksum by default, so attempt to use it with <a href="/bin/view/Storage/BeStMan" class="twikiLink">BeStMan</a> produces the following error:
</li></ol> 
<pre class="screen">
>srmcp -2 file:////tmp/test srm://fg0x1.fnal.gov:10443/srm/v2/server?SFN=/srmcache/~/test_dir_1/test2
GridftpClient: Was not able to send checksum value:org.globus.ftp.exception.ServerException: Server refused performing the request. Custom message:  (error code 1) [Nested exception message:  Custom message: Unexpected reply: 500 Invalid command.] [Nested exception is org.globus.ftp.exception.UnexpectedReplyCodeException:  Custom message: Unexpected reply: 500 Invalid command.]

>echo $?
0
</pre>
<p />
The file is copied successfully despite of the error. You should specify -send_cksm=false in order to avoid this error.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="LCG_Utils_Problems"></a> LCG Utils Problems </span></h2>
<p />
    1. lcg-cp works only with permanent storage, so when you try to execute lcg-cp command with volatile storage it produces the following error:
<pre class="screen">
>lcg-cp  --nobdii  -U srmv2 file:////tmp/test srm://fg0x1.fnal.gov:10443/srm/v2/server\?SFN=/srmcache/~//test_dir_1/test4
srm://fg0x1.fnal.gov:10443/srm/v2/server?SFN=/srmcache/~//test_dir_1/test4: Invalid argument
lcg_cp: Invalid argument
</pre>
<p />
-- <a href="/bin/view/Main/TanyaLevshina" class="twikiLink">TanyaLevshina</a> - 09 Sep 2009</div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Storage<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>BeStManUseCases</span> <br />    
Topic revision: r1 - 09 Sep 2009 - 19:16:47 - <a href="/bin/view/Main/TanyaLevshina" class="twikiLink">TanyaLevshina</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />