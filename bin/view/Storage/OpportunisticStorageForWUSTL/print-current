<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
<link rel="stylesheet" href="https://twiki.opensciencegrid.org/twiki/pub/TWiki/HeadlinesPlugin/style.css" type="text/css" media="all" />
<title> OpportunisticStorageForWUSTL &lt; Storage &lt; TWiki    </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="icon" href="/twiki/pub/Storage/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="shortcut icon" href="/twiki/pub/Storage/WebPreferences/favicon.ico    " type="image/x-icon" />
<link rel="alternate" href="https://twiki.opensciencegrid.org/bin/edit/Storage/OpportunisticStorageForWUSTL?_T=16 Feb 2017" type="application/x-wiki" title="edit OpportunisticStorageForWUSTL" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<meta name="robots" content="noindex" /><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/Storage/WebRss" />    
<base href="https://twiki.opensciencegrid.org/bin/view/Storage/OpportunisticStorageForWUSTL"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/twiki/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/twiki/pub/TWiki/PatternSkin/pattern.js"></script><style type="text/css" media="all">
@import url('/twiki/pub/TWiki/TWikiTemplates/base.css');
</style><script type="text/javascript" src="/twiki/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script><style type="text/css" media="all">


</style>
<style type="text/css" media="all">
@import url("/twiki/pub/TWiki/TWikiNetSkin/layout.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/style.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/colors.css");
@import url("/twiki/pub/TWiki/TWikiNetSkin/rounded_corners.css");
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	#patternLeftBar .patternWebIndicator,
	.patternBookView .twikiTopRow {
		background-color:#0000FF;
	}
	.patternBookView {
		border-color:#0000FF;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/twiki/pub/TWiki/PreviewBackground/preview2bg.gif    ");*/
	}
	
</style><style type="text/css" media="all">



</style>
<style type="text/css" media="all">
	@import url("/twiki/pub/TWiki/TWikiNetSkin/print.css");
</style><!--GOOGLEANALYTICSPLUGIN--><!-- Google Analytics script -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-69012-21']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body class="patternViewPage patternPrintPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain">
<div id="patternMainContents">
<div class="patternContent"><div class="patternTopic"> <h1><a name="Opportunistic_Storage_For_WUSTL"></a>  <strong><noop>Opportunistic Storage For WUSTL</strong> </h1>
<div class="twikiToc"> <ul>
<li> <a href="?cover=print#Purpose"> Purpose</a>
</li> <li> <a href="?cover=print#Use_Case"> Use Case</a> <ul>
<li> <a href="?cover=print#Engage_workflow_for_WUSTL"> Engage workflow for WUSTL</a>
</li> <li> <a href="?cover=print#Alternative_workflow_for_WUSTL"> Alternative workflow for WUSTL</a>
</li></ul> 
</li> <li> <a href="?cover=print#Initial_Participating_Sites"> Initial Participating Sites</a> <ul>
<li> <a href="?cover=print#Fermi_Grid_requirements"> Fermi Grid requirements</a>
</li></ul> 
</li></ul> 
</div>
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Purpose"></a> Purpose </span></h2>
Human Microbiome Project (HMP) at Washington University in St. Louis (WUSTL)  is dedicated to study of core human 
microbiome. The project analyzes how the changes in the human microbiome can be correlated with changes in human health. 
The new technological and bioinformatic tools  are being developed by HMP team in order to advance this research.
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Use_Case"></a> Use Case </span></h2>
Basic Local Alignment Search Tool (blastx) is used to find matches (with a set of special criteria) between DNA sequences (each100-character long strings)  and a
"reference database".  The selection of the datasets depends on the scientific question being asked. The reference database take the form of several files that, depending on the database, will vary from 3 GB to 10 GB.  The goal is to process tens of billions of DNA sequences. The DNA sequences are split into subsets of "input reads" in order to use them as an input for blastx that runs against a given dataset.
<p />
The input to every blastx job is about 67KB files (depends on target runtime/platform) and the reference database (varies: e.g., 3 GB to 10 GB but the same for all jobs in a set).  The job usually runs from 15 minutes to an hour.
<p />
The output is a list of matches is in the order of 200 KB per job. The requirements for memory for one job vary: majority of jobs are using less then 2.2 GB of RAM and around 3 GB of virtual memory, with the larger input database blastx could use up to 4 GB of RAM and 7.5 GB of virtual memory. 
<p />
<strong>NOTE</strong>: (from Brian B) NCBI BLAST has a very aggressive memory caching model which is not well-exposed to the end-user.  It is possible to give it a firm upper limit in virtual memory size if you edit the source code.  In my tests, giving an upper limit of ~1GB (which is what the majority of OSG sites provides) causes about a 10% slowdown in walltime.
<p />
<h3><a name="Engage_workflow_for_WUSTL"></a> Engage workflow for WUSTL </h3>
The first job submitted by Engage on the selected site is staging a database (large text file) and building  references datasets in OSG_DATA shared area. The total size of datasets is 600GB.  Apparently, WUSTL needs just small subset  of these data (10GB) - question to Engage team: Why do all reference datasets need to be staged?
<p />
After the reference datasets are successfully built, a pilot job is submitted to a site. Pilot jobs starts user jobs each run from 10 to 1 hours, each runs blastx with input file with subset of DN sequences and subset of the reference datasets. Question to Engage: how do you avoid overloading shared fs when all the jobs start accessing reference data?
<p />
The requirements:
<p /> <ol>
<li> OSG_DATA allows to store 600GB of data. (question to Engage:  Any other requirement for FS? )
</li> <li> Site should have enough free cpu cycles (question to Engage: what is enough?)
</li> <li> Worker node should allow outbound connection.
</li></ol> 
<p />
<p />
<h3><a name="Alternative_workflow_for_WUSTL"></a> Alternative workflow for WUSTL </h3> <ol>
<li> Build binary datasets at RENCI from a text file.  The total size of resulting datasets is about 85GB.
</li> <li> According to Brian the binary datasets are relocatable so they can be used at any sites.
</li> <li> Upload all datasets to SE of  the selected sites. 
</li> <li> Start pilot job, download selected dataset from SE, cache it on WN, run jobs
</li></ol> 
<p />
<p />
<h2 class="twikinetRoundedAttachments"><span class="twikinetHeader"><a name="Initial_Participating_Sites"></a> Initial Participating Sites </span></h2>
<table cellspacing="0" cellpadding="0" border="0" class="twikinetWrapperTable" rules="none">
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableT twikinetWrapperTableTL"></td>
<td class="twikinetWrapperTableT twikinetWrapperTableTR"></td>
</tr>
<tr class="twikinetWrapperTableRow">
<td colspan="2" class="twikinetWrapperTableMain">
<table cellspacing="0" id="table1" cellpadding="0" class="twikiTable" rules="cols" border="1">
		<tr class="twikiTableOdd twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol0 twikiFirstCol"> <a rel="nofollow" href="/bin/view/Storage/OpportunisticStorageForWUSTL?cover=print;sortcol=0;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Site Name</font></a> </th>
			<th bgcolor="#d8dde4" valign="top" class="twikiTableCol1 twikiLastCol"> <a rel="nofollow" href="/bin/view/Storage/OpportunisticStorageForWUSTL?cover=print;sortcol=1;table=1;up=0#sorted_table" title="Sort by this column"><font color="#252b37">Status </font></a> </th>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> CLEMSON-Palmetto </td>
			<td bgcolor="#ffffff" align="right" valign="top" class="twikiTableCol1 twikiLastCol"> functioning </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> FIREFLY </td>
			<td bgcolor="#f2f3f6" align="right" valign="top" class="twikiTableCol1 twikiLastCol"> functioning </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> NEBRASKA_RED </td>
			<td bgcolor="#ffffff" align="right" valign="top" class="twikiTableCol1 twikiLastCol"> functioning </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> OSG-RENCI-Engagement </td>
			<td bgcolor="#f2f3f6" align="right" valign="top" class="twikiTableCol1 twikiLastCol"> functioning </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> OSG-UCHC_CBG </td>
			<td bgcolor="#ffffff" align="right" valign="top" class="twikiTableCol1 twikiLastCol"> functioning </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> OSG-UFlorida-HPC </td>
			<td bgcolor="#f2f3f6" align="right" valign="top" class="twikiTableCol1 twikiLastCol"> databases will not build, walltime maxes out, other difficulties </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> FNAL_FERMIGRID </td>
			<td bgcolor="#ffffff" align="right" valign="top" class="twikiTableCol1 twikiLastCol"> currently debugging </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> FNAL_GPGRID_1 </td>
			<td bgcolor="#f2f3f6" align="right" valign="top" class="twikiTableCol1 twikiLastCol"> will attemtp to configure </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol"> USCMS-FNAL-WC1 </td>
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol1 twikiLastCol"> &nbsp; </td>
		</tr>
		<tr class="twikiTableOdd twikiTableRowdataBgSorted1 twikiTableRowdataBg1">
			<td bgcolor="#f2f3f6" valign="top" class="twikiTableCol0 twikiFirstCol"> NYSGRID_CORNELL_NYS1 </td>
			<td bgcolor="#f2f3f6" align="right" valign="top" class="twikiTableCol1 twikiLastCol"> could work. Has about 1 TB free </td>
		</tr>
		<tr class="twikiTableEven twikiTableRowdataBgSorted0 twikiTableRowdataBg0">
			<td bgcolor="#ffffff" valign="top" class="twikiTableCol0 twikiFirstCol twikiLast"> <span class="twikiNewLink">OUmissHEP<a href="/bin/edit/Storage/OUmissHEP?topicparent=Storage.OpportunisticStorageForWUSTL" rel="nofollow" title="OUmissHEP (this topic does not yet exist; you can create it)">?</a></span> </td>
			<td bgcolor="#ffffff" align="right" valign="top" class="twikiTableCol1 twikiLastCol twikiLast"> not enough CPUs. Has space available, but is misconfigured. OSG_WN_TMP is not writable </td>
		</tr></table>
</td>
</tr>
<tr class="twikinetWrapperTableRow">
<td class="twikinetWrapperTableB twikinetWrapperTableBL"></td>
<td class="twikinetWrapperTableB twikinetWrapperTableBR"></td>
</tr>
</table>
<p />
<h3><a name="Fermi_Grid_requirements"></a> Fermi Grid requirements </h3>
Fermilab has a   [[http://fermigrid.fnal.gov/policy.html][strict policy] that is applied to all VOs that are using Fermilab resource. Among other things the following is relevant in WUSTL case: <ol>
<li> Fermi Grid has a default quota of 400GB  per VO on OSG_Data 
</li> <li> It is required in case of multi user pilot jobs to use the glexec package to validate the grid credentials of the actual user who has submitted the job
</li> <li> Only voms-proxy initialized credential should be used
</li></ol> 
<p />
In order to applied for permission to use Fermi Grid in non-standard way Engage/WUSTL can submit a request via GOC and assign the ticket to Fermi Site. You might want to request
<p /> <ol>
<li type="a"> increase of OSG_Data quota to 600GB	(justification should be provided)
</li> <li type="a"> . permission to not use gLexec (you will need then to submit pilot jobs with voms-proxy for engage/wustl FQAN). The executables that will be run under pilot jobs should well understood.
</li></ol> 
<p />
<p />
<p />
-- <a href="/bin/view/Main/TanyaLevshina" class="twikiLink">TanyaLevshina</a> - 20 May 2010</div><!-- /patternTopic-->
<p />
<p />
</div><!-- /patternContent-->
<hr />
This topic: Storage<span class='twikiSeparator'>&nbsp;&gt;&nbsp;</span>OpportunisticStorageForWUSTL</span> <br />    
Topic revision: r5 - 21 May 2010 - 20:28:59 - <a href="/bin/view/Main/TanyaLevshina" class="twikiLink">TanyaLevshina</a>
</div><!-- /patternMainContents-->
</div><!-- /patternMain-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="twikinetBadge"><a href="http://www.twiki.net/"><img src="https://twiki.opensciencegrid.org/twiki/pub/TWiki/TWikiNetSkin/twiki-badge-88x31.gif" alt="TWIKI.NET" width="88" height="31" border="0" /></a></div><!--/twikinetBadge--><div id="patternWebBottomBar"><p>
<font size="-1">
TWiki |
<a href="https://ticket.grid.iu.edu/goc/twiki">Report Bugs</a> |
<a href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a>
</p>
<p>
<font size="-2">
<span class="twikiRight"> <a href="http://twiki.org/"><img src="/twiki/pub/TWiki/TWikiLogos/T-logo-80x15.gif" alt="This site is powered by the TWiki collaboration platform" width="80" height="15" title="This site is powered by the TWiki collaboration platform" border="0" /></a></span>Copyright by the contributing authors. All material on this collaboration platform is the property of the contributing authors..
</font>
</p></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />