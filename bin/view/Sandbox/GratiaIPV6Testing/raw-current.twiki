---+ IPv6 Testing Log: !Gratia Collector

This testing log is part of [[Sandbox.OperationsServicesIPv6CompatibilityTable][OSG IPv6 tests]]. This page captures the specific IPv6 compatibility testing process used for one software component, Gratia Collector. The more general IPv6 template for testing is [[https://twiki.grid.iu.edu/bin/view/SoftwareTeam/IPV6Testing][here]].


---++ Initial Setup

This test used two hosts:

| *Host* | *OS* | *OSG Release* |
| test-004.t2.ucsd.edu | CentOS release 6.5 (Final) |  3.2  |
| ipv6vm007.fnal.gov | Scientific Linux Fermi release 6.6(Ramsey) | 3.2 |

---+++ Installing software

Next, OSG software was installed on each system. The UCSD host was installed with osg-gridftp and the gratia 1.13 client and the fermilab host with the gratia collector according to this instructions:
[[https://twiki.opensciencegrid.org/bin/view/Documentation/Release3/GratiaTransferProbe][GratiaInsructions]]

| *Host* | *Package* | *Version* |
| test-004.t2.ucsd.edu | gratia-probe-gridftp-transfer-1.13.31-1.1 |  3.2  |
| ipv6vm007.fnal.gov |  1.16.1-1.osg32.el6| 3.2 |


---++ Testing

---+++ Testing the dual-dual configuration: Yes

&lt;pre class=&quot;screen&quot;&gt;
&lt;strong&gt;  efajardo@cabinet-10-10-1 ~$ globus-url-copy file:///tmp/zero.source gsiftp://test-004.t2.ucsd.edu/tmp/zero&lt;/strong&gt;
&lt;strong&gt; root@test-004 ~# /usr/share/gratia/gridftp-transfer/GridftpTransferProbeDriver &lt;/strong&gt;
&lt;strong&gt;root@test-004 ~# tail -f -n 100  /var/log/gratia/2015-06-08.log &lt;/strong&gt;

13:57:14 PDT Gratia: ***********************************************************
13:57:14 PDT Gratia: Removing log files older than 31 days from /var/log/gratia
13:57:14 PDT Gratia: /var/log/gratia uses 0% and there is 88% free
13:57:14 PDT Gratia: Removing incomplete data files older than 31 days from /var/lib/gratia/data/
13:57:14 PDT Gratia: Removing quarantines data files older than 31 days from /var/lib/gratia/data/quarantine
13:57:14 PDT Gratia: End of execution summary: new records sent successfully: 1
13:57:14 PDT Gratia:                           new records suppressed: 0
13:57:14 PDT Gratia:                           new records failed: 0
13:57:14 PDT Gratia:                           records reprocessed successfully: 0
13:57:14 PDT Gratia:                           reprocessed records failed: 0
13:57:14 PDT Gratia:                           handshake records sent successfully: 1
13:57:14 PDT Gratia:                           handshake records failed: 0
13:57:14 PDT Gratia:                           bundle of records sent successfully: 1
13:57:14 PDT Gratia:                           bundle of records failed: 0
13:57:14 PDT Gratia:                           outstanding records: 0
13:57:14 PDT Gratia:                           outstanding staged records: 0
13:57:14 PDT Gratia:                           outstanding records tar files: 0
13:57:14 PDT Gratia: End-of-execution disconnect ...

&lt;/pre&gt;


---+++ Testing that dual-dual communication defaults to IPv6:  Yes
&lt;pre class=&quot;screen&quot;&gt;
&lt;strong&gt;[root@ipv6vm007 grid-security]# tcpdump -i eth0 -vv ip6 host test-004.t2.ucsd.edu -N&lt;/strong&gt;
tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes
13:58:39.610977 IP6 (hlim 52, next-header TCP (6) payload length: 40) test-004.37131 &gt; ipv6vm007.cddbp-alt: Flags [S], cksum 0xb94b (correct), seq 3216129065, win 14400, options [mss 1440,sackOK,TS val 1567404101 ecr 0,nop,wscale 10], length 0
13:58:39.611033 IP6 (hlim 64, next-header TCP (6) payload length: 40) ipv6vm007.cddbp-alt &gt; test-004.37131: Flags [S.], cksum 0x616b (correct), seq 306200650, ack 3216129066, win 14280, options [mss 1440,sackOK,TS val 4588922 ecr 1567404101,nop,wscale 7], length 0
13:58:39.668018 IP6 (hlim 52, next-header TCP (6) payload length: 32) test-004.37131 &gt; ipv6vm007.cddbp-alt: Flags [.], cksum 0xc7a3 (correct), seq 1, ack 1, win 15, options [nop,nop,TS val 1567404158 ecr 4588922], length 0
13:58:39.669565 IP6 (hlim 52, next-header TCP (6) payload length: 199) test-004.37131 &gt; ipv6vm007.cddbp-alt: Flags [P.], cksum 0x84b7 (correct), seq 1:168, ack 1, win 15, options [nop,nop,TS val 1567404160 ecr 4588922], length 167
13:58:39.669583 IP6 (hlim 64, next-header TCP (6) payload length: 32) ipv6vm007.cddbp-alt &gt; test-004.37131: Flags [.], cksum 0xc656 (correct), seq 1, ack 168, win 120, options [nop,nop,TS val 4588981 ecr 1567404160], length 0

&lt;/pre&gt;

---+++ Testing the dual server / IPv4 client configuration: Yes

Same tests were done as in the other cases

